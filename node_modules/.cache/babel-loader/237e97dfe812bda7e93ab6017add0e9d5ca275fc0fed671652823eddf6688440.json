{"ast":null,"code":"import React,{useState,useEffect,useMemo,useRef}from'react';import PlayerSlot from'./PlayerSlot';import'./GameArea.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function GameArea(_ref){var _contractState$timer3,_contractState$timer4,_contractState$timer6,_contractState$curren2,_contractState$timer9,_contractState$timer0,_contractState$timer1,_contractState$timer10;let{jackpotValue,currentRound,timeRemaining,isLive,betAmount,onBetChange,onPlaceBet,isConnected,isLoading,userWinChance,userBetTotal,contractState,adminInfo,currentBettors,// Winner state props (passed from App.js)\nwaitingForWinner,contractWinner,postWinnerLoading,showWinnerAnnouncement}=_ref;// Local animation state only (winner states are now props from App.js)\nconst[isSpinning,setIsSpinning]=useState(false);const[reelOffset,setReelOffset]=useState(0);const[winner,setWinner]=useState(null);const[predeterminedWinner,setPredeterminedWinner]=useState(null);// Winner states removed - now passed as props from App.js:\n// waitingForWinner, contractWinner, showWinnerAnnouncement, postWinnerLoading\nconst[transactionNotification,setTransactionNotification]=useState({show:false,message:'',type:'success'// 'success', 'pending', 'error'\n});// Use refs to prevent unnecessary re-renders\nconst animationFrameRef=useRef();const[localTimer,setLocalTimer]=useState(0);const lastSyncRef=useRef(null);// Memoized calculated values to prevent recalculation on every render\nconst memoizedValues=useMemo(()=>{var _contractState$timer$,_contractState$timer,_contractState$timer2;// Check if contract is active - if not, show everything as 0\nconst isContractActive=(contractState===null||contractState===void 0?void 0:contractState.isActive)!==false;// Use local countdown timer if active, otherwise fall back to contract/prop data\nconst backendTimer=(_contractState$timer$=contractState===null||contractState===void 0?void 0:(_contractState$timer=contractState.timer)===null||_contractState$timer===void 0?void 0:_contractState$timer.timeRemaining)!==null&&_contractState$timer$!==void 0?_contractState$timer$:timeRemaining;const displayTimer=isContractActive?localTimer>0?localTimer:backendTimer:0;// Debug logging for timer sync\nif(backendTimer>0&&Math.abs(backendTimer-localTimer)>5){console.log('‚è∞ Timer sync check:',{backend:backendTimer,local:localTimer,using:displayTimer});}const displayRound=(contractState===null||contractState===void 0?void 0:(_contractState$timer2=contractState.timer)===null||_contractState$timer2===void 0?void 0:_contractState$timer2.roundNumber)||currentRound;const totalPlayers=isContractActive?(contractState===null||contractState===void 0?void 0:contractState.betCount)||(currentBettors===null||currentBettors===void 0?void 0:currentBettors.length)||0:0;// Use contract's total jackpot value directly (this includes all bet amounts before fees)\nconst totalJackpotValue=isContractActive?(contractState===null||contractState===void 0?void 0:contractState.totalJackpot)||jackpotValue||0:0;// Calculate winner prize (95% of total jackpot, 5% is fee)\nconst winnerPrizeValue=totalJackpotValue*0.95;return{displayTimer,displayRound,totalPlayers,totalJackpotValue:parseFloat(totalJackpotValue.toFixed(3)),// Contract's total jackpot\nwinnerPrizeValue:parseFloat(winnerPrizeValue.toFixed(3)),// Amount winner gets (95% of total)\nisContractActive};},[contractState===null||contractState===void 0?void 0:contractState.isActive,contractState===null||contractState===void 0?void 0:(_contractState$timer3=contractState.timer)===null||_contractState$timer3===void 0?void 0:_contractState$timer3.roundNumber,contractState===null||contractState===void 0?void 0:contractState.betCount,contractState===null||contractState===void 0?void 0:contractState.totalJackpot,contractState===null||contractState===void 0?void 0:(_contractState$timer4=contractState.timer)===null||_contractState$timer4===void 0?void 0:_contractState$timer4.timeRemaining,currentBettors,currentRound,jackpotValue,timeRemaining,localTimer]);// Memoize player stats to prevent unnecessary updates\nconst playerStats=useMemo(()=>{// If contract is not active, show everything as 0\nif(!memoizedValues.isContractActive){return{yourWager:0,yourChance:0};}// Find user's bet in current bettors\nconst userBettor=currentBettors===null||currentBettors===void 0?void 0:currentBettors.find(bettor=>bettor.address===(contractState===null||contractState===void 0?void 0:contractState.userAddress)||bettor.fullAddress===(contractState===null||contractState===void 0?void 0:contractState.userAddress));const yourWager=userBettor?userBettor.amount:userBetTotal||0;// Show actual bet amount including fee\n// Use contract's probability calculation if available, otherwise fallback to manual calculation\nconst yourChance=userWinChance>0?userWinChance:userBettor!==null&&userBettor!==void 0&&userBettor.amount&&memoizedValues.totalJackpotValue>0?userBettor.amount*100/memoizedValues.totalJackpotValue:0;return{yourWager:parseFloat(yourWager.toFixed(3)),// Prevent floating point jitter\nyourChance:parseFloat(yourChance.toFixed(2))// Prevent floating point jitter\n};},[currentBettors,contractState===null||contractState===void 0?void 0:contractState.userAddress,userBetTotal,userWinChance,memoizedValues.totalJackpotValue,memoizedValues.isContractActive]);// Memoize game status to prevent text flicker\nconst gameStatus=useMemo(()=>{if(!memoizedValues.isContractActive)return\"‚è∏Ô∏è Jackpot is paused\";if(waitingForWinner)return\"üéØ Selecting winner...\";if(!isLive)return adminInfo!==null&&adminInfo!==void 0&&adminInfo.isAutoManaged?\"ü§ñ Auto-starting next round...\":\"Waiting for next round...\";if(winner)return\"\\uD83C\\uDF89 \".concat(winner.name,\" wins \").concat(memoizedValues.winnerPrizeValue.toFixed(3),\" TON!\");if(isSpinning)return\"üé∞ Spinning...\";if(memoizedValues.displayTimer<=5&&memoizedValues.totalPlayers>0)return\"‚è∞ Get ready to spin!\";if(memoizedValues.totalPlayers===0)return\"üí∞ Place your bets to start!\";return\"\\uD83D\\uDCB0 \".concat(memoizedValues.totalPlayers,\" player\").concat(memoizedValues.totalPlayers!==1?'s':'',\" betting...\");},[waitingForWinner,isLive,winner,isSpinning,adminInfo===null||adminInfo===void 0?void 0:adminInfo.isAutoManaged,memoizedValues]);const{displayTimer,displayRound,totalPlayers,totalJackpotValue,winnerPrizeValue}=memoizedValues;// Memoized player creation to prevent recreation on every render\nconst players=useMemo(()=>{// Create fixed array of 20 cards\nconst FIXED_CARDS=20;const playersArray=[];// If contract is not active, show only waiting placeholders\nif(memoizedValues.isContractActive&&currentBettors&&currentBettors.length>0){currentBettors.forEach((bettor,index)=>{if(index<FIXED_CARDS){// Only fill up to 20 slots\n// Apply 0.5 TON fee deduction for jackpot calculations\nconst netBetAmount=Math.max(0,bettor.amount-0.5);// Use contract's probability calculation: (bettorAmount * 100) / totalJackpot\nconst winChance=memoizedValues.totalJackpotValue>0?bettor.amount*100/memoizedValues.totalJackpotValue:0;playersArray.push({id:index+1,name:bettor.username,avatar:'üë§',bet:bettor.amount,// Show actual bet amount including fee\nnetBet:netBetAmount,// Store net bet for calculations\nchance:winChance,address:bettor.address,isRealPlayer:true});}});}// Fill remaining slots with waiting placeholders\nwhile(playersArray.length<FIXED_CARDS){playersArray.push({id:playersArray.length+1,name:'Waiting',avatar:'‚ùì',bet:0,netBet:0,chance:0,isRealPlayer:false});}return playersArray;},[currentBettors,memoizedValues.totalJackpotValue,memoizedValues.isContractActive]);// Recalculate when bettors change or jackpot changes\n// Memoized extended players for slot machine\nconst extendedPlayers=useMemo(()=>{const extended=[];for(let i=0;i<20;i++){extended.push(...players);}return extended;},[players]);// Reset local state when new round starts (only track round number changes)\nconst[lastRoundNumber,setLastRoundNumber]=useState(null);useEffect(()=>{var _contractState$timer5;const currentRoundNumber=contractState===null||contractState===void 0?void 0:(_contractState$timer5=contractState.timer)===null||_contractState$timer5===void 0?void 0:_contractState$timer5.roundNumber;// Only reset when round number actually changes (indicating a new round)\nif(currentRoundNumber&&currentRoundNumber!==lastRoundNumber){console.log(\"\\uD83D\\uDD04 New round detected: \".concat(lastRoundNumber,\" \\u2192 \").concat(currentRoundNumber));// Reset all local game state for new round (winner states managed by App.js)\nsetIsSpinning(false);setReelOffset(0);setWinner(null);setPredeterminedWinner(null);setLastRoundNumber(currentRoundNumber);}},[currentBettors,startSpinToWinner,contractState===null||contractState===void 0?void 0:(_contractState$timer6=contractState.timer)===null||_contractState$timer6===void 0?void 0:_contractState$timer6.roundNumber,lastRoundNumber]);// Monitor winner announcements from App.js and start animations\nuseEffect(()=>{// If we have a winner from the backend and we're not already spinning\nif(contractWinner&&!isSpinning&&!winner){console.log('üéØ Starting spin animation for contract winner:',contractWinner);// Find winner in current players\nconst targetWinner=players.find(p=>p.address===contractWinner.address||p.name===contractWinner.name||p.name===contractWinner.username);if(targetWinner){startSpinToWinner(targetWinner);}else{console.warn('Winner not found in players:',contractWinner);}}},[isSpinning,winner,contractWinner,players,startSpinToWinner]);// Persistent animation that doesn't restart on user changes\nuseEffect(()=>{let lastTimestamp=0;const animate=timestamp=>{// Only animate if conditions are met\nif(!isSpinning&&!winner){// Calculate delta time for smooth 60fps animation\nconst deltaTime=timestamp-lastTimestamp;lastTimestamp=timestamp;setReelOffset(prev=>{const currentCardWidth=window.innerWidth<=480?120:150;const gap=window.innerWidth<=480?15:20;const cardPlusGap=currentCardWidth+gap;// Smooth movement at 1.2 pixels per frame (60fps = 72px/sec)\nconst speed=Math.max(0.5,deltaTime/16.67*1.2);// Normalize to 60fps\nconst newOffset=prev+speed;const fullCycleWidth=20*cardPlusGap;// Reset to 0 when full cycle is complete for seamless loop\nif(newOffset>=fullCycleWidth){return newOffset-fullCycleWidth;}return newOffset;});}animationFrameRef.current=requestAnimationFrame(animate);};animationFrameRef.current=requestAnimationFrame(animate);return()=>{if(animationFrameRef.current){cancelAnimationFrame(animationFrameRef.current);}};},[]);// Empty dependency array - only run once on mount\n// Separate effect to handle game state changes without restarting animation\nuseEffect(()=>{// Don't restart animation, just let the conditions check in the animation loop\nconsole.log('Game state changed:',{isSpinning,winner:!!winner,isLive});},[isSpinning,winner,isLive]);// Select winner based on weighted probability\nconst selectWeightedWinner=()=>{const realPlayers=players.filter(p=>p.isRealPlayer&&p.netBet>0);if(realPlayers.length===0)return null;// Calculate cumulative weights based on net bet amounts (fair distribution)\nconst totalWeight=realPlayers.reduce((sum,player)=>sum+player.netBet,0);const random=Math.random()*totalWeight;let cumulativeWeight=0;for(const player of realPlayers){cumulativeWeight+=player.netBet;if(random<=cumulativeWeight){return player;}}// Fallback to last player\nreturn realPlayers[realPlayers.length-1];};// startSpin function removed - unused\n// New function to spin to a specific winner\nconst startSpinToWinner=targetWinner=>{if(isSpinning)return;console.log('üé∞ Starting spin animation to winner:',targetWinner.name);setPredeterminedWinner(targetWinner);setIsSpinning(true);setWinner(null);// Calculate precise stopping position for the target winner\nconst currentCardWidth=window.innerWidth<=480?120:150;const gap=window.innerWidth<=480?15:20;const cardPlusGap=currentCardWidth+gap;const centerOffset=window.innerWidth/2-cardPlusGap/2-25;const winnerIndex=players.findIndex(p=>p.address===targetWinner.address||p.name===targetWinner.name);if(winnerIndex===-1){console.error('Winner not found in players array');return;}const baseSpins=2;const targetCardPosition=winnerIndex*cardPlusGap;const targetPosition=baseSpins*20*cardPlusGap+targetCardPosition+centerOffset;// Use fixed 20 cards\nsetReelOffset(targetPosition);console.log('üéØ Animation targeting winner:',targetWinner.name,'at position:',winnerIndex);// Stop spinning after 3 seconds and show winner\nsetTimeout(()=>{setIsSpinning(false);setWinner(targetWinner);setPredeterminedWinner(null);// Winner notification is now handled by App.js via socket events\n// Clear local winner after 3 seconds\nsetTimeout(()=>{setWinner(null);},3000);},3000);};// Global winner announcement is now handled by App.js via socket events\nconst formatTime=seconds=>{const mins=Math.floor(seconds/60);const secs=seconds%60;return\"\".concat(mins.toString().padStart(2,'0'),\":\").concat(secs.toString().padStart(2,'0'));};// Monitor bet confirmation polling status\nuseEffect(()=>{// Set up a global handler for bet confirmation updates\nwindow.updateBetConfirmationStatus=status=>{// Function removed since betConfirmationStatus was removed\n};// Set up a global handler for transaction notifications\nwindow.showTransactionNotification=function(message){let type=arguments.length>1&&arguments[1]!==undefined?arguments[1]:'success';setTransactionNotification({show:true,message:message,type:type});// Auto-hide after 4 seconds\nsetTimeout(()=>{setTransactionNotification({show:false,message:'',type:'success'});},4000);};return()=>{delete window.updateBetConfirmationStatus;delete window.showTransactionNotification;};},[]);// Sync timer once and start local countdown\nuseEffect(()=>{var _contractState$curren,_contractState$timer7,_contractState$timer$2,_contractState$timer8;const currentRoundId=(contractState===null||contractState===void 0?void 0:(_contractState$curren=contractState.currentRound)===null||_contractState$curren===void 0?void 0:_contractState$curren.roundNumber)||(contractState===null||contractState===void 0?void 0:(_contractState$timer7=contractState.timer)===null||_contractState$timer7===void 0?void 0:_contractState$timer7.roundNumber);const backendTimer=(_contractState$timer$2=contractState===null||contractState===void 0?void 0:(_contractState$timer8=contractState.timer)===null||_contractState$timer8===void 0?void 0:_contractState$timer8.timeRemaining)!==null&&_contractState$timer$2!==void 0?_contractState$timer$2:timeRemaining;// Only sync if we have new round data or timer data changed significantly\nconst needsSync=!lastSyncRef.current||lastSyncRef.current.roundId!==currentRoundId||backendTimer>0&&Math.abs(backendTimer-localTimer)>10;if(needsSync&&backendTimer>0){console.log('‚è∞ Syncing timer:',backendTimer,'seconds');setLocalTimer(backendTimer);lastSyncRef.current={roundId:currentRoundId,timer:backendTimer,timestamp:Date.now()};}},[contractState===null||contractState===void 0?void 0:(_contractState$curren2=contractState.currentRound)===null||_contractState$curren2===void 0?void 0:_contractState$curren2.roundNumber,contractState===null||contractState===void 0?void 0:(_contractState$timer9=contractState.timer)===null||_contractState$timer9===void 0?void 0:_contractState$timer9.roundNumber,contractState===null||contractState===void 0?void 0:(_contractState$timer0=contractState.timer)===null||_contractState$timer0===void 0?void 0:_contractState$timer0.timeRemaining,timeRemaining,localTimer]);// Local countdown timer (runs every second)\nuseEffect(()=>{if(localTimer<=0)return;const interval=setInterval(()=>{setLocalTimer(prev=>{const newTime=Math.max(0,prev-1);if(newTime===0){console.log('‚è∞ Timer reached zero');}return newTime;});},1000);return()=>clearInterval(interval);},[localTimer]);return/*#__PURE__*/_jsxs(\"div\",{className:\"game-area\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"jackpot-section\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"jackpot-header\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"\\u26A1 JACKPOT\"}),/*#__PURE__*/_jsx(\"span\",{className:\"player-count\",children:totalPlayers}),(adminInfo===null||adminInfo===void 0?void 0:adminInfo.isAutoManaged)&&/*#__PURE__*/_jsx(\"span\",{className:\"automation-badge\",children:\"\\uD83E\\uDD16 AUTO\"})]}),/*#__PURE__*/_jsx(\"p\",{className:\"jackpot-subtitle\",children:gameStatus}),/*#__PURE__*/_jsxs(\"div\",{className:\"bet-controls\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"bet-amount-display\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"bet-amount-value\",children:(betAmount===null||betAmount===void 0?void 0:betAmount.toFixed(1))||'0.0'}),/*#__PURE__*/_jsx(\"span\",{className:\"currency-label\",children:\"TON\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bet-buttons\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"bet-preset\",onClick:()=>onBetChange({target:{value:'0.11'}}),children:\"0.11\"}),/*#__PURE__*/_jsx(\"button\",{className:\"bet-preset\",onClick:()=>onBetChange({target:{value:'0.5'}}),children:\"0.5\"}),/*#__PURE__*/_jsx(\"button\",{className:\"bet-preset\",onClick:()=>onBetChange({target:{value:'1.0'}}),children:\"1.0\"}),/*#__PURE__*/_jsx(\"button\",{className:\"bet-preset\",onClick:()=>onBetChange({target:{value:'2.0'}}),children:\"2.0\"})]}),/*#__PURE__*/_jsx(\"button\",{className:\"bet-button\",onClick:onPlaceBet,disabled:!isConnected||!memoizedValues.isContractActive||!isLive||isLoading||isSpinning||waitingForWinner||postWinnerLoading,children:!memoizedValues.isContractActive?'‚è∏Ô∏è Paused':isSpinning?'üé∞ Spinning...':waitingForWinner?'üéØ Selecting...':postWinnerLoading?'üîÑ New Round...':isConnected?'Bet':'Connect Wallet'})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"stats-grid\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"stat-card jackpot-value\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"stat-icon\",children:\"\\uD83C\\uDFB0\"}),/*#__PURE__*/_jsx(\"div\",{className:\"stat-amount\",children:totalJackpotValue.toFixed(3)}),/*#__PURE__*/_jsx(\"div\",{className:\"stat-label\",children:\"Total Jackpot\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"stat-card net-payout\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"stat-icon\",children:\"\\uD83D\\uDCB0\"}),/*#__PURE__*/_jsx(\"div\",{className:\"stat-amount\",children:winnerPrizeValue.toFixed(3)}),/*#__PURE__*/_jsx(\"div\",{className:\"stat-label\",children:\"Winner Gets (95%)\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"stat-card your-wager\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"stat-icon\",children:\"\\uD83C\\uDFAF\"}),/*#__PURE__*/_jsx(\"div\",{className:\"stat-amount\",children:playerStats.yourWager.toFixed(3)}),/*#__PURE__*/_jsx(\"div\",{className:\"stat-label\",children:\"Your Wager\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"stat-card your-chance\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"stat-amount\",children:[playerStats.yourChance.toFixed(2),\"%\"]}),/*#__PURE__*/_jsx(\"div\",{className:\"stat-label\",children:\"Your Chance\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"stat-card time-remaining\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"stat-amount\",children:formatTime(displayTimer)}),/*#__PURE__*/_jsx(\"div\",{className:\"stat-label\",children:contractState!==null&&contractState!==void 0&&(_contractState$timer1=contractState.timer)!==null&&_contractState$timer1!==void 0&&_contractState$timer1.isActive?'Auto Timer':'Time Remaining'})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"winner-arrow-container\",children:/*#__PURE__*/_jsx(\"div\",{className:\"winner-arrow\",children:/*#__PURE__*/_jsx(\"div\",{className:\"arrow\",children:\"\\u25BC\"})})}),/*#__PURE__*/_jsx(\"div\",{className:\"slot-machine\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"slot-frame\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"slot-reel-container\",children:/*#__PURE__*/_jsx(\"div\",{className:\"slot-reel \".concat(isSpinning?'slot-spinning':'idle'),style:{transform:\"translateX(\".concat(-reelOffset,\"px)\"),willChange:'transform'},children:extendedPlayers.map((player,index)=>/*#__PURE__*/_jsx(\"div\",{className:\"slot-card\",children:/*#__PURE__*/_jsx(PlayerSlot,{player:player,isWinner:winner&&winner.id===player.id&&!isSpinning,isPredetermined:predeterminedWinner&&predeterminedWinner.id===player.id})},\"\".concat(player.id,\"-\").concat(index)))})}),isSpinning&&/*#__PURE__*/_jsx(\"div\",{className:\"slot-blur\"})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"footer-info\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"payout-info\",children:[\"\\u26A1 Payouts are settled in TON\",(contractState===null||contractState===void 0?void 0:(_contractState$timer10=contractState.timer)===null||_contractState$timer10===void 0?void 0:_contractState$timer10.isActive)&&/*#__PURE__*/_jsx(\"span\",{className:\"automation-info\",children:\" \\u2022 \\uD83E\\uDD16 Automated rounds\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"game-stats\",children:[/*#__PURE__*/_jsxs(\"span\",{className:\"players-count\",children:[\"\\uD83D\\uDC65 \",totalPlayers,\" Players\"]}),/*#__PURE__*/_jsxs(\"span\",{className:\"round-number\",children:[\"Round #\",displayRound]}),isConnected&&/*#__PURE__*/_jsx(\"span\",{className:\"connection-status\",children:\"\\uD83D\\uDFE2 Connected\"})]})]}),showWinnerAnnouncement&&contractWinner&&/*#__PURE__*/_jsx(\"div\",{className:\"winner-announcement-overlay\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"winner-announcement-card\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"winner-icon\",children:\"\\uD83C\\uDF89\"}),/*#__PURE__*/_jsx(\"h3\",{children:\"ROUND WINNER!\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"winner-details\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"winner-address\",children:contractWinner.winner}),/*#__PURE__*/_jsxs(\"div\",{className:\"winner-prize\",children:[\"Won \",contractWinner.prize,\" TON\"]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"winner-confetti\",children:\"\\uD83C\\uDF8A \\uD83C\\uDF89 \\uD83C\\uDF8A\"})]})}),waitingForWinner&&/*#__PURE__*/_jsx(\"div\",{className:\"winner-selection-loading\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"winner-selection-content\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"loading-spinner-big\",children:\"\\uD83C\\uDFAF\"}),/*#__PURE__*/_jsx(\"h2\",{children:\"Selecting Winner...\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Analyzing bets and picking the winner\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"loading-dots\",children:[/*#__PURE__*/_jsx(\"span\",{}),/*#__PURE__*/_jsx(\"span\",{}),/*#__PURE__*/_jsx(\"span\",{})]})]})}),postWinnerLoading&&/*#__PURE__*/_jsx(\"div\",{className:\"winner-selection-loading\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"winner-selection-content\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"loading-spinner-big\",children:\"\\uD83D\\uDD04\"}),/*#__PURE__*/_jsx(\"h2\",{children:\"Preparing New Round...\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Setting up the next jackpot round\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"loading-dots\",children:[/*#__PURE__*/_jsx(\"span\",{}),/*#__PURE__*/_jsx(\"span\",{}),/*#__PURE__*/_jsx(\"span\",{})]})]})}),transactionNotification.show&&/*#__PURE__*/_jsx(\"div\",{className:\"transaction-notification \".concat(transactionNotification.type),children:transactionNotification.message})]});}export default GameArea;","map":{"version":3,"names":["React","useState","useEffect","useMemo","useRef","PlayerSlot","jsx","_jsx","jsxs","_jsxs","GameArea","_ref","_contractState$timer3","_contractState$timer4","_contractState$timer6","_contractState$curren2","_contractState$timer9","_contractState$timer0","_contractState$timer1","_contractState$timer10","jackpotValue","currentRound","timeRemaining","isLive","betAmount","onBetChange","onPlaceBet","isConnected","isLoading","userWinChance","userBetTotal","contractState","adminInfo","currentBettors","waitingForWinner","contractWinner","postWinnerLoading","showWinnerAnnouncement","isSpinning","setIsSpinning","reelOffset","setReelOffset","winner","setWinner","predeterminedWinner","setPredeterminedWinner","transactionNotification","setTransactionNotification","show","message","type","animationFrameRef","localTimer","setLocalTimer","lastSyncRef","memoizedValues","_contractState$timer$","_contractState$timer","_contractState$timer2","isContractActive","isActive","backendTimer","timer","displayTimer","Math","abs","console","log","backend","local","using","displayRound","roundNumber","totalPlayers","betCount","length","totalJackpotValue","totalJackpot","winnerPrizeValue","parseFloat","toFixed","playerStats","yourWager","yourChance","userBettor","find","bettor","address","userAddress","fullAddress","amount","gameStatus","isAutoManaged","concat","name","players","FIXED_CARDS","playersArray","forEach","index","netBetAmount","max","winChance","push","id","username","avatar","bet","netBet","chance","isRealPlayer","extendedPlayers","extended","i","lastRoundNumber","setLastRoundNumber","_contractState$timer5","currentRoundNumber","startSpinToWinner","targetWinner","p","warn","lastTimestamp","animate","timestamp","deltaTime","prev","currentCardWidth","window","innerWidth","gap","cardPlusGap","speed","newOffset","fullCycleWidth","current","requestAnimationFrame","cancelAnimationFrame","selectWeightedWinner","realPlayers","filter","totalWeight","reduce","sum","player","random","cumulativeWeight","centerOffset","winnerIndex","findIndex","error","baseSpins","targetCardPosition","targetPosition","setTimeout","formatTime","seconds","mins","floor","secs","toString","padStart","updateBetConfirmationStatus","status","showTransactionNotification","arguments","undefined","_contractState$curren","_contractState$timer7","_contractState$timer$2","_contractState$timer8","currentRoundId","needsSync","roundId","Date","now","interval","setInterval","newTime","clearInterval","className","children","onClick","target","value","disabled","style","transform","willChange","map","isWinner","isPredetermined","prize"],"sources":["C:/Users/adams/OneDrive/Desktop/Work/slotpot/src/components/GameArea.js"],"sourcesContent":["import React, { useState, useEffect, useMemo, useRef } from 'react';\nimport PlayerSlot from './PlayerSlot';\nimport './GameArea.css';\n\nfunction GameArea({ \n  jackpotValue,\n  currentRound,\n  timeRemaining,\n  isLive,\n  betAmount,\n  onBetChange,\n  onPlaceBet,\n  isConnected,\n  isLoading,\n  userWinChance,\n  userBetTotal,\n  contractState,\n  adminInfo,\n  currentBettors,\n  // Winner state props (passed from App.js)\n  waitingForWinner,\n  contractWinner,\n  postWinnerLoading,\n  showWinnerAnnouncement\n}) {\n  // Local animation state only (winner states are now props from App.js)\n  const [isSpinning, setIsSpinning] = useState(false);\n  const [reelOffset, setReelOffset] = useState(0);\n  const [winner, setWinner] = useState(null);\n  const [predeterminedWinner, setPredeterminedWinner] = useState(null);\n  \n  // Winner states removed - now passed as props from App.js:\n  // waitingForWinner, contractWinner, showWinnerAnnouncement, postWinnerLoading\n  const [transactionNotification, setTransactionNotification] = useState({\n    show: false,\n    message: '',\n    type: 'success' // 'success', 'pending', 'error'\n  });\n\n  // Use refs to prevent unnecessary re-renders\n  const animationFrameRef = useRef();\n  const [localTimer, setLocalTimer] = useState(0);\n  const lastSyncRef = useRef(null);\n\n  // Memoized calculated values to prevent recalculation on every render\n  const memoizedValues = useMemo(() => {\n    // Check if contract is active - if not, show everything as 0\n    const isContractActive = contractState?.isActive !== false;\n    \n         // Use local countdown timer if active, otherwise fall back to contract/prop data\n     const backendTimer = contractState?.timer?.timeRemaining ?? timeRemaining;\n     const displayTimer = isContractActive ? (localTimer > 0 ? localTimer : backendTimer) : 0;\n    \n         // Debug logging for timer sync\n     if (backendTimer > 0 && Math.abs(backendTimer - localTimer) > 5) {\n       console.log('‚è∞ Timer sync check:', {\n         backend: backendTimer,\n         local: localTimer,\n         using: displayTimer\n       });\n     }\n    const displayRound = contractState?.timer?.roundNumber || currentRound;\n    const totalPlayers = isContractActive ? (contractState?.betCount || currentBettors?.length || 0) : 0;\n\n    // Use contract's total jackpot value directly (this includes all bet amounts before fees)\n    const totalJackpotValue = isContractActive ? (contractState?.totalJackpot || jackpotValue || 0) : 0;\n\n    // Calculate winner prize (95% of total jackpot, 5% is fee)\n    const winnerPrizeValue = totalJackpotValue * 0.95;\n\n    return {\n      displayTimer,\n      displayRound,\n      totalPlayers,\n      totalJackpotValue: parseFloat(totalJackpotValue.toFixed(3)), // Contract's total jackpot\n      winnerPrizeValue: parseFloat(winnerPrizeValue.toFixed(3)), // Amount winner gets (95% of total)\n      isContractActive\n    };\n  }, [contractState?.isActive, contractState?.timer?.roundNumber, contractState?.betCount, contractState?.totalJackpot, contractState?.timer?.timeRemaining,\n      currentBettors, currentRound, jackpotValue, timeRemaining, localTimer]);\n\n  // Memoize player stats to prevent unnecessary updates\n  const playerStats = useMemo(() => {\n    // If contract is not active, show everything as 0\n    if (!memoizedValues.isContractActive) {\n      return {\n        yourWager: 0,\n        yourChance: 0\n      };\n    }\n    \n    // Find user's bet in current bettors\n    const userBettor = currentBettors?.find(bettor => \n      bettor.address === contractState?.userAddress ||\n      bettor.fullAddress === contractState?.userAddress\n    );\n    \n    const yourWager = userBettor ? userBettor.amount : userBetTotal || 0; // Show actual bet amount including fee\n    \n    // Use contract's probability calculation if available, otherwise fallback to manual calculation\n    const yourChance = userWinChance > 0 ? userWinChance : \n      (userBettor?.amount && memoizedValues.totalJackpotValue > 0 ? \n        (userBettor.amount * 100) / memoizedValues.totalJackpotValue : 0);\n\n    return {\n      yourWager: parseFloat(yourWager.toFixed(3)), // Prevent floating point jitter\n      yourChance: parseFloat(yourChance.toFixed(2)) // Prevent floating point jitter\n    };\n  }, [currentBettors, contractState?.userAddress, userBetTotal, userWinChance, memoizedValues.totalJackpotValue, memoizedValues.isContractActive]);\n\n  // Memoize game status to prevent text flicker\n  const gameStatus = useMemo(() => {\n    if (!memoizedValues.isContractActive) return \"‚è∏Ô∏è Jackpot is paused\";\n    if (waitingForWinner) return \"üéØ Selecting winner...\";\n    if (!isLive) return adminInfo?.isAutoManaged ? \"ü§ñ Auto-starting next round...\" : \"Waiting for next round...\";\n    if (winner) return `üéâ ${winner.name} wins ${memoizedValues.winnerPrizeValue.toFixed(3)} TON!`;\n    if (isSpinning) return \"üé∞ Spinning...\";\n    if (memoizedValues.displayTimer <= 5 && memoizedValues.totalPlayers > 0) return \"‚è∞ Get ready to spin!\";\n    if (memoizedValues.totalPlayers === 0) return \"üí∞ Place your bets to start!\";\n    return `üí∞ ${memoizedValues.totalPlayers} player${memoizedValues.totalPlayers !== 1 ? 's' : ''} betting...`;\n  }, [waitingForWinner, isLive, winner, isSpinning, adminInfo?.isAutoManaged, memoizedValues]);\n\n  const { displayTimer, displayRound, totalPlayers, totalJackpotValue, winnerPrizeValue } = memoizedValues;\n\n  // Memoized player creation to prevent recreation on every render\n  const players = useMemo(() => {\n    // Create fixed array of 20 cards\n    const FIXED_CARDS = 20;\n    const playersArray = [];\n    \n    // If contract is not active, show only waiting placeholders\n    if (memoizedValues.isContractActive && currentBettors && currentBettors.length > 0) {\n      currentBettors.forEach((bettor, index) => {\n        if (index < FIXED_CARDS) { // Only fill up to 20 slots\n          // Apply 0.5 TON fee deduction for jackpot calculations\n          const netBetAmount = Math.max(0, bettor.amount - 0.5);\n          \n          // Use contract's probability calculation: (bettorAmount * 100) / totalJackpot\n          const winChance = memoizedValues.totalJackpotValue > 0 ? \n            (bettor.amount * 100) / memoizedValues.totalJackpotValue : 0;\n          \n          playersArray.push({\n            id: index + 1,\n            name: bettor.username,\n            avatar: 'üë§',\n            bet: bettor.amount, // Show actual bet amount including fee\n            netBet: netBetAmount, // Store net bet for calculations\n            chance: winChance,\n            address: bettor.address,\n            isRealPlayer: true\n          });\n        }\n      });\n    }\n    \n    // Fill remaining slots with waiting placeholders\n    while (playersArray.length < FIXED_CARDS) {\n      playersArray.push({\n        id: playersArray.length + 1,\n        name: 'Waiting',\n        avatar: '‚ùì',\n        bet: 0,\n        netBet: 0,\n        chance: 0,\n        isRealPlayer: false\n      });\n    }\n    \n    return playersArray;\n  }, [currentBettors, memoizedValues.totalJackpotValue, memoizedValues.isContractActive]); // Recalculate when bettors change or jackpot changes\n\n  // Memoized extended players for slot machine\n  const extendedPlayers = useMemo(() => {\n    const extended = [];\n    for (let i = 0; i < 20; i++) {\n      extended.push(...players);\n    }\n    return extended;\n  }, [players]);\n\n  // Reset local state when new round starts (only track round number changes)\n  const [lastRoundNumber, setLastRoundNumber] = useState(null);\n  \n  useEffect(() => {\n    const currentRoundNumber = contractState?.timer?.roundNumber;\n    \n    // Only reset when round number actually changes (indicating a new round)\n    if (currentRoundNumber && currentRoundNumber !== lastRoundNumber) {\n      console.log(`üîÑ New round detected: ${lastRoundNumber} ‚Üí ${currentRoundNumber}`);\n      \n      // Reset all local game state for new round (winner states managed by App.js)\n      setIsSpinning(false);\n      setReelOffset(0);\n      setWinner(null);\n      setPredeterminedWinner(null);\n      \n      setLastRoundNumber(currentRoundNumber);\n    }\n  }, [currentBettors, startSpinToWinner, contractState?.timer?.roundNumber, lastRoundNumber]);\n\n  // Monitor winner announcements from App.js and start animations\n  useEffect(() => {\n    // If we have a winner from the backend and we're not already spinning\n    if (contractWinner && !isSpinning && !winner) {\n      console.log('üéØ Starting spin animation for contract winner:', contractWinner);\n      \n      // Find winner in current players\n      const targetWinner = players.find(p => \n        p.address === contractWinner.address || \n        p.name === contractWinner.name ||\n        p.name === contractWinner.username\n      );\n      \n      if (targetWinner) {\n        startSpinToWinner(targetWinner);\n      } else {\n        console.warn('Winner not found in players:', contractWinner);\n      }\n    }\n  }, [isSpinning, winner, contractWinner, players, startSpinToWinner]);\n\n  // Persistent animation that doesn't restart on user changes\n  useEffect(() => {\n    let lastTimestamp = 0;\n    \n    const animate = (timestamp) => {\n      // Only animate if conditions are met\n      if (!isSpinning && !winner) {\n        // Calculate delta time for smooth 60fps animation\n        const deltaTime = timestamp - lastTimestamp;\n        lastTimestamp = timestamp;\n        \n        setReelOffset(prev => {\n          const currentCardWidth = window.innerWidth <= 480 ? 120 : 150;\n          const gap = window.innerWidth <= 480 ? 15 : 20;\n          const cardPlusGap = currentCardWidth + gap;\n          \n          // Smooth movement at 1.2 pixels per frame (60fps = 72px/sec)\n          const speed = Math.max(0.5, deltaTime / 16.67 * 1.2); // Normalize to 60fps\n          const newOffset = prev + speed;\n          const fullCycleWidth = 20 * cardPlusGap;\n          \n          // Reset to 0 when full cycle is complete for seamless loop\n          if (newOffset >= fullCycleWidth) {\n            return newOffset - fullCycleWidth;\n          }\n          return newOffset;\n        });\n      }\n      \n      animationFrameRef.current = requestAnimationFrame(animate);\n    };\n\n    animationFrameRef.current = requestAnimationFrame(animate);\n\n    return () => {\n      if (animationFrameRef.current) {\n        cancelAnimationFrame(animationFrameRef.current);\n      }\n    };\n  }, []); // Empty dependency array - only run once on mount\n\n  // Separate effect to handle game state changes without restarting animation\n  useEffect(() => {\n    // Don't restart animation, just let the conditions check in the animation loop\n    console.log('Game state changed:', { isSpinning, winner: !!winner, isLive });\n  }, [isSpinning, winner, isLive]);\n\n  // Select winner based on weighted probability\n  const selectWeightedWinner = () => {\n    const realPlayers = players.filter(p => p.isRealPlayer && p.netBet > 0);\n    if (realPlayers.length === 0) return null;\n\n    // Calculate cumulative weights based on net bet amounts (fair distribution)\n    const totalWeight = realPlayers.reduce((sum, player) => sum + player.netBet, 0);\n    const random = Math.random() * totalWeight;\n    \n    let cumulativeWeight = 0;\n    for (const player of realPlayers) {\n      cumulativeWeight += player.netBet;\n      if (random <= cumulativeWeight) {\n        return player;\n      }\n    }\n    \n    // Fallback to last player\n    return realPlayers[realPlayers.length - 1];\n  };\n\n  // startSpin function removed - unused\n\n  // New function to spin to a specific winner\n  const startSpinToWinner = (targetWinner) => {\n    if (isSpinning) return;\n    \n    console.log('üé∞ Starting spin animation to winner:', targetWinner.name);\n    \n    setPredeterminedWinner(targetWinner);\n    setIsSpinning(true);\n    setWinner(null);\n    \n    // Calculate precise stopping position for the target winner\n    const currentCardWidth = window.innerWidth <= 480 ? 120 : 150;\n    const gap = window.innerWidth <= 480 ? 15 : 20;\n    const cardPlusGap = currentCardWidth + gap;\n    const centerOffset = (window.innerWidth / 2) - (cardPlusGap / 2) - 25;\n    const winnerIndex = players.findIndex(p => \n      p.address === targetWinner.address || p.name === targetWinner.name\n    );\n    \n    if (winnerIndex === -1) {\n      console.error('Winner not found in players array');\n      return;\n    }\n    \n    const baseSpins = 2;\n    const targetCardPosition = winnerIndex * cardPlusGap;\n    const targetPosition = (baseSpins * 20 * cardPlusGap) + targetCardPosition + centerOffset; // Use fixed 20 cards\n    \n    setReelOffset(targetPosition);\n    \n    console.log('üéØ Animation targeting winner:', targetWinner.name, 'at position:', winnerIndex);\n    \n    // Stop spinning after 3 seconds and show winner\n    setTimeout(() => {\n      setIsSpinning(false);\n      setWinner(targetWinner);\n      setPredeterminedWinner(null);\n      \n      // Winner notification is now handled by App.js via socket events\n      \n      // Clear local winner after 3 seconds\n      setTimeout(() => {\n        setWinner(null);\n      }, 3000);\n    }, 3000);\n  };\n\n  // Global winner announcement is now handled by App.js via socket events\n\n  const formatTime = (seconds) => {\n    const mins = Math.floor(seconds / 60);\n    const secs = seconds % 60;\n    return `${mins.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;\n  };\n\n  // Monitor bet confirmation polling status\n  useEffect(() => {\n    // Set up a global handler for bet confirmation updates\n    window.updateBetConfirmationStatus = (status) => {\n      // Function removed since betConfirmationStatus was removed\n    };\n\n    // Set up a global handler for transaction notifications\n    window.showTransactionNotification = (message, type = 'success') => {\n      setTransactionNotification({\n        show: true,\n        message: message,\n        type: type\n      });\n      \n      // Auto-hide after 4 seconds\n      setTimeout(() => {\n        setTransactionNotification({\n          show: false,\n          message: '',\n          type: 'success'\n        });\n      }, 4000);\n    };\n\n    return () => {\n      delete window.updateBetConfirmationStatus;\n      delete window.showTransactionNotification;\n    };\n  }, []);\n\n  // Sync timer once and start local countdown\n  useEffect(() => {\n    const currentRoundId = contractState?.currentRound?.roundNumber || contractState?.timer?.roundNumber;\n    const backendTimer = contractState?.timer?.timeRemaining ?? timeRemaining;\n    \n    // Only sync if we have new round data or timer data changed significantly\n    const needsSync = !lastSyncRef.current || \n                     lastSyncRef.current.roundId !== currentRoundId ||\n                     (backendTimer > 0 && Math.abs(backendTimer - localTimer) > 10);\n    \n    if (needsSync && backendTimer > 0) {\n      console.log('‚è∞ Syncing timer:', backendTimer, 'seconds');\n      setLocalTimer(backendTimer);\n      lastSyncRef.current = {\n        roundId: currentRoundId,\n        timer: backendTimer,\n        timestamp: Date.now()\n      };\n    }\n  }, [contractState?.currentRound?.roundNumber, contractState?.timer?.roundNumber, contractState?.timer?.timeRemaining, timeRemaining, localTimer]);\n\n  // Local countdown timer (runs every second)\n  useEffect(() => {\n    if (localTimer <= 0) return;\n\n    const interval = setInterval(() => {\n      setLocalTimer(prev => {\n        const newTime = Math.max(0, prev - 1);\n        if (newTime === 0) {\n          console.log('‚è∞ Timer reached zero');\n        }\n        return newTime;\n      });\n    }, 1000);\n\n    return () => clearInterval(interval);\n  }, [localTimer]);\n\n  return (\n    <div className=\"game-area\">\n      {/* Jackpot Section */}\n      <div className=\"jackpot-section\">\n        <div className=\"jackpot-header\">\n          <h2>‚ö° JACKPOT</h2>\n          <span className=\"player-count\">{totalPlayers}</span>\n          {adminInfo?.isAutoManaged && (\n            <span className=\"automation-badge\">ü§ñ AUTO</span>\n          )}\n        </div>\n        <p className=\"jackpot-subtitle\">\n          {gameStatus}\n        </p>\n        \n        <div className=\"bet-controls\">\n          <div className=\"bet-amount-display\">\n            <span className=\"bet-amount-value\">{betAmount?.toFixed(1) || '0.0'}</span>\n            <span className=\"currency-label\">TON</span>\n          </div>\n          <div className=\"bet-buttons\">\n            <button className=\"bet-preset\" onClick={() => onBetChange({ target: { value: '0.11' } })}>0.11</button>\n            <button className=\"bet-preset\" onClick={() => onBetChange({ target: { value: '0.5' } })}>0.5</button>\n            <button className=\"bet-preset\" onClick={() => onBetChange({ target: { value: '1.0' } })}>1.0</button>\n            <button className=\"bet-preset\" onClick={() => onBetChange({ target: { value: '2.0' } })}>2.0</button>\n          </div>\n          <button \n            className=\"bet-button\" \n            onClick={onPlaceBet}\n            disabled={!isConnected || !memoizedValues.isContractActive || !isLive || isLoading || isSpinning || waitingForWinner || postWinnerLoading}\n          >\n            {!memoizedValues.isContractActive ? '‚è∏Ô∏è Paused' :\n             isSpinning ? 'üé∞ Spinning...' :\n             waitingForWinner ? 'üéØ Selecting...' :\n             postWinnerLoading ? 'üîÑ New Round...' :\n             isConnected ? 'Bet' : 'Connect Wallet'}\n          </button>\n        </div>\n      </div>\n\n      {/* Stats Grid */}\n      <div className=\"stats-grid\">\n        <div className=\"stat-card jackpot-value\">\n          <div className=\"stat-icon\">üé∞</div>\n          <div className=\"stat-amount\">{totalJackpotValue.toFixed(3)}</div>\n          <div className=\"stat-label\">Total Jackpot</div>\n        </div>\n        \n        <div className=\"stat-card net-payout\">\n          <div className=\"stat-icon\">üí∞</div>\n          <div className=\"stat-amount\">{winnerPrizeValue.toFixed(3)}</div>\n          <div className=\"stat-label\">Winner Gets (95%)</div>\n        </div>\n        \n        <div className=\"stat-card your-wager\">\n          <div className=\"stat-icon\">üéØ</div>\n          <div className=\"stat-amount\">\n            {playerStats.yourWager.toFixed(3)}\n          </div>\n          <div className=\"stat-label\">Your Wager</div>\n        </div>\n        \n        <div className=\"stat-card your-chance\">\n          <div className=\"stat-amount\">\n            {playerStats.yourChance.toFixed(2)}%\n          </div>\n          <div className=\"stat-label\">Your Chance</div>\n        </div>\n        \n        <div className=\"stat-card time-remaining\">\n          <div className=\"stat-amount\">{formatTime(displayTimer)}</div>\n          <div className=\"stat-label\">\n            {contractState?.timer?.isActive ? 'Auto Timer' : 'Time Remaining'}\n          </div>\n        </div>\n      </div>\n\n      {/* Winner Arrow */}\n      <div className=\"winner-arrow-container\">\n        <div className=\"winner-arrow\">\n          <div className=\"arrow\">‚ñº</div>\n        </div>\n      </div>\n\n      {/* Slot Machine */}\n      <div className=\"slot-machine\">\n        <div className=\"slot-frame\">\n          <div className=\"slot-reel-container\">\n            <div \n              className={`slot-reel ${isSpinning ? 'slot-spinning' : 'idle'}`}\n              style={{ \n                transform: `translateX(${-reelOffset}px)`,\n                willChange: 'transform'\n              }}\n            >\n              {extendedPlayers.map((player, index) => (\n                <div key={`${player.id}-${index}`} className=\"slot-card\">\n                  <PlayerSlot \n                    player={player} \n                    isWinner={winner && winner.id === player.id && !isSpinning}\n                    isPredetermined={predeterminedWinner && predeterminedWinner.id === player.id}\n                  />\n                </div>\n              ))}\n            </div>\n          </div>\n          \n          {/* Slot Machine Effects */}\n          {isSpinning && <div className=\"slot-blur\"></div>}\n        </div>\n      </div>\n\n      {/* Footer Info */}\n      <div className=\"footer-info\">\n        <div className=\"payout-info\">\n          ‚ö° Payouts are settled in TON\n          {contractState?.timer?.isActive && (\n            <span className=\"automation-info\"> ‚Ä¢ ü§ñ Automated rounds</span>\n          )}\n        </div>\n        <div className=\"game-stats\">\n          <span className=\"players-count\">üë• {totalPlayers} Players</span>\n          <span className=\"round-number\">Round #{displayRound}</span>\n          {isConnected && (\n            <span className=\"connection-status\">üü¢ Connected</span>\n          )}\n        </div>\n      </div>\n\n      {/* Contract Winner Announcement Overlay */}\n      {showWinnerAnnouncement && contractWinner && (\n        <div className=\"winner-announcement-overlay\">\n          <div className=\"winner-announcement-card\">\n            <div className=\"winner-icon\">üéâ</div>\n            <h3>ROUND WINNER!</h3>\n            <div className=\"winner-details\">\n              <div className=\"winner-address\">{contractWinner.winner}</div>\n              <div className=\"winner-prize\">Won {contractWinner.prize} TON</div>\n            </div>\n            <div className=\"winner-confetti\">üéä üéâ üéä</div>\n          </div>\n        </div>\n      )}\n\n      {/* Big Loading Overlay for Winner Selection */}\n      {waitingForWinner && (\n        <div className=\"winner-selection-loading\">\n          <div className=\"winner-selection-content\">\n            <div className=\"loading-spinner-big\">üéØ</div>\n            <h2>Selecting Winner...</h2>\n            <p>Analyzing bets and picking the winner</p>\n            <div className=\"loading-dots\">\n              <span></span>\n              <span></span>\n              <span></span>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* Post-Winner Loading Overlay */}\n      {postWinnerLoading && (\n        <div className=\"winner-selection-loading\">\n          <div className=\"winner-selection-content\">\n            <div className=\"loading-spinner-big\">üîÑ</div>\n            <h2>Preparing New Round...</h2>\n            <p>Setting up the next jackpot round</p>\n            <div className=\"loading-dots\">\n              <span></span>\n              <span></span>\n              <span></span>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* Transaction Notification */}\n      {transactionNotification.show && (\n        <div className={`transaction-notification ${transactionNotification.type}`}>\n          {transactionNotification.message}\n        </div>\n      )}\n    </div>\n  );\n}\n\nexport default GameArea; "],"mappings":"AAAA,MAAO,CAAAA,KAAK,EAAIC,QAAQ,CAAEC,SAAS,CAAEC,OAAO,CAAEC,MAAM,KAAQ,OAAO,CACnE,MAAO,CAAAC,UAAU,KAAM,cAAc,CACrC,MAAO,gBAAgB,CAAC,OAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,yBAExB,QAAS,CAAAC,QAAQA,CAAAC,IAAA,CAoBd,KAAAC,qBAAA,CAAAC,qBAAA,CAAAC,qBAAA,CAAAC,sBAAA,CAAAC,qBAAA,CAAAC,qBAAA,CAAAC,qBAAA,CAAAC,sBAAA,IApBe,CAChBC,YAAY,CACZC,YAAY,CACZC,aAAa,CACbC,MAAM,CACNC,SAAS,CACTC,WAAW,CACXC,UAAU,CACVC,WAAW,CACXC,SAAS,CACTC,aAAa,CACbC,YAAY,CACZC,aAAa,CACbC,SAAS,CACTC,cAAc,CACd;AACAC,gBAAgB,CAChBC,cAAc,CACdC,iBAAiB,CACjBC,sBACF,CAAC,CAAA1B,IAAA,CACC;AACA,KAAM,CAAC2B,UAAU,CAAEC,aAAa,CAAC,CAAGtC,QAAQ,CAAC,KAAK,CAAC,CACnD,KAAM,CAACuC,UAAU,CAAEC,aAAa,CAAC,CAAGxC,QAAQ,CAAC,CAAC,CAAC,CAC/C,KAAM,CAACyC,MAAM,CAAEC,SAAS,CAAC,CAAG1C,QAAQ,CAAC,IAAI,CAAC,CAC1C,KAAM,CAAC2C,mBAAmB,CAAEC,sBAAsB,CAAC,CAAG5C,QAAQ,CAAC,IAAI,CAAC,CAEpE;AACA;AACA,KAAM,CAAC6C,uBAAuB,CAAEC,0BAA0B,CAAC,CAAG9C,QAAQ,CAAC,CACrE+C,IAAI,CAAE,KAAK,CACXC,OAAO,CAAE,EAAE,CACXC,IAAI,CAAE,SAAU;AAClB,CAAC,CAAC,CAEF;AACA,KAAM,CAAAC,iBAAiB,CAAG/C,MAAM,CAAC,CAAC,CAClC,KAAM,CAACgD,UAAU,CAAEC,aAAa,CAAC,CAAGpD,QAAQ,CAAC,CAAC,CAAC,CAC/C,KAAM,CAAAqD,WAAW,CAAGlD,MAAM,CAAC,IAAI,CAAC,CAEhC;AACA,KAAM,CAAAmD,cAAc,CAAGpD,OAAO,CAAC,IAAM,KAAAqD,qBAAA,CAAAC,oBAAA,CAAAC,qBAAA,CACnC;AACA,KAAM,CAAAC,gBAAgB,CAAG,CAAA5B,aAAa,SAAbA,aAAa,iBAAbA,aAAa,CAAE6B,QAAQ,IAAK,KAAK,CAErD;AACJ,KAAM,CAAAC,YAAY,EAAAL,qBAAA,CAAGzB,aAAa,SAAbA,aAAa,kBAAA0B,oBAAA,CAAb1B,aAAa,CAAE+B,KAAK,UAAAL,oBAAA,iBAApBA,oBAAA,CAAsBnC,aAAa,UAAAkC,qBAAA,UAAAA,qBAAA,CAAIlC,aAAa,CACzE,KAAM,CAAAyC,YAAY,CAAGJ,gBAAgB,CAAIP,UAAU,CAAG,CAAC,CAAGA,UAAU,CAAGS,YAAY,CAAI,CAAC,CAEpF;AACJ,GAAIA,YAAY,CAAG,CAAC,EAAIG,IAAI,CAACC,GAAG,CAACJ,YAAY,CAAGT,UAAU,CAAC,CAAG,CAAC,CAAE,CAC/Dc,OAAO,CAACC,GAAG,CAAC,qBAAqB,CAAE,CACjCC,OAAO,CAAEP,YAAY,CACrBQ,KAAK,CAAEjB,UAAU,CACjBkB,KAAK,CAAEP,YACT,CAAC,CAAC,CACJ,CACD,KAAM,CAAAQ,YAAY,CAAG,CAAAxC,aAAa,SAAbA,aAAa,kBAAA2B,qBAAA,CAAb3B,aAAa,CAAE+B,KAAK,UAAAJ,qBAAA,iBAApBA,qBAAA,CAAsBc,WAAW,GAAInD,YAAY,CACtE,KAAM,CAAAoD,YAAY,CAAGd,gBAAgB,CAAI,CAAA5B,aAAa,SAAbA,aAAa,iBAAbA,aAAa,CAAE2C,QAAQ,IAAIzC,cAAc,SAAdA,cAAc,iBAAdA,cAAc,CAAE0C,MAAM,GAAI,CAAC,CAAI,CAAC,CAEpG;AACA,KAAM,CAAAC,iBAAiB,CAAGjB,gBAAgB,CAAI,CAAA5B,aAAa,SAAbA,aAAa,iBAAbA,aAAa,CAAE8C,YAAY,GAAIzD,YAAY,EAAI,CAAC,CAAI,CAAC,CAEnG;AACA,KAAM,CAAA0D,gBAAgB,CAAGF,iBAAiB,CAAG,IAAI,CAEjD,MAAO,CACLb,YAAY,CACZQ,YAAY,CACZE,YAAY,CACZG,iBAAiB,CAAEG,UAAU,CAACH,iBAAiB,CAACI,OAAO,CAAC,CAAC,CAAC,CAAC,CAAE;AAC7DF,gBAAgB,CAAEC,UAAU,CAACD,gBAAgB,CAACE,OAAO,CAAC,CAAC,CAAC,CAAC,CAAE;AAC3DrB,gBACF,CAAC,CACH,CAAC,CAAE,CAAC5B,aAAa,SAAbA,aAAa,iBAAbA,aAAa,CAAE6B,QAAQ,CAAE7B,aAAa,SAAbA,aAAa,kBAAAnB,qBAAA,CAAbmB,aAAa,CAAE+B,KAAK,UAAAlD,qBAAA,iBAApBA,qBAAA,CAAsB4D,WAAW,CAAEzC,aAAa,SAAbA,aAAa,iBAAbA,aAAa,CAAE2C,QAAQ,CAAE3C,aAAa,SAAbA,aAAa,iBAAbA,aAAa,CAAE8C,YAAY,CAAE9C,aAAa,SAAbA,aAAa,kBAAAlB,qBAAA,CAAbkB,aAAa,CAAE+B,KAAK,UAAAjD,qBAAA,iBAApBA,qBAAA,CAAsBS,aAAa,CACrJW,cAAc,CAAEZ,YAAY,CAAED,YAAY,CAAEE,aAAa,CAAE8B,UAAU,CAAC,CAAC,CAE3E;AACA,KAAM,CAAA6B,WAAW,CAAG9E,OAAO,CAAC,IAAM,CAChC;AACA,GAAI,CAACoD,cAAc,CAACI,gBAAgB,CAAE,CACpC,MAAO,CACLuB,SAAS,CAAE,CAAC,CACZC,UAAU,CAAE,CACd,CAAC,CACH,CAEA;AACA,KAAM,CAAAC,UAAU,CAAGnD,cAAc,SAAdA,cAAc,iBAAdA,cAAc,CAAEoD,IAAI,CAACC,MAAM,EAC5CA,MAAM,CAACC,OAAO,IAAKxD,aAAa,SAAbA,aAAa,iBAAbA,aAAa,CAAEyD,WAAW,GAC7CF,MAAM,CAACG,WAAW,IAAK1D,aAAa,SAAbA,aAAa,iBAAbA,aAAa,CAAEyD,WAAW,CACnD,CAAC,CAED,KAAM,CAAAN,SAAS,CAAGE,UAAU,CAAGA,UAAU,CAACM,MAAM,CAAG5D,YAAY,EAAI,CAAC,CAAE;AAEtE;AACA,KAAM,CAAAqD,UAAU,CAAGtD,aAAa,CAAG,CAAC,CAAGA,aAAa,CACjDuD,UAAU,SAAVA,UAAU,WAAVA,UAAU,CAAEM,MAAM,EAAInC,cAAc,CAACqB,iBAAiB,CAAG,CAAC,CACxDQ,UAAU,CAACM,MAAM,CAAG,GAAG,CAAInC,cAAc,CAACqB,iBAAiB,CAAG,CAAE,CAErE,MAAO,CACLM,SAAS,CAAEH,UAAU,CAACG,SAAS,CAACF,OAAO,CAAC,CAAC,CAAC,CAAC,CAAE;AAC7CG,UAAU,CAAEJ,UAAU,CAACI,UAAU,CAACH,OAAO,CAAC,CAAC,CAAC,CAAE;AAChD,CAAC,CACH,CAAC,CAAE,CAAC/C,cAAc,CAAEF,aAAa,SAAbA,aAAa,iBAAbA,aAAa,CAAEyD,WAAW,CAAE1D,YAAY,CAAED,aAAa,CAAE0B,cAAc,CAACqB,iBAAiB,CAAErB,cAAc,CAACI,gBAAgB,CAAC,CAAC,CAEhJ;AACA,KAAM,CAAAgC,UAAU,CAAGxF,OAAO,CAAC,IAAM,CAC/B,GAAI,CAACoD,cAAc,CAACI,gBAAgB,CAAE,MAAO,sBAAsB,CACnE,GAAIzB,gBAAgB,CAAE,MAAO,wBAAwB,CACrD,GAAI,CAACX,MAAM,CAAE,MAAO,CAAAS,SAAS,SAATA,SAAS,WAATA,SAAS,CAAE4D,aAAa,CAAG,gCAAgC,CAAG,2BAA2B,CAC7G,GAAIlD,MAAM,CAAE,sBAAAmD,MAAA,CAAanD,MAAM,CAACoD,IAAI,WAAAD,MAAA,CAAStC,cAAc,CAACuB,gBAAgB,CAACE,OAAO,CAAC,CAAC,CAAC,UACvF,GAAI1C,UAAU,CAAE,MAAO,gBAAgB,CACvC,GAAIiB,cAAc,CAACQ,YAAY,EAAI,CAAC,EAAIR,cAAc,CAACkB,YAAY,CAAG,CAAC,CAAE,MAAO,sBAAsB,CACtG,GAAIlB,cAAc,CAACkB,YAAY,GAAK,CAAC,CAAE,MAAO,8BAA8B,CAC5E,sBAAAoB,MAAA,CAAatC,cAAc,CAACkB,YAAY,YAAAoB,MAAA,CAAUtC,cAAc,CAACkB,YAAY,GAAK,CAAC,CAAG,GAAG,CAAG,EAAE,gBAChG,CAAC,CAAE,CAACvC,gBAAgB,CAAEX,MAAM,CAAEmB,MAAM,CAAEJ,UAAU,CAAEN,SAAS,SAATA,SAAS,iBAATA,SAAS,CAAE4D,aAAa,CAAErC,cAAc,CAAC,CAAC,CAE5F,KAAM,CAAEQ,YAAY,CAAEQ,YAAY,CAAEE,YAAY,CAAEG,iBAAiB,CAAEE,gBAAiB,CAAC,CAAGvB,cAAc,CAExG;AACA,KAAM,CAAAwC,OAAO,CAAG5F,OAAO,CAAC,IAAM,CAC5B;AACA,KAAM,CAAA6F,WAAW,CAAG,EAAE,CACtB,KAAM,CAAAC,YAAY,CAAG,EAAE,CAEvB;AACA,GAAI1C,cAAc,CAACI,gBAAgB,EAAI1B,cAAc,EAAIA,cAAc,CAAC0C,MAAM,CAAG,CAAC,CAAE,CAClF1C,cAAc,CAACiE,OAAO,CAAC,CAACZ,MAAM,CAAEa,KAAK,GAAK,CACxC,GAAIA,KAAK,CAAGH,WAAW,CAAE,CAAE;AACzB;AACA,KAAM,CAAAI,YAAY,CAAGpC,IAAI,CAACqC,GAAG,CAAC,CAAC,CAAEf,MAAM,CAACI,MAAM,CAAG,GAAG,CAAC,CAErD;AACA,KAAM,CAAAY,SAAS,CAAG/C,cAAc,CAACqB,iBAAiB,CAAG,CAAC,CACnDU,MAAM,CAACI,MAAM,CAAG,GAAG,CAAInC,cAAc,CAACqB,iBAAiB,CAAG,CAAC,CAE9DqB,YAAY,CAACM,IAAI,CAAC,CAChBC,EAAE,CAAEL,KAAK,CAAG,CAAC,CACbL,IAAI,CAAER,MAAM,CAACmB,QAAQ,CACrBC,MAAM,CAAE,IAAI,CACZC,GAAG,CAAErB,MAAM,CAACI,MAAM,CAAE;AACpBkB,MAAM,CAAER,YAAY,CAAE;AACtBS,MAAM,CAAEP,SAAS,CACjBf,OAAO,CAAED,MAAM,CAACC,OAAO,CACvBuB,YAAY,CAAE,IAChB,CAAC,CAAC,CACJ,CACF,CAAC,CAAC,CACJ,CAEA;AACA,MAAOb,YAAY,CAACtB,MAAM,CAAGqB,WAAW,CAAE,CACxCC,YAAY,CAACM,IAAI,CAAC,CAChBC,EAAE,CAAEP,YAAY,CAACtB,MAAM,CAAG,CAAC,CAC3BmB,IAAI,CAAE,SAAS,CACfY,MAAM,CAAE,GAAG,CACXC,GAAG,CAAE,CAAC,CACNC,MAAM,CAAE,CAAC,CACTC,MAAM,CAAE,CAAC,CACTC,YAAY,CAAE,KAChB,CAAC,CAAC,CACJ,CAEA,MAAO,CAAAb,YAAY,CACrB,CAAC,CAAE,CAAChE,cAAc,CAAEsB,cAAc,CAACqB,iBAAiB,CAAErB,cAAc,CAACI,gBAAgB,CAAC,CAAC,CAAE;AAEzF;AACA,KAAM,CAAAoD,eAAe,CAAG5G,OAAO,CAAC,IAAM,CACpC,KAAM,CAAA6G,QAAQ,CAAG,EAAE,CACnB,IAAK,GAAI,CAAAC,CAAC,CAAG,CAAC,CAAEA,CAAC,CAAG,EAAE,CAAEA,CAAC,EAAE,CAAE,CAC3BD,QAAQ,CAACT,IAAI,CAAC,GAAGR,OAAO,CAAC,CAC3B,CACA,MAAO,CAAAiB,QAAQ,CACjB,CAAC,CAAE,CAACjB,OAAO,CAAC,CAAC,CAEb;AACA,KAAM,CAACmB,eAAe,CAAEC,kBAAkB,CAAC,CAAGlH,QAAQ,CAAC,IAAI,CAAC,CAE5DC,SAAS,CAAC,IAAM,KAAAkH,qBAAA,CACd,KAAM,CAAAC,kBAAkB,CAAGtF,aAAa,SAAbA,aAAa,kBAAAqF,qBAAA,CAAbrF,aAAa,CAAE+B,KAAK,UAAAsD,qBAAA,iBAApBA,qBAAA,CAAsB5C,WAAW,CAE5D;AACA,GAAI6C,kBAAkB,EAAIA,kBAAkB,GAAKH,eAAe,CAAE,CAChEhD,OAAO,CAACC,GAAG,qCAAA0B,MAAA,CAA2BqB,eAAe,aAAArB,MAAA,CAAMwB,kBAAkB,CAAE,CAAC,CAEhF;AACA9E,aAAa,CAAC,KAAK,CAAC,CACpBE,aAAa,CAAC,CAAC,CAAC,CAChBE,SAAS,CAAC,IAAI,CAAC,CACfE,sBAAsB,CAAC,IAAI,CAAC,CAE5BsE,kBAAkB,CAACE,kBAAkB,CAAC,CACxC,CACF,CAAC,CAAE,CAACpF,cAAc,CAAEqF,iBAAiB,CAAEvF,aAAa,SAAbA,aAAa,kBAAAjB,qBAAA,CAAbiB,aAAa,CAAE+B,KAAK,UAAAhD,qBAAA,iBAApBA,qBAAA,CAAsB0D,WAAW,CAAE0C,eAAe,CAAC,CAAC,CAE3F;AACAhH,SAAS,CAAC,IAAM,CACd;AACA,GAAIiC,cAAc,EAAI,CAACG,UAAU,EAAI,CAACI,MAAM,CAAE,CAC5CwB,OAAO,CAACC,GAAG,CAAC,iDAAiD,CAAEhC,cAAc,CAAC,CAE9E;AACA,KAAM,CAAAoF,YAAY,CAAGxB,OAAO,CAACV,IAAI,CAACmC,CAAC,EACjCA,CAAC,CAACjC,OAAO,GAAKpD,cAAc,CAACoD,OAAO,EACpCiC,CAAC,CAAC1B,IAAI,GAAK3D,cAAc,CAAC2D,IAAI,EAC9B0B,CAAC,CAAC1B,IAAI,GAAK3D,cAAc,CAACsE,QAC5B,CAAC,CAED,GAAIc,YAAY,CAAE,CAChBD,iBAAiB,CAACC,YAAY,CAAC,CACjC,CAAC,IAAM,CACLrD,OAAO,CAACuD,IAAI,CAAC,8BAA8B,CAAEtF,cAAc,CAAC,CAC9D,CACF,CACF,CAAC,CAAE,CAACG,UAAU,CAAEI,MAAM,CAAEP,cAAc,CAAE4D,OAAO,CAAEuB,iBAAiB,CAAC,CAAC,CAEpE;AACApH,SAAS,CAAC,IAAM,CACd,GAAI,CAAAwH,aAAa,CAAG,CAAC,CAErB,KAAM,CAAAC,OAAO,CAAIC,SAAS,EAAK,CAC7B;AACA,GAAI,CAACtF,UAAU,EAAI,CAACI,MAAM,CAAE,CAC1B;AACA,KAAM,CAAAmF,SAAS,CAAGD,SAAS,CAAGF,aAAa,CAC3CA,aAAa,CAAGE,SAAS,CAEzBnF,aAAa,CAACqF,IAAI,EAAI,CACpB,KAAM,CAAAC,gBAAgB,CAAGC,MAAM,CAACC,UAAU,EAAI,GAAG,CAAG,GAAG,CAAG,GAAG,CAC7D,KAAM,CAAAC,GAAG,CAAGF,MAAM,CAACC,UAAU,EAAI,GAAG,CAAG,EAAE,CAAG,EAAE,CAC9C,KAAM,CAAAE,WAAW,CAAGJ,gBAAgB,CAAGG,GAAG,CAE1C;AACA,KAAM,CAAAE,KAAK,CAAGpE,IAAI,CAACqC,GAAG,CAAC,GAAG,CAAEwB,SAAS,CAAG,KAAK,CAAG,GAAG,CAAC,CAAE;AACtD,KAAM,CAAAQ,SAAS,CAAGP,IAAI,CAAGM,KAAK,CAC9B,KAAM,CAAAE,cAAc,CAAG,EAAE,CAAGH,WAAW,CAEvC;AACA,GAAIE,SAAS,EAAIC,cAAc,CAAE,CAC/B,MAAO,CAAAD,SAAS,CAAGC,cAAc,CACnC,CACA,MAAO,CAAAD,SAAS,CAClB,CAAC,CAAC,CACJ,CAEAlF,iBAAiB,CAACoF,OAAO,CAAGC,qBAAqB,CAACb,OAAO,CAAC,CAC5D,CAAC,CAEDxE,iBAAiB,CAACoF,OAAO,CAAGC,qBAAqB,CAACb,OAAO,CAAC,CAE1D,MAAO,IAAM,CACX,GAAIxE,iBAAiB,CAACoF,OAAO,CAAE,CAC7BE,oBAAoB,CAACtF,iBAAiB,CAACoF,OAAO,CAAC,CACjD,CACF,CAAC,CACH,CAAC,CAAE,EAAE,CAAC,CAAE;AAER;AACArI,SAAS,CAAC,IAAM,CACd;AACAgE,OAAO,CAACC,GAAG,CAAC,qBAAqB,CAAE,CAAE7B,UAAU,CAAEI,MAAM,CAAE,CAAC,CAACA,MAAM,CAAEnB,MAAO,CAAC,CAAC,CAC9E,CAAC,CAAE,CAACe,UAAU,CAAEI,MAAM,CAAEnB,MAAM,CAAC,CAAC,CAEhC;AACA,KAAM,CAAAmH,oBAAoB,CAAGA,CAAA,GAAM,CACjC,KAAM,CAAAC,WAAW,CAAG5C,OAAO,CAAC6C,MAAM,CAACpB,CAAC,EAAIA,CAAC,CAACV,YAAY,EAAIU,CAAC,CAACZ,MAAM,CAAG,CAAC,CAAC,CACvE,GAAI+B,WAAW,CAAChE,MAAM,GAAK,CAAC,CAAE,MAAO,KAAI,CAEzC;AACA,KAAM,CAAAkE,WAAW,CAAGF,WAAW,CAACG,MAAM,CAAC,CAACC,GAAG,CAAEC,MAAM,GAAKD,GAAG,CAAGC,MAAM,CAACpC,MAAM,CAAE,CAAC,CAAC,CAC/E,KAAM,CAAAqC,MAAM,CAAGjF,IAAI,CAACiF,MAAM,CAAC,CAAC,CAAGJ,WAAW,CAE1C,GAAI,CAAAK,gBAAgB,CAAG,CAAC,CACxB,IAAK,KAAM,CAAAF,MAAM,GAAI,CAAAL,WAAW,CAAE,CAChCO,gBAAgB,EAAIF,MAAM,CAACpC,MAAM,CACjC,GAAIqC,MAAM,EAAIC,gBAAgB,CAAE,CAC9B,MAAO,CAAAF,MAAM,CACf,CACF,CAEA;AACA,MAAO,CAAAL,WAAW,CAACA,WAAW,CAAChE,MAAM,CAAG,CAAC,CAAC,CAC5C,CAAC,CAED;AAEA;AACA,KAAM,CAAA2C,iBAAiB,CAAIC,YAAY,EAAK,CAC1C,GAAIjF,UAAU,CAAE,OAEhB4B,OAAO,CAACC,GAAG,CAAC,uCAAuC,CAAEoD,YAAY,CAACzB,IAAI,CAAC,CAEvEjD,sBAAsB,CAAC0E,YAAY,CAAC,CACpChF,aAAa,CAAC,IAAI,CAAC,CACnBI,SAAS,CAAC,IAAI,CAAC,CAEf;AACA,KAAM,CAAAoF,gBAAgB,CAAGC,MAAM,CAACC,UAAU,EAAI,GAAG,CAAG,GAAG,CAAG,GAAG,CAC7D,KAAM,CAAAC,GAAG,CAAGF,MAAM,CAACC,UAAU,EAAI,GAAG,CAAG,EAAE,CAAG,EAAE,CAC9C,KAAM,CAAAE,WAAW,CAAGJ,gBAAgB,CAAGG,GAAG,CAC1C,KAAM,CAAAiB,YAAY,CAAInB,MAAM,CAACC,UAAU,CAAG,CAAC,CAAKE,WAAW,CAAG,CAAE,CAAG,EAAE,CACrE,KAAM,CAAAiB,WAAW,CAAGrD,OAAO,CAACsD,SAAS,CAAC7B,CAAC,EACrCA,CAAC,CAACjC,OAAO,GAAKgC,YAAY,CAAChC,OAAO,EAAIiC,CAAC,CAAC1B,IAAI,GAAKyB,YAAY,CAACzB,IAChE,CAAC,CAED,GAAIsD,WAAW,GAAK,CAAC,CAAC,CAAE,CACtBlF,OAAO,CAACoF,KAAK,CAAC,mCAAmC,CAAC,CAClD,OACF,CAEA,KAAM,CAAAC,SAAS,CAAG,CAAC,CACnB,KAAM,CAAAC,kBAAkB,CAAGJ,WAAW,CAAGjB,WAAW,CACpD,KAAM,CAAAsB,cAAc,CAAIF,SAAS,CAAG,EAAE,CAAGpB,WAAW,CAAIqB,kBAAkB,CAAGL,YAAY,CAAE;AAE3F1G,aAAa,CAACgH,cAAc,CAAC,CAE7BvF,OAAO,CAACC,GAAG,CAAC,gCAAgC,CAAEoD,YAAY,CAACzB,IAAI,CAAE,cAAc,CAAEsD,WAAW,CAAC,CAE7F;AACAM,UAAU,CAAC,IAAM,CACfnH,aAAa,CAAC,KAAK,CAAC,CACpBI,SAAS,CAAC4E,YAAY,CAAC,CACvB1E,sBAAsB,CAAC,IAAI,CAAC,CAE5B;AAEA;AACA6G,UAAU,CAAC,IAAM,CACf/G,SAAS,CAAC,IAAI,CAAC,CACjB,CAAC,CAAE,IAAI,CAAC,CACV,CAAC,CAAE,IAAI,CAAC,CACV,CAAC,CAED;AAEA,KAAM,CAAAgH,UAAU,CAAIC,OAAO,EAAK,CAC9B,KAAM,CAAAC,IAAI,CAAG7F,IAAI,CAAC8F,KAAK,CAACF,OAAO,CAAG,EAAE,CAAC,CACrC,KAAM,CAAAG,IAAI,CAAGH,OAAO,CAAG,EAAE,CACzB,SAAA/D,MAAA,CAAUgE,IAAI,CAACG,QAAQ,CAAC,CAAC,CAACC,QAAQ,CAAC,CAAC,CAAE,GAAG,CAAC,MAAApE,MAAA,CAAIkE,IAAI,CAACC,QAAQ,CAAC,CAAC,CAACC,QAAQ,CAAC,CAAC,CAAE,GAAG,CAAC,EAChF,CAAC,CAED;AACA/J,SAAS,CAAC,IAAM,CACd;AACA8H,MAAM,CAACkC,2BAA2B,CAAIC,MAAM,EAAK,CAC/C;AAAA,CACD,CAED;AACAnC,MAAM,CAACoC,2BAA2B,CAAG,SAACnH,OAAO,CAAuB,IAArB,CAAAC,IAAI,CAAAmH,SAAA,CAAA1F,MAAA,IAAA0F,SAAA,MAAAC,SAAA,CAAAD,SAAA,IAAG,SAAS,CAC7DtH,0BAA0B,CAAC,CACzBC,IAAI,CAAE,IAAI,CACVC,OAAO,CAAEA,OAAO,CAChBC,IAAI,CAAEA,IACR,CAAC,CAAC,CAEF;AACAwG,UAAU,CAAC,IAAM,CACf3G,0BAA0B,CAAC,CACzBC,IAAI,CAAE,KAAK,CACXC,OAAO,CAAE,EAAE,CACXC,IAAI,CAAE,SACR,CAAC,CAAC,CACJ,CAAC,CAAE,IAAI,CAAC,CACV,CAAC,CAED,MAAO,IAAM,CACX,MAAO,CAAA8E,MAAM,CAACkC,2BAA2B,CACzC,MAAO,CAAAlC,MAAM,CAACoC,2BAA2B,CAC3C,CAAC,CACH,CAAC,CAAE,EAAE,CAAC,CAEN;AACAlK,SAAS,CAAC,IAAM,KAAAqK,qBAAA,CAAAC,qBAAA,CAAAC,sBAAA,CAAAC,qBAAA,CACd,KAAM,CAAAC,cAAc,CAAG,CAAA5I,aAAa,SAAbA,aAAa,kBAAAwI,qBAAA,CAAbxI,aAAa,CAAEV,YAAY,UAAAkJ,qBAAA,iBAA3BA,qBAAA,CAA6B/F,WAAW,IAAIzC,aAAa,SAAbA,aAAa,kBAAAyI,qBAAA,CAAbzI,aAAa,CAAE+B,KAAK,UAAA0G,qBAAA,iBAApBA,qBAAA,CAAsBhG,WAAW,EACpG,KAAM,CAAAX,YAAY,EAAA4G,sBAAA,CAAG1I,aAAa,SAAbA,aAAa,kBAAA2I,qBAAA,CAAb3I,aAAa,CAAE+B,KAAK,UAAA4G,qBAAA,iBAApBA,qBAAA,CAAsBpJ,aAAa,UAAAmJ,sBAAA,UAAAA,sBAAA,CAAInJ,aAAa,CAEzE;AACA,KAAM,CAAAsJ,SAAS,CAAG,CAACtH,WAAW,CAACiF,OAAO,EACrBjF,WAAW,CAACiF,OAAO,CAACsC,OAAO,GAAKF,cAAc,EAC7C9G,YAAY,CAAG,CAAC,EAAIG,IAAI,CAACC,GAAG,CAACJ,YAAY,CAAGT,UAAU,CAAC,CAAG,EAAG,CAE/E,GAAIwH,SAAS,EAAI/G,YAAY,CAAG,CAAC,CAAE,CACjCK,OAAO,CAACC,GAAG,CAAC,kBAAkB,CAAEN,YAAY,CAAE,SAAS,CAAC,CACxDR,aAAa,CAACQ,YAAY,CAAC,CAC3BP,WAAW,CAACiF,OAAO,CAAG,CACpBsC,OAAO,CAAEF,cAAc,CACvB7G,KAAK,CAAED,YAAY,CACnB+D,SAAS,CAAEkD,IAAI,CAACC,GAAG,CAAC,CACtB,CAAC,CACH,CACF,CAAC,CAAE,CAAChJ,aAAa,SAAbA,aAAa,kBAAAhB,sBAAA,CAAbgB,aAAa,CAAEV,YAAY,UAAAN,sBAAA,iBAA3BA,sBAAA,CAA6ByD,WAAW,CAAEzC,aAAa,SAAbA,aAAa,kBAAAf,qBAAA,CAAbe,aAAa,CAAE+B,KAAK,UAAA9C,qBAAA,iBAApBA,qBAAA,CAAsBwD,WAAW,CAAEzC,aAAa,SAAbA,aAAa,kBAAAd,qBAAA,CAAbc,aAAa,CAAE+B,KAAK,UAAA7C,qBAAA,iBAApBA,qBAAA,CAAsBK,aAAa,CAAEA,aAAa,CAAE8B,UAAU,CAAC,CAAC,CAEjJ;AACAlD,SAAS,CAAC,IAAM,CACd,GAAIkD,UAAU,EAAI,CAAC,CAAE,OAErB,KAAM,CAAA4H,QAAQ,CAAGC,WAAW,CAAC,IAAM,CACjC5H,aAAa,CAACyE,IAAI,EAAI,CACpB,KAAM,CAAAoD,OAAO,CAAGlH,IAAI,CAACqC,GAAG,CAAC,CAAC,CAAEyB,IAAI,CAAG,CAAC,CAAC,CACrC,GAAIoD,OAAO,GAAK,CAAC,CAAE,CACjBhH,OAAO,CAACC,GAAG,CAAC,sBAAsB,CAAC,CACrC,CACA,MAAO,CAAA+G,OAAO,CAChB,CAAC,CAAC,CACJ,CAAC,CAAE,IAAI,CAAC,CAER,MAAO,IAAMC,aAAa,CAACH,QAAQ,CAAC,CACtC,CAAC,CAAE,CAAC5H,UAAU,CAAC,CAAC,CAEhB,mBACE3C,KAAA,QAAK2K,SAAS,CAAC,WAAW,CAAAC,QAAA,eAExB5K,KAAA,QAAK2K,SAAS,CAAC,iBAAiB,CAAAC,QAAA,eAC9B5K,KAAA,QAAK2K,SAAS,CAAC,gBAAgB,CAAAC,QAAA,eAC7B9K,IAAA,OAAA8K,QAAA,CAAI,gBAAS,CAAI,CAAC,cAClB9K,IAAA,SAAM6K,SAAS,CAAC,cAAc,CAAAC,QAAA,CAAE5G,YAAY,CAAO,CAAC,CACnD,CAAAzC,SAAS,SAATA,SAAS,iBAATA,SAAS,CAAE4D,aAAa,gBACvBrF,IAAA,SAAM6K,SAAS,CAAC,kBAAkB,CAAAC,QAAA,CAAC,mBAAO,CAAM,CACjD,EACE,CAAC,cACN9K,IAAA,MAAG6K,SAAS,CAAC,kBAAkB,CAAAC,QAAA,CAC5B1F,UAAU,CACV,CAAC,cAEJlF,KAAA,QAAK2K,SAAS,CAAC,cAAc,CAAAC,QAAA,eAC3B5K,KAAA,QAAK2K,SAAS,CAAC,oBAAoB,CAAAC,QAAA,eACjC9K,IAAA,SAAM6K,SAAS,CAAC,kBAAkB,CAAAC,QAAA,CAAE,CAAA7J,SAAS,SAATA,SAAS,iBAATA,SAAS,CAAEwD,OAAO,CAAC,CAAC,CAAC,GAAI,KAAK,CAAO,CAAC,cAC1EzE,IAAA,SAAM6K,SAAS,CAAC,gBAAgB,CAAAC,QAAA,CAAC,KAAG,CAAM,CAAC,EACxC,CAAC,cACN5K,KAAA,QAAK2K,SAAS,CAAC,aAAa,CAAAC,QAAA,eAC1B9K,IAAA,WAAQ6K,SAAS,CAAC,YAAY,CAACE,OAAO,CAAEA,CAAA,GAAM7J,WAAW,CAAC,CAAE8J,MAAM,CAAE,CAAEC,KAAK,CAAE,MAAO,CAAE,CAAC,CAAE,CAAAH,QAAA,CAAC,MAAI,CAAQ,CAAC,cACvG9K,IAAA,WAAQ6K,SAAS,CAAC,YAAY,CAACE,OAAO,CAAEA,CAAA,GAAM7J,WAAW,CAAC,CAAE8J,MAAM,CAAE,CAAEC,KAAK,CAAE,KAAM,CAAE,CAAC,CAAE,CAAAH,QAAA,CAAC,KAAG,CAAQ,CAAC,cACrG9K,IAAA,WAAQ6K,SAAS,CAAC,YAAY,CAACE,OAAO,CAAEA,CAAA,GAAM7J,WAAW,CAAC,CAAE8J,MAAM,CAAE,CAAEC,KAAK,CAAE,KAAM,CAAE,CAAC,CAAE,CAAAH,QAAA,CAAC,KAAG,CAAQ,CAAC,cACrG9K,IAAA,WAAQ6K,SAAS,CAAC,YAAY,CAACE,OAAO,CAAEA,CAAA,GAAM7J,WAAW,CAAC,CAAE8J,MAAM,CAAE,CAAEC,KAAK,CAAE,KAAM,CAAE,CAAC,CAAE,CAAAH,QAAA,CAAC,KAAG,CAAQ,CAAC,EAClG,CAAC,cACN9K,IAAA,WACE6K,SAAS,CAAC,YAAY,CACtBE,OAAO,CAAE5J,UAAW,CACpB+J,QAAQ,CAAE,CAAC9J,WAAW,EAAI,CAAC4B,cAAc,CAACI,gBAAgB,EAAI,CAACpC,MAAM,EAAIK,SAAS,EAAIU,UAAU,EAAIJ,gBAAgB,EAAIE,iBAAkB,CAAAiJ,QAAA,CAEzI,CAAC9H,cAAc,CAACI,gBAAgB,CAAG,WAAW,CAC9CrB,UAAU,CAAG,gBAAgB,CAC7BJ,gBAAgB,CAAG,iBAAiB,CACpCE,iBAAiB,CAAG,iBAAiB,CACrCT,WAAW,CAAG,KAAK,CAAG,gBAAgB,CACjC,CAAC,EACN,CAAC,EACH,CAAC,cAGNlB,KAAA,QAAK2K,SAAS,CAAC,YAAY,CAAAC,QAAA,eACzB5K,KAAA,QAAK2K,SAAS,CAAC,yBAAyB,CAAAC,QAAA,eACtC9K,IAAA,QAAK6K,SAAS,CAAC,WAAW,CAAAC,QAAA,CAAC,cAAE,CAAK,CAAC,cACnC9K,IAAA,QAAK6K,SAAS,CAAC,aAAa,CAAAC,QAAA,CAAEzG,iBAAiB,CAACI,OAAO,CAAC,CAAC,CAAC,CAAM,CAAC,cACjEzE,IAAA,QAAK6K,SAAS,CAAC,YAAY,CAAAC,QAAA,CAAC,eAAa,CAAK,CAAC,EAC5C,CAAC,cAEN5K,KAAA,QAAK2K,SAAS,CAAC,sBAAsB,CAAAC,QAAA,eACnC9K,IAAA,QAAK6K,SAAS,CAAC,WAAW,CAAAC,QAAA,CAAC,cAAE,CAAK,CAAC,cACnC9K,IAAA,QAAK6K,SAAS,CAAC,aAAa,CAAAC,QAAA,CAAEvG,gBAAgB,CAACE,OAAO,CAAC,CAAC,CAAC,CAAM,CAAC,cAChEzE,IAAA,QAAK6K,SAAS,CAAC,YAAY,CAAAC,QAAA,CAAC,mBAAiB,CAAK,CAAC,EAChD,CAAC,cAEN5K,KAAA,QAAK2K,SAAS,CAAC,sBAAsB,CAAAC,QAAA,eACnC9K,IAAA,QAAK6K,SAAS,CAAC,WAAW,CAAAC,QAAA,CAAC,cAAE,CAAK,CAAC,cACnC9K,IAAA,QAAK6K,SAAS,CAAC,aAAa,CAAAC,QAAA,CACzBpG,WAAW,CAACC,SAAS,CAACF,OAAO,CAAC,CAAC,CAAC,CAC9B,CAAC,cACNzE,IAAA,QAAK6K,SAAS,CAAC,YAAY,CAAAC,QAAA,CAAC,YAAU,CAAK,CAAC,EACzC,CAAC,cAEN5K,KAAA,QAAK2K,SAAS,CAAC,uBAAuB,CAAAC,QAAA,eACpC5K,KAAA,QAAK2K,SAAS,CAAC,aAAa,CAAAC,QAAA,EACzBpG,WAAW,CAACE,UAAU,CAACH,OAAO,CAAC,CAAC,CAAC,CAAC,GACrC,EAAK,CAAC,cACNzE,IAAA,QAAK6K,SAAS,CAAC,YAAY,CAAAC,QAAA,CAAC,aAAW,CAAK,CAAC,EAC1C,CAAC,cAEN5K,KAAA,QAAK2K,SAAS,CAAC,0BAA0B,CAAAC,QAAA,eACvC9K,IAAA,QAAK6K,SAAS,CAAC,aAAa,CAAAC,QAAA,CAAE1B,UAAU,CAAC5F,YAAY,CAAC,CAAM,CAAC,cAC7DxD,IAAA,QAAK6K,SAAS,CAAC,YAAY,CAAAC,QAAA,CACxBtJ,aAAa,SAAbA,aAAa,YAAAb,qBAAA,CAAba,aAAa,CAAE+B,KAAK,UAAA5C,qBAAA,WAApBA,qBAAA,CAAsB0C,QAAQ,CAAG,YAAY,CAAG,gBAAgB,CAC9D,CAAC,EACH,CAAC,EACH,CAAC,cAGNrD,IAAA,QAAK6K,SAAS,CAAC,wBAAwB,CAAAC,QAAA,cACrC9K,IAAA,QAAK6K,SAAS,CAAC,cAAc,CAAAC,QAAA,cAC3B9K,IAAA,QAAK6K,SAAS,CAAC,OAAO,CAAAC,QAAA,CAAC,QAAC,CAAK,CAAC,CAC3B,CAAC,CACH,CAAC,cAGN9K,IAAA,QAAK6K,SAAS,CAAC,cAAc,CAAAC,QAAA,cAC3B5K,KAAA,QAAK2K,SAAS,CAAC,YAAY,CAAAC,QAAA,eACzB9K,IAAA,QAAK6K,SAAS,CAAC,qBAAqB,CAAAC,QAAA,cAClC9K,IAAA,QACE6K,SAAS,cAAAvF,MAAA,CAAevD,UAAU,CAAG,eAAe,CAAG,MAAM,CAAG,CAChEoJ,KAAK,CAAE,CACLC,SAAS,eAAA9F,MAAA,CAAgB,CAACrD,UAAU,OAAK,CACzCoJ,UAAU,CAAE,WACd,CAAE,CAAAP,QAAA,CAEDtE,eAAe,CAAC8E,GAAG,CAAC,CAAC7C,MAAM,CAAE7C,KAAK,gBACjC5F,IAAA,QAAmC6K,SAAS,CAAC,WAAW,CAAAC,QAAA,cACtD9K,IAAA,CAACF,UAAU,EACT2I,MAAM,CAAEA,MAAO,CACf8C,QAAQ,CAAEpJ,MAAM,EAAIA,MAAM,CAAC8D,EAAE,GAAKwC,MAAM,CAACxC,EAAE,EAAI,CAAClE,UAAW,CAC3DyJ,eAAe,CAAEnJ,mBAAmB,EAAIA,mBAAmB,CAAC4D,EAAE,GAAKwC,MAAM,CAACxC,EAAG,CAC9E,CAAC,KAAAX,MAAA,CALSmD,MAAM,CAACxC,EAAE,MAAAX,MAAA,CAAIM,KAAK,CAM1B,CACN,CAAC,CACC,CAAC,CACH,CAAC,CAGL7D,UAAU,eAAI/B,IAAA,QAAK6K,SAAS,CAAC,WAAW,CAAM,CAAC,EAC7C,CAAC,CACH,CAAC,cAGN3K,KAAA,QAAK2K,SAAS,CAAC,aAAa,CAAAC,QAAA,eAC1B5K,KAAA,QAAK2K,SAAS,CAAC,aAAa,CAAAC,QAAA,EAAC,mCAE3B,CAAC,CAAAtJ,aAAa,SAAbA,aAAa,kBAAAZ,sBAAA,CAAbY,aAAa,CAAE+B,KAAK,UAAA3C,sBAAA,iBAApBA,sBAAA,CAAsByC,QAAQ,gBAC7BrD,IAAA,SAAM6K,SAAS,CAAC,iBAAiB,CAAAC,QAAA,CAAC,uCAAsB,CAAM,CAC/D,EACE,CAAC,cACN5K,KAAA,QAAK2K,SAAS,CAAC,YAAY,CAAAC,QAAA,eACzB5K,KAAA,SAAM2K,SAAS,CAAC,eAAe,CAAAC,QAAA,EAAC,eAAG,CAAC5G,YAAY,CAAC,UAAQ,EAAM,CAAC,cAChEhE,KAAA,SAAM2K,SAAS,CAAC,cAAc,CAAAC,QAAA,EAAC,SAAO,CAAC9G,YAAY,EAAO,CAAC,CAC1D5C,WAAW,eACVpB,IAAA,SAAM6K,SAAS,CAAC,mBAAmB,CAAAC,QAAA,CAAC,wBAAY,CAAM,CACvD,EACE,CAAC,EACH,CAAC,CAGLhJ,sBAAsB,EAAIF,cAAc,eACvC5B,IAAA,QAAK6K,SAAS,CAAC,6BAA6B,CAAAC,QAAA,cAC1C5K,KAAA,QAAK2K,SAAS,CAAC,0BAA0B,CAAAC,QAAA,eACvC9K,IAAA,QAAK6K,SAAS,CAAC,aAAa,CAAAC,QAAA,CAAC,cAAE,CAAK,CAAC,cACrC9K,IAAA,OAAA8K,QAAA,CAAI,eAAa,CAAI,CAAC,cACtB5K,KAAA,QAAK2K,SAAS,CAAC,gBAAgB,CAAAC,QAAA,eAC7B9K,IAAA,QAAK6K,SAAS,CAAC,gBAAgB,CAAAC,QAAA,CAAElJ,cAAc,CAACO,MAAM,CAAM,CAAC,cAC7DjC,KAAA,QAAK2K,SAAS,CAAC,cAAc,CAAAC,QAAA,EAAC,MAAI,CAAClJ,cAAc,CAAC6J,KAAK,CAAC,MAAI,EAAK,CAAC,EAC/D,CAAC,cACNzL,IAAA,QAAK6K,SAAS,CAAC,iBAAiB,CAAAC,QAAA,CAAC,wCAAQ,CAAK,CAAC,EAC5C,CAAC,CACH,CACN,CAGAnJ,gBAAgB,eACf3B,IAAA,QAAK6K,SAAS,CAAC,0BAA0B,CAAAC,QAAA,cACvC5K,KAAA,QAAK2K,SAAS,CAAC,0BAA0B,CAAAC,QAAA,eACvC9K,IAAA,QAAK6K,SAAS,CAAC,qBAAqB,CAAAC,QAAA,CAAC,cAAE,CAAK,CAAC,cAC7C9K,IAAA,OAAA8K,QAAA,CAAI,qBAAmB,CAAI,CAAC,cAC5B9K,IAAA,MAAA8K,QAAA,CAAG,uCAAqC,CAAG,CAAC,cAC5C5K,KAAA,QAAK2K,SAAS,CAAC,cAAc,CAAAC,QAAA,eAC3B9K,IAAA,UAAY,CAAC,cACbA,IAAA,UAAY,CAAC,cACbA,IAAA,UAAY,CAAC,EACV,CAAC,EACH,CAAC,CACH,CACN,CAGA6B,iBAAiB,eAChB7B,IAAA,QAAK6K,SAAS,CAAC,0BAA0B,CAAAC,QAAA,cACvC5K,KAAA,QAAK2K,SAAS,CAAC,0BAA0B,CAAAC,QAAA,eACvC9K,IAAA,QAAK6K,SAAS,CAAC,qBAAqB,CAAAC,QAAA,CAAC,cAAE,CAAK,CAAC,cAC7C9K,IAAA,OAAA8K,QAAA,CAAI,wBAAsB,CAAI,CAAC,cAC/B9K,IAAA,MAAA8K,QAAA,CAAG,mCAAiC,CAAG,CAAC,cACxC5K,KAAA,QAAK2K,SAAS,CAAC,cAAc,CAAAC,QAAA,eAC3B9K,IAAA,UAAY,CAAC,cACbA,IAAA,UAAY,CAAC,cACbA,IAAA,UAAY,CAAC,EACV,CAAC,EACH,CAAC,CACH,CACN,CAGAuC,uBAAuB,CAACE,IAAI,eAC3BzC,IAAA,QAAK6K,SAAS,6BAAAvF,MAAA,CAA8B/C,uBAAuB,CAACI,IAAI,CAAG,CAAAmI,QAAA,CACxEvI,uBAAuB,CAACG,OAAO,CAC7B,CACN,EACE,CAAC,CAEV,CAEA,cAAe,CAAAvC,QAAQ","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}