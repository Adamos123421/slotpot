{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\adams\\\\OneDrive\\\\Desktop\\\\Work\\\\slotpot\\\\src\\\\App.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useRef, useCallback, useMemo } from 'react';\nimport { TonConnectUIProvider } from '@tonconnect/ui-react';\nimport Chat from './components/Chat';\nimport GameArea from './components/GameArea';\nimport MobileChat from './components/MobileChat';\nimport WalletConnection from './components/WalletConnection';\nimport WinnerBroadcast from './components/WinnerBroadcast';\nimport useTelegramWebApp from './hooks/useTelegramWebApp';\nimport useJackpotContract from './hooks/useJackpotContract';\nimport socketService from './services/socketService';\nimport winnerCoordinator from './services/winnerCoordinator';\nimport { uiOptions } from './config/tonconnect';\nimport { MessageCircle, Trophy, Users, DollarSign } from 'lucide-react';\nimport './App.css';\nimport './components/Header.css';\n\n// TON Connect manifest URL - use remote manifest to avoid 500 errors\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst manifestUrl = \"https://raw.githubusercontent.com/Vodka2134156/kzsks/main/manifest.json\";\nfunction AppContent() {\n  _s();\n  var _contractState$timer2, _contractState$timer4, _contractState$timer5, _contractState$timer6, _contractState$timer7, _contractState$timer8, _contractState$timer9;\n  // Local UI state\n  const [currentRound, setCurrentRound] = useState(53408);\n  const [timeRemaining, setTimeRemaining] = useState(30);\n  const [activeTab, setActiveTab] = useState('jackpot');\n  const [betAmount, setBetAmount] = useState(0.11);\n  const [showWinnerAnnouncement, setShowWinnerAnnouncement] = useState(false);\n\n  // Winner state management (moved from GameArea.js)\n  const [waitingForWinner, setWaitingForWinner] = useState(false);\n  const [contractWinner, setContractWinner] = useState(null);\n  const [postWinnerLoading, setPostWinnerLoading] = useState(false);\n  const [, setIsAnyWinnerDisplayActive] = useState(false);\n\n  // Bettors state (managed centrally to avoid duplicates)\n  const [gameBettors, setGameBettors] = useState([]);\n  const [previousRoundBettors, setPreviousRoundBettors] = useState([]); // Store bettors for winner matching\n  const [slotSpinning, setSlotSpinning] = useState(false);\n  const carouselRef = useRef(null);\n\n  // Refs to avoid stale closures in socket handlers\n  const gameBettorsRef = useRef([]);\n  const contractWinnerRef = useRef(null);\n  const showWinnerAnnouncementRef = useRef(false);\n  const lastWinnerTimestampRef = useRef(null);\n  const waitingForWinnerRef = useRef(false);\n\n  // Keep refs in sync with state\n  useEffect(() => {\n    gameBettorsRef.current = gameBettors;\n  }, [gameBettors]);\n  useEffect(() => {\n    contractWinnerRef.current = contractWinner;\n  }, [contractWinner]);\n  useEffect(() => {\n    showWinnerAnnouncementRef.current = showWinnerAnnouncement;\n  }, [showWinnerAnnouncement]);\n  useEffect(() => {\n    waitingForWinnerRef.current = waitingForWinner;\n  }, [waitingForWinner]);\n\n  // Centralized winner announcement manager\n  const showWinnerAnnouncements = useCallback((winnerData, source = 'unknown') => {\n    const winnerTimestamp = winnerData.timestamp;\n\n    // Use coordinator to check if should block\n    if (winnerCoordinator.shouldBlock(winnerTimestamp)) {\n      console.log(`üîÑ Winner announcement blocked by coordinator (${source})`);\n      return false;\n    }\n    console.log(`üéâ Showing winner announcements from ${source}:`, winnerData);\n    console.log(`üéâ Setting contractWinner to:`, winnerData);\n\n    // Set coordination flag via coordinator\n    winnerCoordinator.setActive(true, winnerTimestamp);\n    setIsAnyWinnerDisplayActive(true);\n    lastWinnerTimestampRef.current = winnerTimestamp;\n\n    // Show App.js winner notification\n    setContractWinner(winnerData);\n    setShowWinnerAnnouncement(true);\n    setWaitingForWinner(false);\n\n    // Auto-clear announcement but keep winner highlighted until new round\n    setTimeout(() => {\n      setShowWinnerAnnouncement(false);\n      setPostWinnerLoading(false);\n      setIsAnyWinnerDisplayActive(false);\n      winnerCoordinator.setActive(false);\n      // Keep contractWinner for highlighting until new round starts\n    }, 6000);\n    return true;\n  }, []);\n\n  // Telegram integration\n  const {\n    user,\n    hapticFeedback,\n    showAlert,\n    hasRealUserData\n  } = useTelegramWebApp();\n\n  // Smart contract integration\n  const {\n    contractState,\n    userStats,\n    adminInfo: rawAdminInfo,\n    isLoadingContract,\n    isPlacingBet,\n    placeBet,\n    isConnected,\n    address\n  } = useJackpotContract();\n\n  // SAFETY: Ensure adminInfo is always properly structured and never an object that could be rendered\n  const adminInfo = useMemo(() => {\n    var _rawAdminInfo$current;\n    if (!rawAdminInfo || typeof rawAdminInfo !== 'object') {\n      return {\n        isAutoManaged: false,\n        roundDuration: 300,\n        minBetsToEnd: 1,\n        timerActive: false,\n        timeRemaining: 0\n      };\n    }\n\n    // Extract only primitive values to prevent accidental object rendering\n    return {\n      isAutoManaged: Boolean(rawAdminInfo.isAutoManaged),\n      roundDuration: Number(rawAdminInfo.roundDuration) || 300,\n      minBetsToEnd: Number(rawAdminInfo.minBetsToEnd) || 1,\n      timerActive: Boolean(rawAdminInfo.timerActive),\n      timeRemaining: Number(rawAdminInfo.timeRemaining) || 0,\n      // Ensure currentRound is always a number, never an object\n      currentRound: typeof rawAdminInfo.currentRound === 'object' ? ((_rawAdminInfo$current = rawAdminInfo.currentRound) === null || _rawAdminInfo$current === void 0 ? void 0 : _rawAdminInfo$current.roundNumber) || 0 : Number(rawAdminInfo.currentRound) || 0\n    };\n  }, [rawAdminInfo]);\n\n  // SAFETY: Ensure contractState timer properties are never objects that could be accidentally rendered\n  const safeContractState = useMemo(() => {\n    var _contractState$curren;\n    if (!contractState) return contractState;\n    return {\n      ...contractState,\n      // Ensure timer object properties are always primitives\n      timer: contractState.timer ? {\n        isActive: Boolean(contractState.timer.isActive),\n        timeRemaining: Number(contractState.timer.timeRemaining) || 0,\n        timeElapsed: Number(contractState.timer.timeElapsed) || 0,\n        roundNumber: Number(contractState.timer.roundNumber) || 0,\n        timerExpired: Boolean(contractState.timer.timerExpired)\n      } : undefined,\n      // Ensure currentRound is always a number if it exists\n      currentRound: typeof contractState.currentRound === 'object' ? ((_contractState$curren = contractState.currentRound) === null || _contractState$curren === void 0 ? void 0 : _contractState$curren.roundNumber) || 0 : contractState.currentRound\n    };\n  }, [contractState]);\n\n  // Use real contract data or fallback to simulated data\n  const jackpotValue = contractState.totalJackpot;\n  const isLive = contractState.isActive;\n\n  // Calculate user stats from gameBettors data\n  const userBetTotal = useMemo(() => {\n    if (!isConnected || !address || !gameBettors.length) return 0;\n    return gameBettors.filter(bettor => bettor.address === address || bettor.walletAddress === address).reduce((total, bettor) => total + (bettor.amount || 0), 0);\n  }, [gameBettors, address, isConnected]);\n  const userWinChance = useMemo(() => {\n    if (!isConnected || !address || !jackpotValue || userBetTotal === 0) return 0;\n    return userBetTotal / jackpotValue * 100;\n  }, [userBetTotal, jackpotValue, isConnected, address]);\n\n  // Use automation timer or fallback to UI timer\n  useEffect(() => {\n    var _contractState$timer;\n    // Always sync with backend timer when it changes\n    if (((_contractState$timer = contractState.timer) === null || _contractState$timer === void 0 ? void 0 : _contractState$timer.timeRemaining) !== undefined) {\n      setTimeRemaining(contractState.timer.timeRemaining);\n    } else {\n      setTimeRemaining(30);\n    }\n  }, [(_contractState$timer2 = contractState.timer) === null || _contractState$timer2 === void 0 ? void 0 : _contractState$timer2.timeRemaining]);\n\n  // Local countdown timer (runs between backend updates)\n  const shouldRunCountdown = isLive; // Allow countdown to run even when time reaches 0\n\n  useEffect(() => {\n    if (!shouldRunCountdown) return;\n    const countdown = setInterval(() => {\n      setTimeRemaining(prev => {\n        // Continue countdown even at 0 but don't go negative\n        if (prev > 0) {\n          const newTime = prev - 1;\n\n          // When we reach 0, trigger \"analyzing bets\" state locally\n          if (newTime === 0) {\n            console.log('‚è∞ Local timer reached 0, entering analyzing state...');\n            setWaitingForWinner(true); // This will show \"Analyzing Bets...\"\n          }\n          return newTime;\n        }\n\n        // Stay at 0 once we reach it\n        return prev;\n      });\n    }, 1000);\n    return () => clearInterval(countdown);\n  }, [shouldRunCountdown]); // Removed timeRemaining dependency to avoid restart on every second\n\n  // Smooth infinite carousel effect\n  useEffect(() => {\n    const carousel = carouselRef.current;\n    if (!carousel) return;\n\n    // Disable CSS transitions for smooth JS animation\n    carousel.style.transition = 'none';\n    let animationId;\n    let currentPosition = 0;\n    const cardWidth = 110 + 10; // card width + gap\n    const totalCards = Math.max(6, gameBettors.length || 0);\n    const resetPoint = cardWidth * totalCards; // Reset when we've moved one full set\n\n    console.log('üé† Starting carousel animation:', {\n      totalCards,\n      resetPoint\n    });\n    const animate = () => {\n      var _contractState$timer3;\n      // Skip animation during special states (analyzing or winner revealed)\n      if (contractWinner || waitingForWinner || (((_contractState$timer3 = contractState.timer) === null || _contractState$timer3 === void 0 ? void 0 : _contractState$timer3.timeRemaining) || 0) === 0) {\n        // Stop the carousel during these states\n        animationId = requestAnimationFrame(animate);\n        return;\n      }\n      currentPosition += 1; // Slower, smoother movement speed\n\n      // Reset position seamlessly when reaching the end of first set\n      if (currentPosition >= resetPoint) {\n        currentPosition = 0;\n      }\n      carousel.style.transform = `translateX(-${currentPosition}px)`;\n      animationId = requestAnimationFrame(animate);\n    };\n\n    // Start animation\n    animationId = requestAnimationFrame(animate);\n    return () => {\n      if (animationId) {\n        cancelAnimationFrame(animationId);\n      }\n      // Restore CSS transition\n      if (carousel) {\n        carousel.style.transition = '';\n      }\n    };\n  }, [gameBettors.length, contractWinner, waitingForWinner, slotSpinning]);\n\n  // Socket integration for immediate synchronization - SINGLE CONNECTION POINT\n  useEffect(() => {\n    console.log('üîå App.js: Establishing single socket connection for entire app...');\n    socketService.connect();\n\n    // Listen for timer updates from socket\n    socketService.on('timer', timerData => {\n      console.log('‚è∞ App: Socket timer update:', timerData);\n\n      // SAFETY: Ensure timerData exists and has required properties\n      if (!timerData || typeof timerData !== 'object') {\n        console.warn('‚ö†Ô∏è Invalid timer data received in App:', timerData);\n        return;\n      }\n      const newTimeRemaining = typeof timerData.timeRemaining === 'number' ? timerData.timeRemaining : timeRemaining;\n      const newRoundNumber = typeof timerData.roundNumber === 'number' ? timerData.roundNumber : currentRound;\n\n      // Only update timeRemaining if it's significantly different (>2 seconds) or new round\n      setTimeRemaining(prev => {\n        const timeDiff = Math.abs(prev - newTimeRemaining);\n        const isNewRound = newRoundNumber !== currentRound;\n\n        // Sync if: new round, big difference (>10s), or timer reset (server > client)\n        if (isNewRound || timeDiff > 10 || newTimeRemaining > prev) {\n          console.log('‚è∞ Syncing timer:', prev, '‚Üí', newTimeRemaining, isNewRound ? '(new round)' : timeDiff > 10 ? '(>10s difference)' : '(backend ahead)');\n          return newTimeRemaining;\n        }\n\n        // Otherwise keep local countdown running smoothly\n        return prev;\n      });\n      if (newRoundNumber && newRoundNumber !== currentRound) {\n        setCurrentRound(newRoundNumber);\n      }\n      // Note: Contract state timer will be updated via fullGameUpdate/contractStateUpdate events\n    });\n\n    // Listen for new round events\n    socketService.on('newRound', roundData => {\n      console.log('üé∞ App: New round detected via socket:', roundData);\n      setTimeRemaining(roundData.timeRemaining);\n      setCurrentRound(roundData.roundNumber);\n      setIsAnyWinnerDisplayActive(false);\n      winnerCoordinator.reset();\n      lastWinnerTimestampRef.current = null; // Clear duplicate protection for new round\n\n      // Clear winner highlighting for new round\n      setContractWinner(null);\n      setPreviousRoundBettors([]);\n      setWaitingForWinner(false);\n    });\n\n    // Listen for game state updates\n    socketService.on('gameState', gameState => {\n      console.log('üéÆ App: Game state update:', gameState);\n      if (gameState.timeRemaining !== undefined) {\n        setTimeRemaining(gameState.timeRemaining);\n      }\n      if (gameState.currentRound) {\n        // Extract roundNumber if currentRound is an object, otherwise use the value directly\n        const roundNumber = typeof gameState.currentRound === 'object' && gameState.currentRound.roundNumber ? gameState.currentRound.roundNumber : gameState.currentRound;\n        setCurrentRound(roundNumber);\n      }\n\n      // Handle winner-related states\n      if (gameState.isWaitingForWinner !== undefined) {\n        // If transitioning TO waiting for winner, store current bettors\n        if (gameState.isWaitingForWinner && !waitingForWinnerRef.current && gameBettorsRef.current.length > 0) {\n          console.log('üéÆ App: Transitioning to waiting for winner, storing bettors:', gameBettorsRef.current);\n          setPreviousRoundBettors([...gameBettorsRef.current]);\n        }\n        setWaitingForWinner(gameState.isWaitingForWinner);\n      }\n\n      // Update bettors data centrally (avoids duplicate processing)\n      if (gameState.bettors && Array.isArray(gameState.bettors)) {\n        // Only log if bettors count changed to reduce spam\n        if (gameState.bettors.length !== gameBettorsRef.current.length) {\n          console.log('üéÆ App: Updating bettors from gameState:', gameState.bettors.length, 'bettors');\n          // Trigger slot machine animation when new bettor joins\n          setSlotSpinning(true);\n          setTimeout(() => setSlotSpinning(false), 3000);\n        }\n\n        // Store current bettors as previous round bettors when waiting for winner\n        if (gameState.isWaitingForWinner && gameState.bettors.length > 0) {\n          console.log('üéÆ App: Storing bettors for winner matching:', gameState.bettors);\n          setPreviousRoundBettors([...gameState.bettors]);\n        }\n        setGameBettors(gameState.bettors);\n      }\n\n      // Check for winner announcement in game state (prevent duplicates with stronger protection)\n      if (gameState.winnerAnnouncement) {\n        showWinnerAnnouncements(gameState.winnerAnnouncement, 'gameState');\n      }\n    });\n\n    // Listen for comprehensive game data updates\n    socketService.on('fullGameUpdate', gameData => {\n      console.log('üéÆ App: Full game update:', gameData);\n      // These updates will trigger re-renders via useJackpotContract hook\n      // The hook will detect the changes and update accordingly\n    });\n\n    // Listen for bettors updates\n    socketService.on('bettorsUpdate', data => {\n      console.log('üí∞ App: Bettors update:', data);\n      // Trigger slot machine animation on bettor updates\n      setSlotSpinning(true);\n      setTimeout(() => setSlotSpinning(false), 3000);\n      // Force a refresh of contract state to sync with socket data\n      // This ensures jackpot value and user stats stay in sync\n    });\n\n    // Listen for waiting for winner events\n    socketService.on('waitingForWinner', data => {\n      console.log('üéØ App: Waiting for winner state changed:', data);\n\n      // Handle both old boolean format and new object format\n      const isWaiting = typeof data === 'boolean' ? data : data.isWaiting;\n      const message = typeof data === 'object' ? data.message : null;\n      setWaitingForWinner(isWaiting);\n      if (message) {\n        console.log('üéØ App: Winner selection message:', message);\n      }\n    });\n\n    // Listen for winner announcements (primary)\n    socketService.on('winner', winnerData => {\n      console.log('üèÜ App: Winner announced:', winnerData);\n      console.log('üèÜ App: Current gameBettors for comparison:', gameBettors);\n      console.log('üèÜ App: Previous round bettors for comparison:', previousRoundBettors);\n      setWaitingForWinner(false);\n      setPostWinnerLoading(true);\n\n      // Use centralized manager\n      showWinnerAnnouncements(winnerData, 'winner event');\n    });\n\n    // Listen for direct winner announcements (fallback/reliable delivery)\n    socketService.on('winnerAnnouncement', winnerData => {\n      console.log('üéØ App: Direct winner announcement:', winnerData);\n      setWaitingForWinner(false);\n\n      // Use centralized manager\n      showWinnerAnnouncements(winnerData, 'direct announcement');\n    });\n\n    // Listen for round reset events (when timer is reset due to no bettors)\n    socketService.on('roundReset', resetData => {\n      console.log('üîÑ App: Round reset detected:', resetData);\n\n      // Reset timer to the new duration\n      setTimeRemaining(resetData.timeRemaining);\n      setCurrentRound(resetData.roundNumber);\n\n      // Clear any winner states since this is a fresh timer\n      setWaitingForWinner(false);\n      setContractWinner(null);\n      setPostWinnerLoading(false);\n      setIsAnyWinnerDisplayActive(false);\n      winnerCoordinator.reset();\n\n      // Clear bettors list since round was reset\n      setGameBettors([]);\n      setPreviousRoundBettors([]);\n    });\n    return () => {\n      console.log('üîå App.js: Cleaning up socket listeners...');\n      socketService.off('timer');\n      socketService.off('newRound');\n      socketService.off('roundReset');\n      socketService.off('gameState');\n      socketService.off('fullGameUpdate');\n      socketService.off('bettorsUpdate');\n      socketService.off('waitingForWinner');\n      socketService.off('winner');\n      socketService.off('winnerAnnouncement');\n      // Disconnect when app unmounts to prevent memory leaks\n      socketService.disconnect();\n    };\n  }, [currentRound, showWinnerAnnouncements]); // Added missing dependencies\n\n  const handleBetChange = e => {\n    const value = parseFloat(e.target.value) || 0;\n    setBetAmount(Math.max(0, Math.min(value, 10))); // Min 0, Max 10\n  };\n  const handleTabChange = tab => {\n    hapticFeedback('light');\n    setActiveTab(tab);\n  };\n\n  // Enhanced bet placement with real smart contract\n  const handlePlaceBet = async () => {\n    console.log(`üî• BET BUTTON CLICKED - Amount: ${betAmount} TON`);\n    if (betAmount <= 0) {\n      showAlert('Please enter a valid bet amount');\n      return;\n    }\n    if (!isConnected) {\n      showAlert('Please connect your wallet first');\n      return;\n    }\n    if (!contractState.isActive) {\n      showAlert('Jackpot is not currently active\\n\\nü§ñ Automated system will start a new round soon...');\n      return;\n    }\n    try {\n      console.log(`üöÄ Starting bet placement process...`);\n      hapticFeedback('medium');\n\n      // This will call the contract with opcode 0x03\n      const result = await placeBet(betAmount);\n      if (result.success) {\n        hapticFeedback('success');\n        showAlert(`‚úÖ Bet placed successfully!\\n${betAmount} TON in round #${currentRound}\\nTransaction: ${result.txHash.slice(0, 8)}...`);\n        console.log('üéâ Bet placement completed:', result);\n      }\n    } catch (error) {\n      hapticFeedback('error');\n      showAlert(`‚ùå Bet failed: ${error.message}`);\n      console.error('üí• Bet error:', error);\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"app\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"app-container\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"header-section\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"header-top\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"logo-section\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"logo-icon\",\n              children: \"\\uD83C\\uDFB0\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 508,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"app-name\",\n              children: \"SlotPot\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 509,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 507,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"header-icons\",\n            children: /*#__PURE__*/_jsxDEV(WalletConnection, {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 512,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 511,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 506,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"balance-section\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"balance-label\",\n            children: \"Balance\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 516,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"balance-amount\",\n            children: [isConnected ? `${(contractState.userBalance || 0).toFixed(6)}` : '0.000000', /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"balance-symbol\",\n              children: \"TON\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 519,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 517,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 515,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 505,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"main-content\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"jackpot-header\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"jackpot-title\",\n            children: \"\\uD83D\\uDCB0 JACKPOT\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 528,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"jackpot-value-display\",\n            children: jackpotValue.toFixed(3)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 529,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"jackpot-subtitle\",\n            children: \"Winner takes all...\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 530,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 527,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"betting-section\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"bet-input-section\",\n            children: [/*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"number\",\n              className: \"bet-amount-input\",\n              value: betAmount,\n              onChange: handleBetChange,\n              step: \"0.01\",\n              min: \"0.01\",\n              placeholder: \"0\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 536,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              className: \"bet-increment-btn\",\n              onClick: () => setBetAmount(prev => prev + 0.1),\n              children: \"+0.1\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 545,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 535,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"bet-button\",\n            onClick: handlePlaceBet,\n            disabled: isPlacingBet || !isConnected,\n            children: isPlacingBet ? 'Betting...' : 'Bet'\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 549,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 534,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"stats-grid\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"stat-card\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"stat-value\",\n              children: userBetTotal.toFixed(3)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 561,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"stat-label\",\n              children: \"Your Wager\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 562,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 560,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"stat-card chance-stat\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"stat-value\",\n              children: [userWinChance.toFixed(2), \"%\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 565,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"stat-label\",\n              children: \"Your Chance\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 566,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 564,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 559,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"time-section\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"time-label\",\n            children: \"Time Remaining\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 572,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"time-value\",\n            children: [Math.floor((((_contractState$timer4 = contractState.timer) === null || _contractState$timer4 === void 0 ? void 0 : _contractState$timer4.timeRemaining) || 0) / 60), \":\", ((((_contractState$timer5 = contractState.timer) === null || _contractState$timer5 === void 0 ? void 0 : _contractState$timer5.timeRemaining) || 0) % 60).toString().padStart(2, '0')]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 573,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 571,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"players-carousel-section\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: `carousel-header ${(((_contractState$timer6 = contractState.timer) === null || _contractState$timer6 === void 0 ? void 0 : _contractState$timer6.timeRemaining) || 0) === 0 && waitingForWinner ? 'analyzing' : contractWinner ? 'winner' : ''}`,\n            children: /*#__PURE__*/_jsxDEV(\"h3\", {\n              children: (((_contractState$timer7 = contractState.timer) === null || _contractState$timer7 === void 0 ? void 0 : _contractState$timer7.timeRemaining) || 0) === 0 && waitingForWinner ? \"üîç Analyzing Bets...\" : contractWinner ? `üèÜ Winner: ${contractWinner.username || 'Player'}` : `Players (${gameBettors.length > 0 ? gameBettors.length : previousRoundBettors.length})`\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 584,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 580,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"players-carousel\",\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              ref: carouselRef,\n              className: `carousel-track ${(((_contractState$timer8 = contractState.timer) === null || _contractState$timer8 === void 0 ? void 0 : _contractState$timer8.timeRemaining) || 0) === 0 && waitingForWinner ? 'analyzing' : contractWinner ? 'winner-revealed' : slotSpinning ? 'sliding' : ''}`,\n              style: {\n                transition: (((_contractState$timer9 = contractState.timer) === null || _contractState$timer9 === void 0 ? void 0 : _contractState$timer9.timeRemaining) || 0) === 0 && waitingForWinner || contractWinner ? 'none' : ''\n              },\n              children: (() => {\n                // Always use current bettors as primary source\n                let bettorsToShow = gameBettors;\n\n                // For winner matching, check against previous round bettors if needed\n                const bettorsForWinnerMatching = gameBettors.length > 0 ? gameBettors : previousRoundBettors;\n                console.log('üé† Carousel: Using bettors:', bettorsToShow.length, 'from', gameBettors.length > 0 ? 'current' : previousRoundBettors.length > 0 ? 'previous round' : 'mock winner data');\n                console.log('üé† Current gameBettors:', gameBettors);\n                console.log('üé† Previous round bettors:', previousRoundBettors);\n                console.log('üé† Final bettorsToShow:', bettorsToShow);\n\n                // Ensure we have at least 6 items to show (fill with waiting slots if needed)\n                const allItems = [...bettorsToShow, ...Array.from({\n                  length: Math.max(0, 6 - bettorsToShow.length)\n                }, () => null)];\n\n                // Create triple set for smooth infinite scroll: [original] [duplicate1] [duplicate2]\n                const infiniteItems = [...allItems, ...allItems, ...allItems];\n                return infiniteItems.map((bettor, index) => {\n                  const isWinner = contractWinner && bettor && ((_contractWinner$betto, _contractWinner$betto2, _contractWinner$betto3, _contractWinner$betto4) => {\n                    // Normalize addresses for comparison (remove any case sensitivity)\n                    const normalizeAddress = addr => addr ? addr.toLowerCase().trim() : '';\n\n                    // Get all possible identifiers from winner\n                    const winnerIds = [normalizeAddress(contractWinner.address), normalizeAddress(contractWinner.walletAddress), normalizeAddress(contractWinner.winner),\n                    // truncated address\n                    normalizeAddress(contractWinner.fullAddress),\n                    // full address\n                    normalizeAddress((_contractWinner$betto = contractWinner.bettor) === null || _contractWinner$betto === void 0 ? void 0 : _contractWinner$betto.address), normalizeAddress((_contractWinner$betto2 = contractWinner.bettor) === null || _contractWinner$betto2 === void 0 ? void 0 : _contractWinner$betto2.walletAddress), contractWinner.username, (_contractWinner$betto3 = contractWinner.bettor) === null || _contractWinner$betto3 === void 0 ? void 0 : _contractWinner$betto3.username, contractWinner.displayName, (_contractWinner$betto4 = contractWinner.bettor) === null || _contractWinner$betto4 === void 0 ? void 0 : _contractWinner$betto4.displayName].filter(Boolean);\n\n                    // Get all possible identifiers from bettor\n                    const bettorIds = [normalizeAddress(bettor.address), normalizeAddress(bettor.walletAddress), bettor.username, bettor.displayName].filter(Boolean);\n\n                    // Check if any winner ID matches any bettor ID\n                    let isMatch = winnerIds.some(winnerId => bettorIds.includes(winnerId));\n\n                    // Also check for partial address matches (truncated addresses)\n                    if (!isMatch) {\n                      isMatch = winnerIds.some(winnerId => {\n                        if (typeof winnerId === 'string' && winnerId.length > 10) {\n                          return bettorIds.some(bettorId => {\n                            if (typeof bettorId === 'string' && bettorId.length > 10) {\n                              // Check if one is a truncated version of the other\n                              return winnerId.startsWith(bettorId.substring(0, 10)) || bettorId.startsWith(winnerId.substring(0, 10));\n                            }\n                            return false;\n                          });\n                        }\n                        return false;\n                      });\n                    }\n                    console.log('üîç Winner comparison:', {\n                      contractWinner,\n                      bettor,\n                      winnerIds,\n                      bettorIds,\n                      isMatch,\n                      index,\n                      'bettor.address': bettor === null || bettor === void 0 ? void 0 : bettor.address,\n                      'bettor.walletAddress': bettor === null || bettor === void 0 ? void 0 : bettor.walletAddress,\n                      'contractWinner.winner': contractWinner === null || contractWinner === void 0 ? void 0 : contractWinner.winner,\n                      'contractWinner.fullAddress': contractWinner === null || contractWinner === void 0 ? void 0 : contractWinner.fullAddress\n                    });\n                    return isMatch;\n                  })();\n\n                  // Log when we find a winner card\n                  if (isWinner) {\n                    console.log('üèÜ WINNER CARD FOUND!', {\n                      index,\n                      bettor,\n                      isWinner\n                    });\n                  }\n                  return /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: `carousel-card ${isWinner ? 'winner' : bettor ? 'active' : 'waiting'}`,\n                    \"data-debug\": `winner: ${isWinner}, address: ${bettor === null || bettor === void 0 ? void 0 : bettor.address}`,\n                    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                      className: \"mobile-player-avatar\",\n                      children: bettor ? /*#__PURE__*/_jsxDEV(\"div\", {\n                        className: \"generated-avatar\",\n                        children: bettor.username ? bettor.username[0].toUpperCase() : '?'\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 706,\n                        columnNumber: 31\n                      }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n                        className: \"waiting-icon\",\n                        children: \"\\u2753\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 710,\n                        columnNumber: 31\n                      }, this)\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 704,\n                      columnNumber: 27\n                    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                      className: \"mobile-player-info\",\n                      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                        className: \"mobile-player-name\",\n                        children: bettor ? bettor.username || bettor.displayName || 'Player' : 'Waiting'\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 714,\n                        columnNumber: 29\n                      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                        className: \"mobile-player-bet\",\n                        children: bettor ? `${(bettor.amount || 0).toFixed(2)} TON` : '0.00 TON'\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 717,\n                        columnNumber: 29\n                      }, this)]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 713,\n                      columnNumber: 27\n                    }, this), isWinner && /*#__PURE__*/_jsxDEV(\"div\", {\n                      className: \"winner-crown\",\n                      children: \"\\uD83D\\uDC51\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 722,\n                      columnNumber: 29\n                    }, this)]\n                  }, `${index}-${(bettor === null || bettor === void 0 ? void 0 : bettor.address) || 'waiting'}`, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 700,\n                    columnNumber: 25\n                  }, this);\n                });\n              })()\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 594,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 593,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 579,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 525,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"mobile-footer\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"footer-stats\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"footer-stat\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"footer-stat-icon\",\n              children: \"\\uD83C\\uDFE0\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 737,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"footer-stat-value\",\n              children: \"Home\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 738,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 736,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"footer-stat\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"footer-stat-icon\",\n              children: \"\\u26A1\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 741,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"footer-stat-value\",\n              children: \"Fast\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 742,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 740,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"footer-stat\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"footer-stat-icon\",\n              children: \"\\uD83D\\uDD50\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 745,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"footer-stat-value\",\n              children: \"History\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 746,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 744,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"footer-stat\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"footer-stat-icon\",\n              children: \"\\uD83D\\uDD0D\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 749,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"footer-stat-value\",\n              children: \"Search\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 750,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 748,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 735,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"games-button\",\n          children: [/*#__PURE__*/_jsxDEV(DollarSign, {\n            size: 14\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 754,\n            columnNumber: 15\n          }, this), \"Games\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 753,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 734,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 503,\n      columnNumber: 9\n    }, this), isLoadingContract && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"loading-overlay\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"loading-spinner\",\n        children: \"\\uD83D\\uDD04\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 763,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n        children: \"Loading contract data...\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 764,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 762,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(WinnerBroadcast, {\n      socketService: socketService\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 769,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 502,\n    columnNumber: 7\n  }, this);\n}\n\n// Main App component with TON Connect Provider\n_s(AppContent, \"arvOTlbdnN8ql69NB3j1+ZxgnXU=\", false, function () {\n  return [useTelegramWebApp, useJackpotContract];\n});\n_c = AppContent;\nfunction App() {\n  return /*#__PURE__*/_jsxDEV(TonConnectUIProvider, {\n    manifestUrl: manifestUrl,\n    uiPreferences: uiOptions.uiPreferences,\n    language: uiOptions.language,\n    restoreConnection: uiOptions.restoreConnection,\n    actionsConfiguration: uiOptions.actionsConfiguration,\n    children: /*#__PURE__*/_jsxDEV(AppContent, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 784,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 777,\n    columnNumber: 5\n  }, this);\n}\n_c2 = App;\nexport default App;\nvar _c, _c2;\n$RefreshReg$(_c, \"AppContent\");\n$RefreshReg$(_c2, \"App\");","map":{"version":3,"names":["React","useState","useEffect","useRef","useCallback","useMemo","TonConnectUIProvider","Chat","GameArea","MobileChat","WalletConnection","WinnerBroadcast","useTelegramWebApp","useJackpotContract","socketService","winnerCoordinator","uiOptions","MessageCircle","Trophy","Users","DollarSign","jsxDEV","_jsxDEV","manifestUrl","AppContent","_s","_contractState$timer2","_contractState$timer4","_contractState$timer5","_contractState$timer6","_contractState$timer7","_contractState$timer8","_contractState$timer9","currentRound","setCurrentRound","timeRemaining","setTimeRemaining","activeTab","setActiveTab","betAmount","setBetAmount","showWinnerAnnouncement","setShowWinnerAnnouncement","waitingForWinner","setWaitingForWinner","contractWinner","setContractWinner","postWinnerLoading","setPostWinnerLoading","setIsAnyWinnerDisplayActive","gameBettors","setGameBettors","previousRoundBettors","setPreviousRoundBettors","slotSpinning","setSlotSpinning","carouselRef","gameBettorsRef","contractWinnerRef","showWinnerAnnouncementRef","lastWinnerTimestampRef","waitingForWinnerRef","current","showWinnerAnnouncements","winnerData","source","winnerTimestamp","timestamp","shouldBlock","console","log","setActive","setTimeout","user","hapticFeedback","showAlert","hasRealUserData","contractState","userStats","adminInfo","rawAdminInfo","isLoadingContract","isPlacingBet","placeBet","isConnected","address","_rawAdminInfo$current","isAutoManaged","roundDuration","minBetsToEnd","timerActive","Boolean","Number","roundNumber","safeContractState","_contractState$curren","timer","isActive","timeElapsed","timerExpired","undefined","jackpotValue","totalJackpot","isLive","userBetTotal","length","filter","bettor","walletAddress","reduce","total","amount","userWinChance","_contractState$timer","shouldRunCountdown","countdown","setInterval","prev","newTime","clearInterval","carousel","style","transition","animationId","currentPosition","cardWidth","totalCards","Math","max","resetPoint","animate","_contractState$timer3","requestAnimationFrame","transform","cancelAnimationFrame","connect","on","timerData","warn","newTimeRemaining","newRoundNumber","timeDiff","abs","isNewRound","roundData","reset","gameState","isWaitingForWinner","bettors","Array","isArray","winnerAnnouncement","gameData","data","isWaiting","message","resetData","off","disconnect","handleBetChange","e","value","parseFloat","target","min","handleTabChange","tab","handlePlaceBet","result","success","txHash","slice","error","className","children","fileName","_jsxFileName","lineNumber","columnNumber","userBalance","toFixed","type","onChange","step","placeholder","onClick","disabled","floor","toString","padStart","username","ref","bettorsToShow","bettorsForWinnerMatching","allItems","from","infiniteItems","map","index","isWinner","_contractWinner$betto","_contractWinner$betto2","_contractWinner$betto3","_contractWinner$betto4","normalizeAddress","addr","toLowerCase","trim","winnerIds","winner","fullAddress","displayName","bettorIds","isMatch","some","winnerId","includes","bettorId","startsWith","substring","toUpperCase","size","_c","App","uiPreferences","language","restoreConnection","actionsConfiguration","_c2","$RefreshReg$"],"sources":["C:/Users/adams/OneDrive/Desktop/Work/slotpot/src/App.js"],"sourcesContent":["import React, { useState, useEffect, useRef, useCallback, useMemo } from 'react';\nimport { TonConnectUIProvider } from '@tonconnect/ui-react';\nimport Chat from './components/Chat';\nimport GameArea from './components/GameArea';\nimport MobileChat from './components/MobileChat';\nimport WalletConnection from './components/WalletConnection';\nimport WinnerBroadcast from './components/WinnerBroadcast';\nimport useTelegramWebApp from './hooks/useTelegramWebApp';\nimport useJackpotContract from './hooks/useJackpotContract';\nimport socketService from './services/socketService';\nimport winnerCoordinator from './services/winnerCoordinator';\nimport { uiOptions } from './config/tonconnect';\nimport { MessageCircle, Trophy, Users, DollarSign } from 'lucide-react';\nimport './App.css';\nimport './components/Header.css';\n\n// TON Connect manifest URL - use remote manifest to avoid 500 errors\nconst manifestUrl = \"https://raw.githubusercontent.com/Vodka2134156/kzsks/main/manifest.json\";\n\nfunction AppContent() {\n  // Local UI state\n  const [currentRound, setCurrentRound] = useState(53408);\n  const [timeRemaining, setTimeRemaining] = useState(30);\n  const [activeTab, setActiveTab] = useState('jackpot');\n  const [betAmount, setBetAmount] = useState(0.11);\n  const [showWinnerAnnouncement, setShowWinnerAnnouncement] = useState(false);\n  \n  // Winner state management (moved from GameArea.js)\n  const [waitingForWinner, setWaitingForWinner] = useState(false);\n  const [contractWinner, setContractWinner] = useState(null);\n  const [postWinnerLoading, setPostWinnerLoading] = useState(false);\n  const [, setIsAnyWinnerDisplayActive] = useState(false);\n  \n  // Bettors state (managed centrally to avoid duplicates)\n  const [gameBettors, setGameBettors] = useState([]);\n  const [previousRoundBettors, setPreviousRoundBettors] = useState([]); // Store bettors for winner matching\n  const [slotSpinning, setSlotSpinning] = useState(false);\n  const carouselRef = useRef(null);\n\n  // Refs to avoid stale closures in socket handlers\n  const gameBettorsRef = useRef([]);\n  const contractWinnerRef = useRef(null);\n  const showWinnerAnnouncementRef = useRef(false);\n  const lastWinnerTimestampRef = useRef(null);\n  const waitingForWinnerRef = useRef(false);\n  \n  // Keep refs in sync with state\n  useEffect(() => { gameBettorsRef.current = gameBettors; }, [gameBettors]);\n  useEffect(() => { contractWinnerRef.current = contractWinner; }, [contractWinner]);\n  useEffect(() => { showWinnerAnnouncementRef.current = showWinnerAnnouncement; }, [showWinnerAnnouncement]);\n  useEffect(() => { waitingForWinnerRef.current = waitingForWinner; }, [waitingForWinner]);\n\n  // Centralized winner announcement manager\n  const showWinnerAnnouncements = useCallback((winnerData, source = 'unknown') => {\n    const winnerTimestamp = winnerData.timestamp;\n    \n    // Use coordinator to check if should block\n    if (winnerCoordinator.shouldBlock(winnerTimestamp)) {\n      console.log(`üîÑ Winner announcement blocked by coordinator (${source})`);\n      return false;\n    }\n    \n    console.log(`üéâ Showing winner announcements from ${source}:`, winnerData);\n    console.log(`üéâ Setting contractWinner to:`, winnerData);\n    \n    // Set coordination flag via coordinator\n    winnerCoordinator.setActive(true, winnerTimestamp);\n    setIsAnyWinnerDisplayActive(true);\n    lastWinnerTimestampRef.current = winnerTimestamp;\n    \n    // Show App.js winner notification\n    setContractWinner(winnerData);\n    setShowWinnerAnnouncement(true);\n    setWaitingForWinner(false);\n    \n    // Auto-clear announcement but keep winner highlighted until new round\n    setTimeout(() => {\n      setShowWinnerAnnouncement(false);\n      setPostWinnerLoading(false);\n      setIsAnyWinnerDisplayActive(false);\n      winnerCoordinator.setActive(false);\n      // Keep contractWinner for highlighting until new round starts\n    }, 6000);\n    \n    return true;\n  }, []);\n\n  // Telegram integration\n  const { user, hapticFeedback, showAlert, hasRealUserData } = useTelegramWebApp();\n\n  // Smart contract integration\n  const {\n    contractState,\n    userStats,\n    adminInfo: rawAdminInfo,\n    isLoadingContract,\n    isPlacingBet,\n    placeBet,\n    isConnected,\n    address,\n  } = useJackpotContract();\n\n  // SAFETY: Ensure adminInfo is always properly structured and never an object that could be rendered\n  const adminInfo = useMemo(() => {\n    if (!rawAdminInfo || typeof rawAdminInfo !== 'object') {\n      return {\n        isAutoManaged: false,\n        roundDuration: 300,\n        minBetsToEnd: 1,\n        timerActive: false,\n        timeRemaining: 0\n      };\n    }\n    \n    // Extract only primitive values to prevent accidental object rendering\n    return {\n      isAutoManaged: Boolean(rawAdminInfo.isAutoManaged),\n      roundDuration: Number(rawAdminInfo.roundDuration) || 300,\n      minBetsToEnd: Number(rawAdminInfo.minBetsToEnd) || 1,\n      timerActive: Boolean(rawAdminInfo.timerActive),\n      timeRemaining: Number(rawAdminInfo.timeRemaining) || 0,\n      // Ensure currentRound is always a number, never an object\n      currentRound: typeof rawAdminInfo.currentRound === 'object' \n        ? (rawAdminInfo.currentRound?.roundNumber || 0)\n        : (Number(rawAdminInfo.currentRound) || 0)\n    };\n  }, [rawAdminInfo]);\n\n  // SAFETY: Ensure contractState timer properties are never objects that could be accidentally rendered\n  const safeContractState = useMemo(() => {\n    if (!contractState) return contractState;\n    \n    return {\n      ...contractState,\n      // Ensure timer object properties are always primitives\n      timer: contractState.timer ? {\n        isActive: Boolean(contractState.timer.isActive),\n        timeRemaining: Number(contractState.timer.timeRemaining) || 0,\n        timeElapsed: Number(contractState.timer.timeElapsed) || 0,\n        roundNumber: Number(contractState.timer.roundNumber) || 0,\n        timerExpired: Boolean(contractState.timer.timerExpired)\n      } : undefined,\n      // Ensure currentRound is always a number if it exists\n      currentRound: typeof contractState.currentRound === 'object' \n        ? (contractState.currentRound?.roundNumber || 0)\n        : contractState.currentRound\n    };\n  }, [contractState]);\n\n  // Use real contract data or fallback to simulated data\n  const jackpotValue = contractState.totalJackpot;\n  const isLive = contractState.isActive;\n  \n  // Calculate user stats from gameBettors data\n  const userBetTotal = useMemo(() => {\n    if (!isConnected || !address || !gameBettors.length) return 0;\n    \n    return gameBettors\n      .filter(bettor => \n        bettor.address === address || \n        bettor.walletAddress === address\n      )\n      .reduce((total, bettor) => total + (bettor.amount || 0), 0);\n  }, [gameBettors, address, isConnected]);\n  \n  const userWinChance = useMemo(() => {\n    if (!isConnected || !address || !jackpotValue || userBetTotal === 0) return 0;\n    \n    return (userBetTotal / jackpotValue) * 100;\n  }, [userBetTotal, jackpotValue, isConnected, address]);\n\n  // Use automation timer or fallback to UI timer\n  useEffect(() => {\n    // Always sync with backend timer when it changes\n    if (contractState.timer?.timeRemaining !== undefined) {\n      setTimeRemaining(contractState.timer.timeRemaining);\n    } else {\n      setTimeRemaining(30);\n    }\n  }, [contractState.timer?.timeRemaining]);\n\n  // Local countdown timer (runs between backend updates)\n  const shouldRunCountdown = isLive; // Allow countdown to run even when time reaches 0\n  \n  useEffect(() => {\n    if (!shouldRunCountdown) return;\n\n    const countdown = setInterval(() => {\n      setTimeRemaining(prev => {\n        // Continue countdown even at 0 but don't go negative\n        if (prev > 0) {\n          const newTime = prev - 1;\n          \n          // When we reach 0, trigger \"analyzing bets\" state locally\n          if (newTime === 0) {\n            console.log('‚è∞ Local timer reached 0, entering analyzing state...');\n            setWaitingForWinner(true); // This will show \"Analyzing Bets...\"\n          }\n          \n          return newTime;\n        }\n        \n        // Stay at 0 once we reach it\n        return prev;\n      });\n    }, 1000);\n\n    return () => clearInterval(countdown);\n  }, [shouldRunCountdown]); // Removed timeRemaining dependency to avoid restart on every second\n\n  // Smooth infinite carousel effect\n  useEffect(() => {\n    const carousel = carouselRef.current;\n    if (!carousel) return;\n\n    // Disable CSS transitions for smooth JS animation\n    carousel.style.transition = 'none';\n\n    let animationId;\n    let currentPosition = 0;\n    const cardWidth = 110 + 10; // card width + gap\n    const totalCards = Math.max(6, gameBettors.length || 0);\n    const resetPoint = cardWidth * totalCards; // Reset when we've moved one full set\n    \n    console.log('üé† Starting carousel animation:', { totalCards, resetPoint });\n\n    const animate = () => {\n      // Skip animation during special states (analyzing or winner revealed)\n      if (contractWinner || waitingForWinner || (contractState.timer?.timeRemaining || 0) === 0) {\n        // Stop the carousel during these states\n        animationId = requestAnimationFrame(animate);\n        return;\n      }\n\n      currentPosition += 1; // Slower, smoother movement speed\n      \n      // Reset position seamlessly when reaching the end of first set\n      if (currentPosition >= resetPoint) {\n        currentPosition = 0;\n      }\n      \n      carousel.style.transform = `translateX(-${currentPosition}px)`;\n      animationId = requestAnimationFrame(animate);\n    };\n\n    // Start animation\n    animationId = requestAnimationFrame(animate);\n\n    return () => {\n      if (animationId) {\n        cancelAnimationFrame(animationId);\n      }\n      // Restore CSS transition\n      if (carousel) {\n        carousel.style.transition = '';\n      }\n    };\n  }, [gameBettors.length, contractWinner, waitingForWinner, slotSpinning]);\n\n  // Socket integration for immediate synchronization - SINGLE CONNECTION POINT\n  useEffect(() => {\n    console.log('üîå App.js: Establishing single socket connection for entire app...');\n    socketService.connect();\n\n    // Listen for timer updates from socket\n    socketService.on('timer', (timerData) => {\n      console.log('‚è∞ App: Socket timer update:', timerData);\n      \n      // SAFETY: Ensure timerData exists and has required properties\n      if (!timerData || typeof timerData !== 'object') {\n        console.warn('‚ö†Ô∏è Invalid timer data received in App:', timerData);\n        return;\n      }\n      \n      const newTimeRemaining = typeof timerData.timeRemaining === 'number' ? timerData.timeRemaining : timeRemaining;\n      const newRoundNumber = typeof timerData.roundNumber === 'number' ? timerData.roundNumber : currentRound;\n      \n      // Only update timeRemaining if it's significantly different (>2 seconds) or new round\n      setTimeRemaining(prev => {\n        const timeDiff = Math.abs(prev - newTimeRemaining);\n        const isNewRound = newRoundNumber !== currentRound;\n        \n        // Sync if: new round, big difference (>10s), or timer reset (server > client)\n        if (isNewRound || timeDiff > 10 || newTimeRemaining > prev) {\n          console.log('‚è∞ Syncing timer:', prev, '‚Üí', newTimeRemaining, isNewRound ? '(new round)' : timeDiff > 10 ? '(>10s difference)' : '(backend ahead)');\n          return newTimeRemaining;\n        }\n        \n        // Otherwise keep local countdown running smoothly\n        return prev;\n      });\n      \n      if (newRoundNumber && newRoundNumber !== currentRound) {\n        setCurrentRound(newRoundNumber);\n      }\n      // Note: Contract state timer will be updated via fullGameUpdate/contractStateUpdate events\n    });\n\n    // Listen for new round events\n    socketService.on('newRound', (roundData) => {\n      console.log('üé∞ App: New round detected via socket:', roundData);\n      setTimeRemaining(roundData.timeRemaining);\n      setCurrentRound(roundData.roundNumber);\n      setIsAnyWinnerDisplayActive(false);\n      winnerCoordinator.reset();\n      lastWinnerTimestampRef.current = null; // Clear duplicate protection for new round\n      \n      // Clear winner highlighting for new round\n      setContractWinner(null);\n      setPreviousRoundBettors([]);\n      setWaitingForWinner(false);\n    });\n\n    // Listen for game state updates\n    socketService.on('gameState', (gameState) => {\n      console.log('üéÆ App: Game state update:', gameState);\n      if (gameState.timeRemaining !== undefined) {\n        setTimeRemaining(gameState.timeRemaining);\n      }\n      if (gameState.currentRound) {\n        // Extract roundNumber if currentRound is an object, otherwise use the value directly\n        const roundNumber = typeof gameState.currentRound === 'object' && gameState.currentRound.roundNumber \n          ? gameState.currentRound.roundNumber \n          : gameState.currentRound;\n        setCurrentRound(roundNumber);\n      }\n      \n      // Handle winner-related states\n      if (gameState.isWaitingForWinner !== undefined) {\n        // If transitioning TO waiting for winner, store current bettors\n        if (gameState.isWaitingForWinner && !waitingForWinnerRef.current && gameBettorsRef.current.length > 0) {\n          console.log('üéÆ App: Transitioning to waiting for winner, storing bettors:', gameBettorsRef.current);\n          setPreviousRoundBettors([...gameBettorsRef.current]);\n        }\n        \n        setWaitingForWinner(gameState.isWaitingForWinner);\n      }\n      \n      // Update bettors data centrally (avoids duplicate processing)\n      if (gameState.bettors && Array.isArray(gameState.bettors)) {\n        // Only log if bettors count changed to reduce spam\n        if (gameState.bettors.length !== gameBettorsRef.current.length) {\n          console.log('üéÆ App: Updating bettors from gameState:', gameState.bettors.length, 'bettors');\n          // Trigger slot machine animation when new bettor joins\n          setSlotSpinning(true);\n          setTimeout(() => setSlotSpinning(false), 3000);\n        }\n        \n        // Store current bettors as previous round bettors when waiting for winner\n        if (gameState.isWaitingForWinner && gameState.bettors.length > 0) {\n          console.log('üéÆ App: Storing bettors for winner matching:', gameState.bettors);\n          setPreviousRoundBettors([...gameState.bettors]);\n        }\n        \n        setGameBettors(gameState.bettors);\n      }\n      \n      // Check for winner announcement in game state (prevent duplicates with stronger protection)\n      if (gameState.winnerAnnouncement) {\n        showWinnerAnnouncements(gameState.winnerAnnouncement, 'gameState');\n      }\n    });\n\n    // Listen for comprehensive game data updates\n    socketService.on('fullGameUpdate', (gameData) => {\n      console.log('üéÆ App: Full game update:', gameData);\n      // These updates will trigger re-renders via useJackpotContract hook\n      // The hook will detect the changes and update accordingly\n    });\n\n    // Listen for bettors updates\n    socketService.on('bettorsUpdate', (data) => {\n      console.log('üí∞ App: Bettors update:', data);\n      // Trigger slot machine animation on bettor updates\n      setSlotSpinning(true);\n      setTimeout(() => setSlotSpinning(false), 3000);\n      // Force a refresh of contract state to sync with socket data\n      // This ensures jackpot value and user stats stay in sync\n    });\n\n    // Listen for waiting for winner events\n    socketService.on('waitingForWinner', (data) => {\n      console.log('üéØ App: Waiting for winner state changed:', data);\n      \n      // Handle both old boolean format and new object format\n      const isWaiting = typeof data === 'boolean' ? data : data.isWaiting;\n      const message = typeof data === 'object' ? data.message : null;\n      \n      setWaitingForWinner(isWaiting);\n      \n      if (message) {\n        console.log('üéØ App: Winner selection message:', message);\n      }\n    });\n\n    // Listen for winner announcements (primary)\n    socketService.on('winner', (winnerData) => {\n      console.log('üèÜ App: Winner announced:', winnerData);\n      console.log('üèÜ App: Current gameBettors for comparison:', gameBettors);\n      console.log('üèÜ App: Previous round bettors for comparison:', previousRoundBettors);\n      setWaitingForWinner(false);\n      setPostWinnerLoading(true);\n      \n      // Use centralized manager\n      showWinnerAnnouncements(winnerData, 'winner event');\n    });\n\n    // Listen for direct winner announcements (fallback/reliable delivery)\n    socketService.on('winnerAnnouncement', (winnerData) => {\n      console.log('üéØ App: Direct winner announcement:', winnerData);\n      setWaitingForWinner(false);\n      \n      // Use centralized manager\n      showWinnerAnnouncements(winnerData, 'direct announcement');\n    });\n\n    // Listen for round reset events (when timer is reset due to no bettors)\n    socketService.on('roundReset', (resetData) => {\n      console.log('üîÑ App: Round reset detected:', resetData);\n      \n      // Reset timer to the new duration\n      setTimeRemaining(resetData.timeRemaining);\n      setCurrentRound(resetData.roundNumber);\n      \n      // Clear any winner states since this is a fresh timer\n      setWaitingForWinner(false);\n      setContractWinner(null);\n      setPostWinnerLoading(false);\n      setIsAnyWinnerDisplayActive(false);\n      winnerCoordinator.reset();\n      \n      // Clear bettors list since round was reset\n      setGameBettors([]);\n      setPreviousRoundBettors([]);\n    });\n\n    return () => {\n      console.log('üîå App.js: Cleaning up socket listeners...');\n      socketService.off('timer');\n      socketService.off('newRound');\n      socketService.off('roundReset');\n      socketService.off('gameState');\n      socketService.off('fullGameUpdate');\n      socketService.off('bettorsUpdate');\n      socketService.off('waitingForWinner');\n      socketService.off('winner');\n      socketService.off('winnerAnnouncement');\n      // Disconnect when app unmounts to prevent memory leaks\n      socketService.disconnect();\n    };\n  }, [currentRound, showWinnerAnnouncements]); // Added missing dependencies\n\n  const handleBetChange = (e) => {\n    const value = parseFloat(e.target.value) || 0;\n    setBetAmount(Math.max(0, Math.min(value, 10))); // Min 0, Max 10\n  };\n\n  const handleTabChange = (tab) => {\n    hapticFeedback('light');\n    setActiveTab(tab);\n  };\n\n  // Enhanced bet placement with real smart contract\n  const handlePlaceBet = async () => {\n    console.log(`üî• BET BUTTON CLICKED - Amount: ${betAmount} TON`);\n    \n    if (betAmount <= 0) {\n      showAlert('Please enter a valid bet amount');\n      return;\n    }\n\n    if (!isConnected) {\n      showAlert('Please connect your wallet first');\n      return;\n    }\n\n    if (!contractState.isActive) {\n      showAlert('Jackpot is not currently active\\n\\nü§ñ Automated system will start a new round soon...');\n      return;\n    }\n\n    try {\n      console.log(`üöÄ Starting bet placement process...`);\n      hapticFeedback('medium');\n      \n      // This will call the contract with opcode 0x03\n      const result = await placeBet(betAmount);\n      \n      if (result.success) {\n        hapticFeedback('success');\n        showAlert(`‚úÖ Bet placed successfully!\\n${betAmount} TON in round #${currentRound}\\nTransaction: ${result.txHash.slice(0, 8)}...`);\n        console.log('üéâ Bet placement completed:', result);\n      }\n    } catch (error) {\n      hapticFeedback('error');\n      showAlert(`‚ùå Bet failed: ${error.message}`);\n      console.error('üí• Bet error:', error);\n    }\n  };\n\n      return (\n      <div className=\"app\">\n        <div className=\"app-container\">\n          {/* Header Section */}\n          <div className=\"header-section\">\n            <div className=\"header-top\">\n              <div className=\"logo-section\">\n                <div className=\"logo-icon\">üé∞</div>\n                <div className=\"app-name\">SlotPot</div>\n              </div>\n              <div className=\"header-icons\">\n                <WalletConnection />\n              </div>\n            </div>\n            <div className=\"balance-section\">\n              <div className=\"balance-label\">Balance</div>\n              <div className=\"balance-amount\">\n                {isConnected ? `${(contractState.userBalance || 0).toFixed(6)}` : '0.000000'}\n                <span className=\"balance-symbol\">TON</span>\n              </div>\n            </div>\n          </div>\n\n          {/* Main Content */}\n          <div className=\"main-content\">\n            {/* Jackpot Display */}\n            <div className=\"jackpot-header\">\n              <div className=\"jackpot-title\">üí∞ JACKPOT</div>\n              <div className=\"jackpot-value-display\">{jackpotValue.toFixed(3)}</div>\n              <div className=\"jackpot-subtitle\">Winner takes all...</div>\n            </div>\n\n            {/* Betting Section */}\n            <div className=\"betting-section\">\n              <div className=\"bet-input-section\">\n                <input \n                  type=\"number\" \n                  className=\"bet-amount-input\" \n                  value={betAmount}\n                  onChange={handleBetChange}\n                  step=\"0.01\"\n                  min=\"0.01\"\n                  placeholder=\"0\"\n                />\n                <button className=\"bet-increment-btn\" onClick={() => setBetAmount(prev => prev + 0.1)}>\n                  +0.1\n                </button>\n              </div>\n              <button \n                className=\"bet-button\" \n                onClick={handlePlaceBet}\n                disabled={isPlacingBet || !isConnected}\n              >\n                {isPlacingBet ? 'Betting...' : 'Bet'}\n              </button>\n            </div>\n\n            {/* Stats Grid */}\n            <div className=\"stats-grid\">\n              <div className=\"stat-card\">\n                <div className=\"stat-value\">{userBetTotal.toFixed(3)}</div>\n                <div className=\"stat-label\">Your Wager</div>\n              </div>\n              <div className=\"stat-card chance-stat\">\n                <div className=\"stat-value\">{userWinChance.toFixed(2)}%</div>\n                <div className=\"stat-label\">Your Chance</div>\n              </div>\n            </div>\n\n            {/* Time Section */}\n            <div className=\"time-section\">\n              <div className=\"time-label\">Time Remaining</div>\n              <div className=\"time-value\">\n                {Math.floor((contractState.timer?.timeRemaining || 0) / 60)}:{((contractState.timer?.timeRemaining || 0) % 60).toString().padStart(2, '0')}\n              </div>\n            </div>\n\n            {/* Players Carousel Section */}\n            <div className=\"players-carousel-section\">\n              <div className={`carousel-header ${\n                (contractState.timer?.timeRemaining || 0) === 0 && waitingForWinner ? 'analyzing' : \n                contractWinner ? 'winner' : ''\n              }`}>\n                <h3>\n                  {(contractState.timer?.timeRemaining || 0) === 0 && waitingForWinner ? \n                    \"üîç Analyzing Bets...\" : \n                    contractWinner ? \n                    `üèÜ Winner: ${contractWinner.username || 'Player'}` :\n                    `Players (${gameBettors.length > 0 ? gameBettors.length : previousRoundBettors.length})`\n                  }\n                </h3>\n              </div>\n              <div className=\"players-carousel\">\n                <div \n                  ref={carouselRef}\n                  className={`carousel-track ${\n                    (contractState.timer?.timeRemaining || 0) === 0 && waitingForWinner ? 'analyzing' : \n                    contractWinner ? 'winner-revealed' : \n                    slotSpinning ? 'sliding' : ''\n                  }`}\n                  style={{\n                    transition: ((contractState.timer?.timeRemaining || 0) === 0 && waitingForWinner) || contractWinner ? 'none' : ''\n                  }}\n                >\n                  {/* Create infinite loop: duplicate all cards twice for seamless scrolling */}\n                  {(() => {\n                    // Always use current bettors as primary source\n                    let bettorsToShow = gameBettors;\n                    \n                    // For winner matching, check against previous round bettors if needed\n                    const bettorsForWinnerMatching = gameBettors.length > 0 ? gameBettors : previousRoundBettors;\n                    \n                    console.log('üé† Carousel: Using bettors:', bettorsToShow.length, 'from', \n                      gameBettors.length > 0 ? 'current' : \n                      previousRoundBettors.length > 0 ? 'previous round' : 'mock winner data');\n                    console.log('üé† Current gameBettors:', gameBettors);\n                    console.log('üé† Previous round bettors:', previousRoundBettors);\n                    console.log('üé† Final bettorsToShow:', bettorsToShow);\n                    \n                    // Ensure we have at least 6 items to show (fill with waiting slots if needed)\n                    const allItems = [\n                      ...bettorsToShow,\n                      ...Array.from({ length: Math.max(0, 6 - bettorsToShow.length) }, () => null)\n                    ];\n                    \n                    // Create triple set for smooth infinite scroll: [original] [duplicate1] [duplicate2]\n                    const infiniteItems = [...allItems, ...allItems, ...allItems];\n                    \n                    return infiniteItems.map((bettor, index) => {\n                                          const isWinner = contractWinner && bettor && (() => {\n                      // Normalize addresses for comparison (remove any case sensitivity)\n                      const normalizeAddress = (addr) => addr ? addr.toLowerCase().trim() : '';\n                      \n                      // Get all possible identifiers from winner\n                      const winnerIds = [\n                        normalizeAddress(contractWinner.address),\n                        normalizeAddress(contractWinner.walletAddress),\n                        normalizeAddress(contractWinner.winner), // truncated address\n                        normalizeAddress(contractWinner.fullAddress), // full address\n                        normalizeAddress(contractWinner.bettor?.address),\n                        normalizeAddress(contractWinner.bettor?.walletAddress),\n                        contractWinner.username,\n                        contractWinner.bettor?.username,\n                        contractWinner.displayName,\n                        contractWinner.bettor?.displayName\n                      ].filter(Boolean);\n                      \n                      // Get all possible identifiers from bettor\n                      const bettorIds = [\n                        normalizeAddress(bettor.address),\n                        normalizeAddress(bettor.walletAddress),\n                        bettor.username,\n                        bettor.displayName\n                      ].filter(Boolean);\n                      \n                      // Check if any winner ID matches any bettor ID\n                      let isMatch = winnerIds.some(winnerId => \n                        bettorIds.includes(winnerId)\n                      );\n                      \n                      // Also check for partial address matches (truncated addresses)\n                      if (!isMatch) {\n                        isMatch = winnerIds.some(winnerId => {\n                          if (typeof winnerId === 'string' && winnerId.length > 10) {\n                            return bettorIds.some(bettorId => {\n                              if (typeof bettorId === 'string' && bettorId.length > 10) {\n                                // Check if one is a truncated version of the other\n                                return winnerId.startsWith(bettorId.substring(0, 10)) || \n                                       bettorId.startsWith(winnerId.substring(0, 10));\n                              }\n                              return false;\n                            });\n                          }\n                          return false;\n                        });\n                      }\n                      \n                      console.log('üîç Winner comparison:', {\n                        contractWinner,\n                        bettor,\n                        winnerIds,\n                        bettorIds,\n                        isMatch,\n                        index,\n                        'bettor.address': bettor?.address,\n                        'bettor.walletAddress': bettor?.walletAddress,\n                        'contractWinner.winner': contractWinner?.winner,\n                        'contractWinner.fullAddress': contractWinner?.fullAddress\n                      });\n                      \n                      return isMatch;\n                    })();\n                    \n                    // Log when we find a winner card\n                    if (isWinner) {\n                      console.log('üèÜ WINNER CARD FOUND!', { index, bettor, isWinner });\n                    }\n                      \n                      return (\n                        <div key={`${index}-${bettor?.address || 'waiting'}`} className={`carousel-card ${\n                          isWinner ? 'winner' : \n                          bettor ? 'active' : 'waiting'\n                        }`} data-debug={`winner: ${isWinner}, address: ${bettor?.address}`}>\n                          <div className=\"mobile-player-avatar\">\n                            {bettor ? (\n                              <div className=\"generated-avatar\">\n                                {bettor.username ? bettor.username[0].toUpperCase() : '?'}\n                              </div>\n                            ) : (\n                              <div className=\"waiting-icon\">‚ùì</div>\n                            )}\n                          </div>\n                          <div className=\"mobile-player-info\">\n                            <div className=\"mobile-player-name\">\n                              {bettor ? (bettor.username || bettor.displayName || 'Player') : 'Waiting'}\n                            </div>\n                            <div className=\"mobile-player-bet\">\n                              {bettor ? `${(bettor.amount || 0).toFixed(2)} TON` : '0.00 TON'}\n                            </div>\n                          </div>\n                          {isWinner && (\n                            <div className=\"winner-crown\">üëë</div>\n                          )}\n                        </div>\n                      );\n                    });\n                  })()}\n                </div>\n              </div>\n            </div>\n          </div>\n\n          {/* Mobile Footer */}\n          <div className=\"mobile-footer\">\n            <div className=\"footer-stats\">\n              <div className=\"footer-stat\">\n                <div className=\"footer-stat-icon\">üè†</div>\n                <div className=\"footer-stat-value\">Home</div>\n              </div>\n              <div className=\"footer-stat\">\n                <div className=\"footer-stat-icon\">‚ö°</div>\n                <div className=\"footer-stat-value\">Fast</div>\n              </div>\n              <div className=\"footer-stat\">\n                <div className=\"footer-stat-icon\">üïê</div>\n                <div className=\"footer-stat-value\">History</div>\n              </div>\n              <div className=\"footer-stat\">\n                <div className=\"footer-stat-icon\">üîç</div>\n                <div className=\"footer-stat-value\">Search</div>\n              </div>\n            </div>\n            <button className=\"games-button\">\n              <DollarSign size={14} />\n              Games\n            </button>\n          </div>\n        </div>\n\n      {/* Contract Status Indicator */}\n      {isLoadingContract && (\n        <div className=\"loading-overlay\">\n          <div className=\"loading-spinner\">üîÑ</div>\n          <span>Loading contract data...</span>\n        </div>\n      )}\n\n      {/* Winner Broadcast Component */}\n      <WinnerBroadcast socketService={socketService} />\n    </div>\n  );\n}\n\n// Main App component with TON Connect Provider\nfunction App() {\n  return (\n    <TonConnectUIProvider \n      manifestUrl={manifestUrl}\n      uiPreferences={uiOptions.uiPreferences}\n      language={uiOptions.language}\n      restoreConnection={uiOptions.restoreConnection}\n      actionsConfiguration={uiOptions.actionsConfiguration}\n    >\n      <AppContent />\n    </TonConnectUIProvider>\n  );\n}\n\nexport default App; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}