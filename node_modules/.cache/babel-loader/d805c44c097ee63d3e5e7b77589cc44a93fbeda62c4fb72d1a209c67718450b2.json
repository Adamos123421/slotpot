{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\adams\\\\OneDrive\\\\Desktop\\\\Work\\\\slotpot\\\\src\\\\App.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useRef, useCallback, useMemo, memo } from 'react';\nimport { TonConnectUIProvider } from '@tonconnect/ui-react';\nimport GameArea from './components/GameArea';\nimport WalletConnection from './components/WalletConnection';\nimport PlayerProfile from './components/PlayerProfile';\nimport WinnerBroadcast from './components/WinnerBroadcast';\nimport Header from './components/Header';\nimport RecentWinners from './components/RecentWinners';\nimport SimpleCarousel from './components/SimpleCarousel';\nimport ReferralSystem from './components/ReferralSystem';\nimport UsernameInput from './components/UsernameInput';\nimport OnlineIndicator from './components/OnlineIndicator';\nimport ChatBubble from './components/ChatBubble';\nimport { TonIcon } from './components/IconComponents';\nimport useTelegramWebApp from './hooks/useTelegramWebApp';\nimport useJackpotContract from './hooks/useJackpotContract';\nimport useReferralAutoRegistration from './hooks/useReferralAutoRegistration';\nimport { DollarSign, User, Loader2, Trophy, Share2, Users, Target, Coins } from 'lucide-react';\nimport socketService from './services/socketService';\nimport winnerCoordinator from './services/winnerCoordinator';\nimport { uiOptions } from './config/tonconnect';\nimport './App.css';\nimport './components/Header.css';\n\n// TON Connect manifest URL - use remote manifest to avoid 500 errors\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst manifestUrl = \"https://raw.githubusercontent.com/Vodka2134156/kzsks/main/manifest.json\";\nfunction AppContent() {\n  _s();\n  var _contractState$timer5, _contractState$timer6, _contractState$timer7, _contractWinner$winne;\n  // Global referral auto-registration\n  useReferralAutoRegistration();\n\n  // Local UI state\n  const [currentRound, setCurrentRound] = useState(53408);\n  const [timeRemaining, setTimeRemaining] = useState(30);\n  const [activeTab, setActiveTab] = useState('jackpot');\n  const [betAmount, setBetAmount] = useState(0.1);\n  const [showWinnerAnnouncement, setShowWinnerAnnouncement] = useState(false);\n\n  // Winner state management (moved from GameArea.js)\n  const [waitingForWinner, setWaitingForWinner] = useState(false);\n  const [contractWinner, setContractWinner] = useState(null);\n  const [postWinnerLoading, setPostWinnerLoading] = useState(false);\n  const [, setIsAnyWinnerDisplayActive] = useState(false);\n  const [showWinnerVisually, setShowWinnerVisually] = useState(false); // Controls when winner card appears\n  const [isInWinnerState, setIsInWinnerState] = useState(false); // Blocks new winner broadcasts\n\n  // Username management\n  const [showUsernameInput, setShowUsernameInput] = useState(false);\n  const [currentUsername, setCurrentUsername] = useState('');\n\n  // Bet loading state - tracks when user places bet until wager changes\n  const [betLoadingState, setBetLoadingState] = useState({\n    isWaitingForWagerChange: false,\n    lastWagerAmount: 0,\n    lastBalance: 0\n  });\n\n  // Bettors state (managed centrally to avoid duplicates)\n  const [gameBettors, setGameBettors] = useState([]);\n  const [previousRoundBettors, setPreviousRoundBettors] = useState([]); // Store bettors for winner matching\n  const [slotSpinning, setSlotSpinning] = useState(false);\n  // Note: carouselRef removed - now using Swiper component\n\n  // Refs to avoid stale closures in socket handlers\n  const gameBettorsRef = useRef([]);\n  const contractWinnerRef = useRef(null);\n  const showWinnerAnnouncementRef = useRef(false);\n  const lastWinnerTimestampRef = useRef(null);\n  const waitingForWinnerRef = useRef(false);\n  const previousRoundBettorsRef = useRef([]);\n  const timeRemainingRef = useRef(30);\n  const showWinnerVisuallyRef = useRef(false);\n  const isInWinnerStateRef = useRef(false);\n\n  // Check for stored username on app load\n  useEffect(() => {\n    const storedUsername = localStorage.getItem('slotpot_username');\n    if (storedUsername && storedUsername.trim().length >= 2) {\n      setCurrentUsername(storedUsername.trim());\n    }\n  }, []);\n\n  // Debug timer data\n  useEffect(() => {\n    var _contractState$timer, _contractState$timer2, _contractState$timer3;\n    console.log('🔍 Timer Debug:', {\n      isLive,\n      timerActive: contractState === null || contractState === void 0 ? void 0 : (_contractState$timer = contractState.timer) === null || _contractState$timer === void 0 ? void 0 : _contractState$timer.isActive,\n      startTime: contractState === null || contractState === void 0 ? void 0 : (_contractState$timer2 = contractState.timer) === null || _contractState$timer2 === void 0 ? void 0 : _contractState$timer2.startTime,\n      roundDuration: contractState === null || contractState === void 0 ? void 0 : contractState.roundDuration,\n      timeRemaining: contractState === null || contractState === void 0 ? void 0 : (_contractState$timer3 = contractState.timer) === null || _contractState$timer3 === void 0 ? void 0 : _contractState$timer3.timeRemaining,\n      currentTimeRemaining: timeRemaining\n    });\n  }, [isLive, contractState === null || contractState === void 0 ? void 0 : contractState.timer, contractState === null || contractState === void 0 ? void 0 : contractState.roundDuration, timeRemaining]);\n\n  // Keep refs in sync with state\n  useEffect(() => {\n    gameBettorsRef.current = gameBettors;\n  }, [gameBettors]);\n  useEffect(() => {\n    contractWinnerRef.current = contractWinner;\n  }, [contractWinner]);\n  useEffect(() => {\n    showWinnerAnnouncementRef.current = showWinnerAnnouncement;\n  }, [showWinnerAnnouncement]);\n  useEffect(() => {\n    waitingForWinnerRef.current = waitingForWinner;\n  }, [waitingForWinner]);\n  useEffect(() => {\n    previousRoundBettorsRef.current = previousRoundBettors;\n  }, [previousRoundBettors]);\n  useEffect(() => {\n    timeRemainingRef.current = timeRemaining;\n  }, [timeRemaining]);\n  useEffect(() => {\n    showWinnerVisuallyRef.current = showWinnerVisually;\n  }, [showWinnerVisually]);\n  useEffect(() => {\n    isInWinnerStateRef.current = isInWinnerState;\n  }, [isInWinnerState]);\n\n  // Centralized winner announcement manager\n  const showWinnerAnnouncements = useCallback((winnerData, source = 'unknown') => {\n    const winnerTimestamp = winnerData.timestamp;\n\n    // Block winner broadcasts if already in winner state\n    if (isInWinnerStateRef.current) {\n      if (process.env.NODE_ENV === 'development') {\n        // console.log(`🚫 BLOCKED - Already in winner state, ignoring ${source}`);\n      }\n      return false;\n    }\n\n    // Use coordinator to check if should block (pass full winner data for better duplicate detection)\n    if (winnerCoordinator.shouldBlock(winnerTimestamp, winnerData)) {\n      return false;\n    }\n\n    // Winner sound removed for performance\n\n    // Enter winner state to block future broadcasts\n    setIsInWinnerState(true);\n\n    // Set coordination flag via coordinator (pass full winner data)\n    winnerCoordinator.setActive(true, winnerTimestamp, winnerData);\n    setIsAnyWinnerDisplayActive(true);\n    lastWinnerTimestampRef.current = winnerTimestamp;\n\n    // Show App.js winner notification\n    setContractWinner(winnerData);\n    setShowWinnerAnnouncement(true);\n    setWaitingForWinner(false);\n\n    // Start animation - winner visual will appear after animation lands on winner\n    setTimeout(() => {\n      setShowWinnerVisually(true);\n    }, 3000); // Give animation time to land properly\n\n    return true;\n  }, []);\n\n  // Telegram integration\n  const {\n    user,\n    hapticFeedback,\n    showAlert,\n    hasRealUserData\n  } = useTelegramWebApp();\n\n  // Smart contract integration\n  const {\n    contractState,\n    userStats,\n    adminInfo: rawAdminInfo,\n    isLoadingContract,\n    isPlacingBet,\n    placeBet,\n    isConnected,\n    address\n  } = useJackpotContract();\n\n  // SAFETY: Ensure adminInfo is always properly structured and never an object that could be rendered\n  const adminInfo = useMemo(() => {\n    var _rawAdminInfo$current;\n    if (!rawAdminInfo || typeof rawAdminInfo !== 'object') {\n      return {\n        isAutoManaged: false,\n        roundDuration: 300,\n        minBetsToEnd: 1,\n        timerActive: false,\n        timeRemaining: 0\n      };\n    }\n\n    // Extract only primitive values to prevent accidental object rendering\n    return {\n      isAutoManaged: Boolean(rawAdminInfo.isAutoManaged),\n      roundDuration: Number(rawAdminInfo.roundDuration) || 300,\n      minBetsToEnd: Number(rawAdminInfo.minBetsToEnd) || 1,\n      timerActive: Boolean(rawAdminInfo.timerActive),\n      timeRemaining: Number(rawAdminInfo.timeRemaining) || 0,\n      // Ensure currentRound is always a number, never an object\n      currentRound: typeof rawAdminInfo.currentRound === 'object' ? ((_rawAdminInfo$current = rawAdminInfo.currentRound) === null || _rawAdminInfo$current === void 0 ? void 0 : _rawAdminInfo$current.roundNumber) || 0 : Number(rawAdminInfo.currentRound) || 0\n    };\n  }, [rawAdminInfo]);\n\n  // SAFETY: Ensure contractState timer properties are never objects that could be accidentally rendered\n  const safeContractState = useMemo(() => {\n    var _contractState$curren;\n    if (!contractState) return contractState;\n    return {\n      ...contractState,\n      // Ensure timer object properties are always primitives\n      timer: contractState.timer ? {\n        isActive: Boolean(contractState.timer.isActive),\n        timeRemaining: Number(contractState.timer.timeRemaining) || 0,\n        timeElapsed: Number(contractState.timer.timeElapsed) || 0,\n        roundNumber: Number(contractState.timer.roundNumber) || 0,\n        timerExpired: Boolean(contractState.timer.timerExpired)\n      } : undefined,\n      // Ensure currentRound is always a number if it exists\n      currentRound: typeof contractState.currentRound === 'object' ? ((_contractState$curren = contractState.currentRound) === null || _contractState$curren === void 0 ? void 0 : _contractState$curren.roundNumber) || 0 : contractState.currentRound\n    };\n  }, [contractState]);\n\n  // Use real contract data or fallback to simulated data\n  const jackpotValue = contractState.totalJackpot;\n  const isLive = contractState.isActive;\n\n  // Calculate user stats from gameBettors data - optimized with shallow comparison\n  const userBetTotal = useMemo(() => {\n    if (!isConnected || !address || !gameBettors.length) return 0;\n    return gameBettors.filter(bettor => bettor.address === address || bettor.walletAddress === address).reduce((total, bettor) => total + (bettor.amount || 0), 0);\n  }, [gameBettors.length, address, isConnected]); // Optimized dependencies\n\n  const userWinChance = useMemo(() => {\n    if (!isConnected || !address || userBetTotal === 0) return 0;\n\n    // Calculate current round total from gameBettors for immediate updates\n    const currentRoundTotal = gameBettors.reduce((total, bettor) => total + (bettor.amount || 0), 0);\n\n    // Use the live total from current bettors, fallback to contract jackpot value\n    const liveJackpotValue = currentRoundTotal > 0 ? currentRoundTotal : jackpotValue;\n    if (!liveJackpotValue) return 0;\n    return userBetTotal / liveJackpotValue * 100;\n  }, [userBetTotal, jackpotValue, gameBettors.length, isConnected, address]); // Optimized dependencies\n\n  // Track wager changes to determine when bet loading should stop\n  useEffect(() => {\n    const currentWager = userBetTotal || 0;\n    const currentBalance = (contractState === null || contractState === void 0 ? void 0 : contractState.userBalance) || 0;\n\n    // If we're waiting for wager change and the wager has changed\n    if (betLoadingState.isWaitingForWagerChange) {\n      const wagerChanged = Math.abs(currentWager - betLoadingState.lastWagerAmount) > 0.001;\n      const balanceChanged = Math.abs(currentBalance - betLoadingState.lastBalance) > 0.001;\n      if (wagerChanged || balanceChanged) {\n        console.log('💰 Wager/Balance changed - stopping bet loading state');\n        setBetLoadingState({\n          isWaitingForWagerChange: false,\n          lastWagerAmount: currentWager,\n          lastBalance: currentBalance\n        });\n      }\n    }\n  }, [userBetTotal, contractState === null || contractState === void 0 ? void 0 : contractState.userBalance, betLoadingState.isWaitingForWagerChange, betLoadingState.lastWagerAmount, betLoadingState.lastBalance]);\n\n  // Use automation timer or fallback to UI timer - only sync if significant difference\n  useEffect(() => {\n    var _contractState$timer4;\n    if (((_contractState$timer4 = contractState.timer) === null || _contractState$timer4 === void 0 ? void 0 : _contractState$timer4.timeRemaining) !== undefined) {\n      setTimeRemaining(prev => {\n        const backendTime = contractState.timer.timeRemaining;\n        const timeDiff = Math.abs(prev - backendTime);\n\n        // Don't sync timer if we're analyzing bets or waiting for winner to avoid bugs\n        if (waitingForWinner || isInWinnerState) {\n          return prev;\n        }\n\n        // Only sync if difference is 5+ seconds or backend is significantly ahead\n        if (timeDiff >= 5 || backendTime > prev + 2) {\n          return backendTime;\n        }\n\n        // Keep local countdown running for smooth performance\n        return prev;\n      });\n    } else {\n      setTimeRemaining(30);\n    }\n  }, [(_contractState$timer5 = contractState.timer) === null || _contractState$timer5 === void 0 ? void 0 : _contractState$timer5.timeRemaining, waitingForWinner, isInWinnerState]);\n\n  // Local countdown timer that ticks every second\n  useEffect(() => {\n    // Check if we should start the timer\n    if (!isLive) return;\n\n    // Get timer data\n    const timerData = contractState === null || contractState === void 0 ? void 0 : contractState.timer;\n    if (!(timerData !== null && timerData !== void 0 && timerData.isActive)) return;\n    const startTime = timerData.startTime;\n    const duration = contractState.roundDuration || 300;\n    if (!startTime) return;\n    console.log('⏰ Starting countdown timer:', {\n      startTime,\n      duration,\n      isLive\n    });\n\n    // Calculate initial time from timestamp\n    const elapsed = Math.floor((Date.now() - startTime) / 1000);\n    const initialRemaining = Math.max(0, duration - elapsed);\n    console.log('⏰ Initial timer setup:', {\n      elapsed,\n      initialRemaining\n    });\n    setTimeRemaining(initialRemaining);\n\n    // Local countdown that ticks every second\n    const countdown = setInterval(() => {\n      setTimeRemaining(prev => {\n        const newTime = Math.max(0, prev - 1);\n        console.log('⏰ Timer tick:', {\n          prev,\n          newTime\n        });\n\n        // When we reach 0, trigger \"analyzing bets\" state\n        if (newTime === 0 && !waitingForWinnerRef.current) {\n          setWaitingForWinner(true);\n        }\n        return newTime;\n      });\n    }, 1000);\n    return () => {\n      console.log('⏰ Clearing countdown timer');\n      clearInterval(countdown);\n    };\n  }, [isLive, contractState === null || contractState === void 0 ? void 0 : (_contractState$timer6 = contractState.timer) === null || _contractState$timer6 === void 0 ? void 0 : _contractState$timer6.isActive, contractState === null || contractState === void 0 ? void 0 : (_contractState$timer7 = contractState.timer) === null || _contractState$timer7 === void 0 ? void 0 : _contractState$timer7.startTime, contractState === null || contractState === void 0 ? void 0 : contractState.roundDuration]);\n\n  // Note: Old animation useEffect removed - now using Swiper component for all carousel animations\n\n  // Socket integration for immediate synchronization - SINGLE CONNECTION POINT\n  useEffect(() => {\n    // Socket connection established\n    socketService.connect();\n\n    // Listen for timer updates from socket\n    socketService.on('timer', timerData => {\n      // Timer update received\n\n      // SAFETY: Ensure timerData exists and has required properties\n      if (!timerData || typeof timerData !== 'object') {\n        console.warn('⚠️ Invalid timer data received in App:', timerData);\n        return;\n      }\n      const newTimeRemaining = typeof timerData.timeRemaining === 'number' ? timerData.timeRemaining : timeRemaining;\n      const newRoundNumber = typeof timerData.roundNumber === 'number' ? timerData.roundNumber : currentRound;\n\n      // Only update timeRemaining if it's significantly different (>5 seconds) or new round\n      setTimeRemaining(prev => {\n        const timeDiff = Math.abs(prev - newTimeRemaining);\n        const isNewRound = newRoundNumber !== currentRound;\n\n        // Only clear winner state when new round detected AND timer is significantly higher (real new round)\n        if (isNewRound && contractWinner && newTimeRemaining > 200) {\n          // New round detected - clearing winner state\n          setIsInWinnerState(false);\n          setContractWinner(null);\n          setShowWinnerAnnouncement(false);\n          setShowWinnerVisually(false);\n          setPostWinnerLoading(false);\n          setIsAnyWinnerDisplayActive(false);\n          setPreviousRoundBettors([]);\n        }\n\n        // Don't sync timer if we're analyzing bets or waiting for winner to avoid bugs\n        if (waitingForWinnerRef.current || isInWinnerStateRef.current) {\n          // Timer sync blocked - in analyzing/winner state\n          return prev;\n        }\n\n        // Sync if: new round, big difference (>5s), or timer reset (server > client)\n        if (isNewRound || timeDiff >= 5 || newTimeRemaining > prev + 2) {\n          // Timer synced\n          return newTimeRemaining;\n        }\n\n        // Otherwise keep local countdown running smoothly\n        return prev;\n      });\n      if (newRoundNumber && newRoundNumber !== currentRound) {\n        setCurrentRound(newRoundNumber);\n      }\n      // Note: Contract state timer will be updated via fullGameUpdate/contractStateUpdate events\n    });\n\n    // Listen for new round events\n    socketService.on('newRound', roundData => {\n      // console.log('🎰 App: New round detected via socket:', roundData);\n      // console.log('🔓 Exiting winner state - new round started');\n\n      setTimeRemaining(roundData.timeRemaining);\n      setCurrentRound(roundData.roundNumber);\n      setIsInWinnerState(false);\n      setIsAnyWinnerDisplayActive(false);\n      winnerCoordinator.reset();\n      lastWinnerTimestampRef.current = null; // Clear duplicate protection for new round\n\n      // Clear ALL winner highlighting for new round\n      setContractWinner(null);\n      setShowWinnerAnnouncement(false);\n      setShowWinnerVisually(false);\n      setPreviousRoundBettors([]);\n      setWaitingForWinner(false);\n      setPostWinnerLoading(false);\n\n      // Note: Animation reset handled by Swiper component\n    });\n\n    // Listen for game state updates\n    socketService.on('gameState', gameState => {\n      var _gameState$timer;\n      // console.log('🎮 App: Game state update:', gameState);\n\n      // Priority: Use timer.timeRemaining ONLY (as user specified)\n      const backendTimeRemaining = (_gameState$timer = gameState.timer) === null || _gameState$timer === void 0 ? void 0 : _gameState$timer.timeRemaining;\n      if (backendTimeRemaining !== undefined) {\n        setTimeRemaining(prev => {\n          const timeDiff = Math.abs(prev - backendTimeRemaining);\n\n          // Don't sync timer if we're analyzing bets or waiting for winner to avoid bugs\n          if (waitingForWinnerRef.current || isInWinnerStateRef.current) {\n            // console.log('⏰ GameState timer sync blocked - in analyzing/winner state');\n            return prev;\n          }\n\n          // Only sync if there's a significant difference (>=5s) or if backend is ahead\n          if (timeDiff >= 5 || backendTimeRemaining > prev + 2) {\n            // console.log('⏰ GameState syncing timer:', prev, '→', backendTimeRemaining, timeDiff >= 5 ? '(>=5s difference)' : '(backend ahead)');\n            return backendTimeRemaining;\n          }\n\n          // Keep local countdown running if difference is small\n          // console.log('⏰ GameState keeping local timer:', prev, 'vs backend:', backendTimeRemaining);\n          return prev;\n        });\n      }\n      if (gameState.currentRound) {\n        var _gameState$timer2, _gameState$timer3;\n        // Extract roundNumber if currentRound is an object, otherwise use the value directly\n        const roundNumber = typeof gameState.currentRound === 'object' && gameState.currentRound.roundNumber ? gameState.currentRound.roundNumber : gameState.currentRound;\n\n        // Check if this is a new round with active timer - this means new round started\n        const isNewRound = roundNumber !== currentRound;\n        const hasActiveTimer = ((_gameState$timer2 = gameState.timer) === null || _gameState$timer2 === void 0 ? void 0 : _gameState$timer2.isActive) || ((_gameState$timer3 = gameState.timer) === null || _gameState$timer3 === void 0 ? void 0 : _gameState$timer3.timeRemaining) > 60;\n        if (isNewRound && hasActiveTimer && isInWinnerStateRef.current) {\n          // console.log('🔄 GameState detected NEW ROUND with active timer - clearing winner state');\n          // console.log('🔓 Exiting winner state - new round started via gameState');\n          setIsInWinnerState(false);\n          setContractWinner(null);\n          setShowWinnerAnnouncement(false);\n          setShowWinnerVisually(false);\n          setPostWinnerLoading(false);\n          setIsAnyWinnerDisplayActive(false);\n          // Don't clear previousRoundBettors immediately - let carousel finish its animation\n          setTimeout(() => {\n            // console.log('🔄 Delayed clearing of previous round bettors');\n            setPreviousRoundBettors([]);\n          }, 2000); // Give carousel time to finish\n          winnerCoordinator.reset();\n        }\n        setCurrentRound(roundNumber);\n      }\n\n      // Handle winner-related states\n      if (gameState.isWaitingForWinner !== undefined) {\n        // If transitioning TO waiting for winner, store current bettors\n        if (gameState.isWaitingForWinner && !waitingForWinnerRef.current && gameBettorsRef.current.length > 0) {\n          // console.log('🎮 App: Transitioning to waiting for winner, storing bettors:', gameBettorsRef.current);\n\n          // Enhance bettors with proper usernames before storing\n          const enhancedBettors = gameBettorsRef.current.map(bettor => {\n            var _bettor$address, _bettor$address2;\n            return {\n              ...bettor,\n              username: bettor.username || bettor.displayName || `Player_${(_bettor$address = bettor.address) === null || _bettor$address === void 0 ? void 0 : _bettor$address.slice(-4)}`,\n              displayName: bettor.displayName || bettor.username || `Player_${(_bettor$address2 = bettor.address) === null || _bettor$address2 === void 0 ? void 0 : _bettor$address2.slice(-4)}`\n            };\n          });\n          setPreviousRoundBettors(enhancedBettors);\n        }\n        setWaitingForWinner(gameState.isWaitingForWinner);\n\n        // If waitingForWinner becomes false AND we have a new round with active timer, reset winner state\n        if (!gameState.isWaitingForWinner && isInWinnerStateRef.current) {\n          var _gameState$timer4, _gameState$timer5;\n          const roundNumber = typeof gameState.currentRound === 'object' && gameState.currentRound.roundNumber ? gameState.currentRound.roundNumber : gameState.currentRound;\n          const isNewRound = roundNumber && roundNumber !== currentRound;\n          const hasActiveTimer = ((_gameState$timer4 = gameState.timer) === null || _gameState$timer4 === void 0 ? void 0 : _gameState$timer4.isActive) || ((_gameState$timer5 = gameState.timer) === null || _gameState$timer5 === void 0 ? void 0 : _gameState$timer5.timeRemaining) > 60;\n          if (isNewRound && hasActiveTimer) {\n            // console.log('🔄 waitingForWinner false + new round + active timer = new round started - clearing winner state');\n            // console.log('🔓 Exiting winner state - new round confirmed');\n            setIsInWinnerState(false);\n            setContractWinner(null);\n            setShowWinnerAnnouncement(false);\n            setShowWinnerVisually(false);\n            setPostWinnerLoading(false);\n            setIsAnyWinnerDisplayActive(false);\n            // Don't clear previousRoundBettors immediately - let carousel finish its animation\n            setTimeout(() => {\n              // console.log('🔄 Delayed clearing of previous round bettors (waitingForWinner)');\n              setPreviousRoundBettors([]);\n            }, 2000); // Give carousel time to finish\n            winnerCoordinator.reset();\n          } else {\n            // console.log('⏳ waitingForWinner became false, but keeping winner state (no new round detected)');\n          }\n        }\n      }\n\n      // Update bettors data centrally (avoids duplicate processing)\n      if (gameState.bettors && Array.isArray(gameState.bettors)) {\n        // Only log if bettors count changed to reduce spam\n        if (gameState.bettors.length !== gameBettorsRef.current.length) {\n          // console.log('🎮 App: Updating bettors from gameState:', gameState.bettors.length, 'bettors');\n\n          // Play bet sound when new bettor joins (if count increased)\n          if (gameState.bettors.length > gameBettorsRef.current.length) {\n            // Bet sound removed for performance\n          }\n\n          // Trigger slot machine animation when new bettor joins\n          setSlotSpinning(true);\n          setTimeout(() => setSlotSpinning(false), 3000);\n        }\n\n        // Store current bettors as previous round bettors when waiting for winner\n        if (gameState.isWaitingForWinner && gameState.bettors.length > 0) {\n          console.log('🎮 App: Storing bettors for winner matching:', gameState.bettors);\n\n          // Enhance bettors with proper usernames before storing\n          const enhancedBettors = gameState.bettors.map(bettor => {\n            var _bettor$address3, _bettor$address4;\n            return {\n              ...bettor,\n              username: bettor.username || bettor.displayName || `Player_${(_bettor$address3 = bettor.address) === null || _bettor$address3 === void 0 ? void 0 : _bettor$address3.slice(-4)}`,\n              displayName: bettor.displayName || bettor.username || `Player_${(_bettor$address4 = bettor.address) === null || _bettor$address4 === void 0 ? void 0 : _bettor$address4.slice(-4)}`\n            };\n          });\n          setPreviousRoundBettors(enhancedBettors);\n        }\n        setGameBettors(gameState.bettors);\n      }\n\n      // Check for winner announcement in game state (prevent duplicates with stronger protection)\n      if (gameState.winnerAnnouncement) {\n        showWinnerAnnouncements(gameState.winnerAnnouncement, 'gameState');\n      }\n    });\n\n    // Listen for comprehensive game data updates\n    socketService.on('fullGameUpdate', gameData => {\n      //console.log('🎮 App: Full game update:', gameData);\n      // These updates will trigger re-renders via useJackpotContract hook\n      // The hook will detect the changes and update accordingly\n    });\n\n    // Listen for bettors updates\n    socketService.on('bettorsUpdate', data => {\n      // Bet sound removed for performance\n\n      // Trigger slot machine animation on bettor updates\n      setSlotSpinning(true);\n      setTimeout(() => setSlotSpinning(false), 3000);\n      // Force a refresh of contract state to sync with socket data\n      // This ensures jackpot value and user stats stay in sync\n    });\n\n    // Listen for waiting for winner events\n    socketService.on('waitingForWinner', data => {\n      console.log('🎯 App: Waiting for winner state changed:', data);\n\n      // Handle both old boolean format and new object format\n      const isWaiting = typeof data === 'boolean' ? data : data.isWaiting;\n      const message = typeof data === 'object' ? data.message : null;\n\n      // Don't reset winner state just because waitingForWinner changed\n      // Only reset when we get explicit newRound/roundReset events\n      setWaitingForWinner(isWaiting);\n\n      // Log but don't auto-reset winner state\n      if (!isWaiting && isInWinnerStateRef.current) {\n        console.log('⏳ waitingForWinner event became false, but keeping winner state until explicit new round');\n      }\n      if (message) {\n        console.log('🎯 App: Winner selection message:', message);\n      }\n    });\n\n    // Listen for winner announcements (primary)\n    socketService.on('winner', winnerData => {\n      console.log('🏆 App: Winner announced:', winnerData);\n      console.log('🏆 App: Previous round bettors for comparison:', previousRoundBettors);\n      setWaitingForWinner(false);\n      setPostWinnerLoading(true);\n\n      // Use centralized manager\n      showWinnerAnnouncements(winnerData, 'winner event');\n    });\n\n    // Listen for direct winner announcements (fallback/reliable delivery)\n    socketService.on('winnerAnnouncement', winnerData => {\n      console.log('🎯 App: Direct winner announcement:', winnerData);\n      setWaitingForWinner(false);\n\n      // Use centralized manager\n      showWinnerAnnouncements(winnerData, 'direct announcement');\n    });\n\n    // Listen for round reset events (when timer is reset due to no bettors)\n    socketService.on('roundReset', resetData => {\n      console.log('🔄 App: Round reset detected:', resetData);\n      console.log('🔓 Exiting winner state - round reset');\n\n      // Reset timer to the new duration\n      setTimeRemaining(resetData.timeRemaining);\n      setCurrentRound(resetData.roundNumber);\n\n      // Clear ALL winner states since this is a fresh timer\n      setIsInWinnerState(false);\n      setWaitingForWinner(false);\n      setContractWinner(null);\n      setShowWinnerAnnouncement(false);\n      setShowWinnerVisually(false);\n      setPostWinnerLoading(false);\n      setIsAnyWinnerDisplayActive(false);\n      winnerCoordinator.reset();\n\n      // Clear bettors list since round was reset\n      setGameBettors([]);\n      // Don't clear previousRoundBettors immediately on reset - let any ongoing animation finish\n      setTimeout(() => {\n        console.log('🔄 Delayed clearing of previous round bettors (round reset)');\n        setPreviousRoundBettors([]);\n      }, 1000);\n\n      // Note: Animation reset handled by Swiper component\n    });\n    return () => {\n      console.log('🔌 App.js: Cleaning up socket listeners...');\n      socketService.off('timer');\n      socketService.off('newRound');\n      socketService.off('roundReset');\n      socketService.off('gameState');\n      socketService.off('fullGameUpdate');\n      socketService.off('bettorsUpdate');\n      socketService.off('waitingForWinner');\n      socketService.off('winner');\n      socketService.off('winnerAnnouncement');\n      // Disconnect when app unmounts to prevent memory leaks\n      socketService.disconnect();\n    };\n  }, [currentRound, showWinnerAnnouncements]); // Added missing dependencies\n\n  const handleBetChange = e => {\n    const inputValue = e.target.value;\n\n    // Allow empty input or numbers with decimal points (both . and ,)\n    if (inputValue === '' || inputValue === '.' || inputValue === ',' || /^\\d*[.,]?\\d*$/.test(inputValue)) {\n      // Convert comma to period for consistency\n      const normalizedValue = inputValue.replace(',', '.');\n\n      // For empty or just \".\" input, keep the raw value but show comma if user typed comma\n      if (normalizedValue === '' || normalizedValue === '.') {\n        setBetAmount(inputValue); // Keep original input (might be comma)\n        return;\n      }\n\n      // For valid numbers, check limits but preserve decimal typing\n      const numericValue = parseFloat(normalizedValue);\n      if (!isNaN(numericValue) && numericValue <= 10) {\n        setBetAmount(normalizedValue); // Use normalized value to ensure consistency\n      }\n    }\n  };\n  const handleTabChange = tab => {\n    hapticFeedback('light');\n    setActiveTab(tab);\n  };\n\n  // Enhanced bet placement with real smart contract\n  const handlePlaceBet = async () => {\n    // Prevent betting during winner display period\n    if (contractWinner || showWinnerAnnouncement) {\n      showAlert('⏳ Please wait for the new round to start before placing a bet!');\n      return;\n    }\n    if (!isConnected) {\n      showAlert('Please connect your wallet first!');\n      return;\n    }\n\n    // Convert comma to period before parsing for validation\n    const normalizedBetAmount = betAmount.toString().replace(',', '.');\n    const numericBetAmount = parseFloat(normalizedBetAmount);\n    if (isNaN(numericBetAmount) || numericBetAmount <= 0) {\n      showAlert('Please enter a valid bet amount!');\n      return;\n    }\n    try {\n      hapticFeedback('medium');\n      await placeBet(numericBetAmount);\n\n      // Bet sound removed for performance\n      // Set loading state to wait for wager/balance change\n      setBetLoadingState({\n        isWaitingForWagerChange: true,\n        lastWagerAmount: userBetTotal || 0,\n        lastBalance: (contractState === null || contractState === void 0 ? void 0 : contractState.userBalance) || 0\n      });\n\n      // Reset bet amount after successful bet\n      setBetAmount(0.1);\n      hapticFeedback('success');\n      showAlert(`✅ Bet of ${numericBetAmount.toFixed(3)} TON placed successfully!`);\n    } catch (error) {\n      hapticFeedback('error');\n      showAlert(`❌ Failed to place bet: ${error.message}`);\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"app\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"app-container\",\n      children: [/*#__PURE__*/_jsxDEV(ChatBubble, {\n        telegramGroupUrl: \"https://t.me/yourgroup\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 743,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"main-content\",\n        children: activeTab === 'profile' ? /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"profile-container\",\n          children: [/*#__PURE__*/_jsxDEV(Header, {\n            currentUsername: currentUsername,\n            onShowUsernameInput: () => setShowUsernameInput(true)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 749,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(PlayerProfile, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 753,\n            columnNumber: 17\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 748,\n          columnNumber: 15\n        }, this) : activeTab === 'referrals' ? /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"referrals-container\",\n          children: [/*#__PURE__*/_jsxDEV(Header, {\n            currentUsername: currentUsername,\n            onShowUsernameInput: () => setShowUsernameInput(true)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 757,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(ReferralSystem, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 761,\n            columnNumber: 17\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 756,\n          columnNumber: 15\n        }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"jackpot-container\",\n          children: [/*#__PURE__*/_jsxDEV(OnlineIndicator, {\n            isConnected: isConnected\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 766,\n            columnNumber: 19\n          }, this), /*#__PURE__*/_jsxDEV(Header, {\n            currentUsername: currentUsername,\n            onShowUsernameInput: () => setShowUsernameInput(true)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 770,\n            columnNumber: 19\n          }, this), /*#__PURE__*/_jsxDEV(_Fragment, {\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"betting-section\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"bet-input-section\",\n                children: [/*#__PURE__*/_jsxDEV(\"input\", {\n                  type: \"text\",\n                  className: \"bet-amount-input\",\n                  value: betAmount,\n                  onChange: handleBetChange,\n                  placeholder: \"0.000\",\n                  inputMode: \"decimal\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 778,\n                  columnNumber: 17\n                }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                  className: \"bet-increment-btn\",\n                  onClick: () => setBetAmount(prev => {\n                    const currentValue = parseFloat(prev) || 0;\n                    return Math.min(currentValue + 0.1, 10).toFixed(1);\n                  }),\n                  children: \"+0.1\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 786,\n                  columnNumber: 17\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 777,\n                columnNumber: 15\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"balance-section\",\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"balance-label\",\n                  children: \"Balance\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 796,\n                  columnNumber: 17\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"balance-amount\",\n                  children: [isConnected ? `${(contractState.userBalance || 0).toFixed(6)}` : '0.000000', /*#__PURE__*/_jsxDEV(\"span\", {\n                    className: \"balance-symbol\",\n                    children: \"TON\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 799,\n                    columnNumber: 19\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 797,\n                  columnNumber: 17\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 795,\n                columnNumber: 15\n              }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                className: \"bet-button\",\n                onClick: handlePlaceBet,\n                disabled: isPlacingBet || betLoadingState.isWaitingForWagerChange || !isConnected || contractWinner || showWinnerAnnouncement,\n                children: contractWinner || showWinnerAnnouncement ? 'Winner Display - Wait for New Round' : isPlacingBet ? 'Betting...' : betLoadingState.isWaitingForWagerChange ? 'Processing Bet...' : 'Bet'\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 803,\n                columnNumber: 11\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 776,\n              columnNumber: 13\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"stats-grid four-cards\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"stat-card jackpot-card\",\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"stat-value\",\n                  children: [/*#__PURE__*/_jsxDEV(TonIcon, {\n                    size: 14,\n                    className: \"wager-ton-icon\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 818,\n                    columnNumber: 19\n                  }, this), jackpotValue.toFixed(3)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 817,\n                  columnNumber: 17\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"stat-label\",\n                  children: \"Jackpot Value\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 821,\n                  columnNumber: 17\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 816,\n                columnNumber: 15\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"stat-card\",\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"stat-value\",\n                  children: [/*#__PURE__*/_jsxDEV(TonIcon, {\n                    size: 14,\n                    className: \"wager-ton-icon\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 825,\n                    columnNumber: 19\n                  }, this), userBetTotal.toFixed(3)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 824,\n                  columnNumber: 17\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"stat-label\",\n                  children: \"Your Wager\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 828,\n                  columnNumber: 17\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 823,\n                columnNumber: 15\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"stat-card chance-stat\",\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"stat-value\",\n                  children: [userWinChance.toFixed(2), \"%\"]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 831,\n                  columnNumber: 17\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"stat-label\",\n                  children: \"Your Chance\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 832,\n                  columnNumber: 17\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 830,\n                columnNumber: 15\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"stat-card\",\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"stat-value\",\n                  children: [Math.floor((timeRemaining || 0) / 60), \":\", ((timeRemaining || 0) % 60).toString().padStart(2, '0')]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 835,\n                  columnNumber: 17\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"stat-label\",\n                  children: \"Time Remaining\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 838,\n                  columnNumber: 17\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 834,\n                columnNumber: 15\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 815,\n              columnNumber: 13\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"players-carousel-section\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: `carousel-header ${timeRemaining === 0 && waitingForWinner || contractWinner && !showWinnerVisually ? 'analyzing' : showWinnerVisually ? 'winner' : ''}`,\n                children: /*#__PURE__*/_jsxDEV(\"h3\", {\n                  children: timeRemaining === 0 && waitingForWinner || contractWinner && !showWinnerVisually ? \"🔍 Analyzing Bets...\" : showWinnerVisually && contractWinner ? `🏆 Winner: ${contractWinner.username || contractWinner.displayName || contractWinner.winnerName || `Player_${(_contractWinner$winne = contractWinner.winner) === null || _contractWinner$winne === void 0 ? void 0 : _contractWinner$winne.slice(-4)}` || 'Player'}` : `Players (${gameBettors.length > 0 ? gameBettors.length : previousRoundBettors.length})`\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 848,\n                  columnNumber: 17\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 844,\n                columnNumber: 15\n              }, this), /*#__PURE__*/_jsxDEV(SimpleCarousel, {\n                players: (() => {\n                  // Same data logic as before\n                  const bettorsToShow = contractWinner || waitingForWinner ? previousRoundBettors.length > 0 ? previousRoundBettors : gameBettors : gameBettors.length > 0 ? gameBettors : [];\n\n                  // Ensure we have at least 6 items to show (fill with waiting slots if needed)\n                  return [...bettorsToShow, ...Array.from({\n                    length: Math.max(0, 6 - bettorsToShow.length)\n                  }, () => null)];\n                })(),\n                contractWinner: contractWinner,\n                isSpinning: timeRemaining === 0 && waitingForWinner || contractWinner && !showWinnerVisually,\n                onSpinComplete: () => {\n                  console.log('🎯 Winner animation completed in SimpleCarousel!');\n                  console.log('🔄 Carousel finished - now safe to clear winner state in future');\n                  // Winner is already set via showWinnerVisually\n                }\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 859,\n                columnNumber: 15\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 843,\n              columnNumber: 13\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"bets-deflate-section\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"bets-deflate-header\",\n                children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n                  children: \"Current Round Bets\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 885,\n                  columnNumber: 13\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"round-info\",\n                  children: /*#__PURE__*/_jsxDEV(\"span\", {\n                    children: [\"#\", currentRound]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 887,\n                    columnNumber: 15\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 886,\n                  columnNumber: 13\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 884,\n                columnNumber: 11\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"bets-deflate-list\",\n                children: [(() => {\n                  const bettorsToShow = contractWinner || waitingForWinner ? previousRoundBettors.length > 0 ? previousRoundBettors : gameBettors : gameBettors.length > 0 ? gameBettors : [];\n                  return bettorsToShow.map((bettor, index) => {\n                    const betAmount = parseFloat(bettor.amount || 0);\n                    const currentJackpot = parseFloat(jackpotValue || 0);\n                    const chance = currentJackpot > 0 ? (betAmount / currentJackpot * 100).toFixed(2) : '0.00';\n                    const usdValue = (betAmount * 2.5).toFixed(1); // Approximate USD value\n\n                    return /*#__PURE__*/_jsxDEV(\"div\", {\n                      className: \"bet-deflate-card\",\n                      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                        className: \"bet-deflate-avatar\",\n                        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                          className: \"avatar-icon\",\n                          children: /*#__PURE__*/_jsxDEV(Users, {\n                            size: 20\n                          }, void 0, false, {\n                            fileName: _jsxFileName,\n                            lineNumber: 907,\n                            columnNumber: 25\n                          }, this)\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 906,\n                          columnNumber: 23\n                        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                          className: \"avatar-count\",\n                          children: \"1\"\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 909,\n                          columnNumber: 23\n                        }, this)]\n                      }, void 0, true, {\n                        fileName: _jsxFileName,\n                        lineNumber: 905,\n                        columnNumber: 21\n                      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                        className: \"bet-deflate-info\",\n                        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                          className: \"bet-deflate-username\",\n                          children: bettor.username || bettor.displayName || bettor.winner || `Player_${bettor.address.slice(-4)}`\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 913,\n                          columnNumber: 23\n                        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                          className: \"bet-deflate-amount\",\n                          children: [/*#__PURE__*/_jsxDEV(TonIcon, {\n                            size: 16,\n                            className: \"bet-deflate-ton-icon\"\n                          }, void 0, false, {\n                            fileName: _jsxFileName,\n                            lineNumber: 917,\n                            columnNumber: 25\n                          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                            children: betAmount.toFixed(3)\n                          }, void 0, false, {\n                            fileName: _jsxFileName,\n                            lineNumber: 918,\n                            columnNumber: 25\n                          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                            className: \"bet-deflate-usd\",\n                            children: [\"~$\", usdValue]\n                          }, void 0, true, {\n                            fileName: _jsxFileName,\n                            lineNumber: 919,\n                            columnNumber: 25\n                          }, this)]\n                        }, void 0, true, {\n                          fileName: _jsxFileName,\n                          lineNumber: 916,\n                          columnNumber: 23\n                        }, this)]\n                      }, void 0, true, {\n                        fileName: _jsxFileName,\n                        lineNumber: 912,\n                        columnNumber: 21\n                      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                        className: \"bet-deflate-chance\",\n                        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                          className: \"chance-label\",\n                          children: [/*#__PURE__*/_jsxDEV(Target, {\n                            size: 12\n                          }, void 0, false, {\n                            fileName: _jsxFileName,\n                            lineNumber: 925,\n                            columnNumber: 25\n                          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                            children: \"Chance\"\n                          }, void 0, false, {\n                            fileName: _jsxFileName,\n                            lineNumber: 926,\n                            columnNumber: 25\n                          }, this)]\n                        }, void 0, true, {\n                          fileName: _jsxFileName,\n                          lineNumber: 924,\n                          columnNumber: 23\n                        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                          className: \"chance-value\",\n                          children: [chance, \"%\"]\n                        }, void 0, true, {\n                          fileName: _jsxFileName,\n                          lineNumber: 928,\n                          columnNumber: 23\n                        }, this)]\n                      }, void 0, true, {\n                        fileName: _jsxFileName,\n                        lineNumber: 923,\n                        columnNumber: 21\n                      }, this)]\n                    }, `${bettor.address}-${index}`, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 904,\n                      columnNumber: 19\n                    }, this);\n                  });\n                })(), (() => {\n                  const bettorsToShow = contractWinner || waitingForWinner ? previousRoundBettors.length > 0 ? previousRoundBettors : gameBettors : gameBettors.length > 0 ? gameBettors : [];\n                  if (bettorsToShow.length === 0) {\n                    return /*#__PURE__*/_jsxDEV(\"div\", {\n                      className: \"bet-deflate-empty\",\n                      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                        className: \"empty-icon\",\n                        children: /*#__PURE__*/_jsxDEV(Coins, {\n                          size: 32\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 944,\n                          columnNumber: 23\n                        }, this)\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 943,\n                        columnNumber: 21\n                      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                        className: \"empty-text\",\n                        children: \"No bets yet\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 946,\n                        columnNumber: 21\n                      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                        className: \"empty-subtext\",\n                        children: \"Be the first to place a bet!\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 947,\n                        columnNumber: 21\n                      }, this)]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 942,\n                      columnNumber: 19\n                    }, this);\n                  }\n                  return null;\n                })()]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 891,\n                columnNumber: 11\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 883,\n              columnNumber: 9\n            }, this), /*#__PURE__*/_jsxDEV(RecentWinners, {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 957,\n              columnNumber: 9\n            }, this)]\n          }, void 0, true)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 764,\n          columnNumber: 17\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 746,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"mobile-navbar\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"navbar-items\",\n          children: [/*#__PURE__*/_jsxDEV(\"button\", {\n            className: `navbar-item ${activeTab === 'jackpot' ? 'active' : ''}`,\n            onClick: () => setActiveTab('jackpot'),\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"navbar-icon\",\n              children: /*#__PURE__*/_jsxDEV(DollarSign, {\n                size: 20\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 971,\n                columnNumber: 42\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 971,\n              columnNumber: 13\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"navbar-label\",\n              children: \"Jackpot\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 972,\n              columnNumber: 13\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 967,\n            columnNumber: 11\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            className: `navbar-item ${activeTab === 'profile' ? 'active' : ''}`,\n            onClick: () => setActiveTab('profile'),\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"navbar-icon\",\n              children: /*#__PURE__*/_jsxDEV(User, {\n                size: 20\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 979,\n                columnNumber: 42\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 979,\n              columnNumber: 13\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"navbar-label\",\n              children: \"Profile\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 980,\n              columnNumber: 13\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 975,\n            columnNumber: 11\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            className: `navbar-item ${activeTab === 'referrals' ? 'active' : ''}`,\n            onClick: () => setActiveTab('referrals'),\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"navbar-icon\",\n              children: /*#__PURE__*/_jsxDEV(Share2, {\n                size: 20\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 987,\n                columnNumber: 42\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 987,\n              columnNumber: 13\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"navbar-label\",\n              children: \"Referrals\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 988,\n              columnNumber: 13\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 983,\n            columnNumber: 11\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 966,\n          columnNumber: 9\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 965,\n        columnNumber: 7\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 741,\n      columnNumber: 9\n    }, this), isLoadingContract && !contractWinner && !showWinnerAnnouncement && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"loading-overlay\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"loading-spinner\",\n        children: /*#__PURE__*/_jsxDEV(Loader2, {\n          size: 24,\n          className: \"animate-spin\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 997,\n          columnNumber: 44\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 997,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n        children: \"Loading contract data...\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 998,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 996,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(WinnerBroadcast, {\n      socketService: socketService\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 1003,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(UsernameInput, {\n      isVisible: showUsernameInput,\n      currentUsername: currentUsername,\n      onUsernameSet: username => {\n        setCurrentUsername(username);\n        setShowUsernameInput(false);\n        // Trigger a page reload to update the username everywhere\n        window.location.reload();\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 1006,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 740,\n    columnNumber: 5\n  }, this);\n}\n\n// Main App component with TON Connect Provider\n_s(AppContent, \"6Vfkrhry/rCyb7EGGN+08uV4kbU=\", false, function () {\n  return [useReferralAutoRegistration, useTelegramWebApp, useJackpotContract];\n});\n_c = AppContent;\nfunction App() {\n  return /*#__PURE__*/_jsxDEV(TonConnectUIProvider, {\n    manifestUrl: manifestUrl,\n    uiPreferences: uiOptions.uiPreferences,\n    language: uiOptions.language,\n    restoreConnection: uiOptions.restoreConnection,\n    actionsConfiguration: uiOptions.actionsConfiguration,\n    children: /*#__PURE__*/_jsxDEV(AppContent, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 1030,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 1023,\n    columnNumber: 5\n  }, this);\n}\n_c2 = App;\nexport default App;\nvar _c, _c2;\n$RefreshReg$(_c, \"AppContent\");\n$RefreshReg$(_c2, \"App\");","map":{"version":3,"names":["React","useState","useEffect","useRef","useCallback","useMemo","memo","TonConnectUIProvider","GameArea","WalletConnection","PlayerProfile","WinnerBroadcast","Header","RecentWinners","SimpleCarousel","ReferralSystem","UsernameInput","OnlineIndicator","ChatBubble","TonIcon","useTelegramWebApp","useJackpotContract","useReferralAutoRegistration","DollarSign","User","Loader2","Trophy","Share2","Users","Target","Coins","socketService","winnerCoordinator","uiOptions","jsxDEV","_jsxDEV","Fragment","_Fragment","manifestUrl","AppContent","_s","_contractState$timer5","_contractState$timer6","_contractState$timer7","_contractWinner$winne","currentRound","setCurrentRound","timeRemaining","setTimeRemaining","activeTab","setActiveTab","betAmount","setBetAmount","showWinnerAnnouncement","setShowWinnerAnnouncement","waitingForWinner","setWaitingForWinner","contractWinner","setContractWinner","postWinnerLoading","setPostWinnerLoading","setIsAnyWinnerDisplayActive","showWinnerVisually","setShowWinnerVisually","isInWinnerState","setIsInWinnerState","showUsernameInput","setShowUsernameInput","currentUsername","setCurrentUsername","betLoadingState","setBetLoadingState","isWaitingForWagerChange","lastWagerAmount","lastBalance","gameBettors","setGameBettors","previousRoundBettors","setPreviousRoundBettors","slotSpinning","setSlotSpinning","gameBettorsRef","contractWinnerRef","showWinnerAnnouncementRef","lastWinnerTimestampRef","waitingForWinnerRef","previousRoundBettorsRef","timeRemainingRef","showWinnerVisuallyRef","isInWinnerStateRef","storedUsername","localStorage","getItem","trim","length","_contractState$timer","_contractState$timer2","_contractState$timer3","console","log","isLive","timerActive","contractState","timer","isActive","startTime","roundDuration","currentTimeRemaining","current","showWinnerAnnouncements","winnerData","source","winnerTimestamp","timestamp","process","env","NODE_ENV","shouldBlock","setActive","setTimeout","user","hapticFeedback","showAlert","hasRealUserData","userStats","adminInfo","rawAdminInfo","isLoadingContract","isPlacingBet","placeBet","isConnected","address","_rawAdminInfo$current","isAutoManaged","minBetsToEnd","Boolean","Number","roundNumber","safeContractState","_contractState$curren","timeElapsed","timerExpired","undefined","jackpotValue","totalJackpot","userBetTotal","filter","bettor","walletAddress","reduce","total","amount","userWinChance","currentRoundTotal","liveJackpotValue","currentWager","currentBalance","userBalance","wagerChanged","Math","abs","balanceChanged","_contractState$timer4","prev","backendTime","timeDiff","timerData","duration","elapsed","floor","Date","now","initialRemaining","max","countdown","setInterval","newTime","clearInterval","connect","on","warn","newTimeRemaining","newRoundNumber","isNewRound","roundData","reset","gameState","_gameState$timer","backendTimeRemaining","_gameState$timer2","_gameState$timer3","hasActiveTimer","isWaitingForWinner","enhancedBettors","map","_bettor$address","_bettor$address2","username","displayName","slice","_gameState$timer4","_gameState$timer5","bettors","Array","isArray","_bettor$address3","_bettor$address4","winnerAnnouncement","gameData","data","isWaiting","message","resetData","off","disconnect","handleBetChange","e","inputValue","target","value","test","normalizedValue","replace","numericValue","parseFloat","isNaN","handleTabChange","tab","handlePlaceBet","normalizedBetAmount","toString","numericBetAmount","toFixed","error","className","children","telegramGroupUrl","fileName","_jsxFileName","lineNumber","columnNumber","onShowUsernameInput","type","onChange","placeholder","inputMode","onClick","currentValue","min","disabled","size","padStart","winnerName","winner","players","bettorsToShow","from","isSpinning","onSpinComplete","index","currentJackpot","chance","usdValue","isVisible","onUsernameSet","window","location","reload","_c","App","uiPreferences","language","restoreConnection","actionsConfiguration","_c2","$RefreshReg$"],"sources":["C:/Users/adams/OneDrive/Desktop/Work/slotpot/src/App.js"],"sourcesContent":["import React, { useState, useEffect, useRef, useCallback, useMemo, memo } from 'react';\nimport { TonConnectUIProvider } from '@tonconnect/ui-react';\nimport GameArea from './components/GameArea';\nimport WalletConnection from './components/WalletConnection';\nimport PlayerProfile from './components/PlayerProfile';\nimport WinnerBroadcast from './components/WinnerBroadcast';\nimport Header from './components/Header';\nimport RecentWinners from './components/RecentWinners';\nimport SimpleCarousel from './components/SimpleCarousel';\nimport ReferralSystem from './components/ReferralSystem';\nimport UsernameInput from './components/UsernameInput';\nimport OnlineIndicator from './components/OnlineIndicator';\nimport ChatBubble from './components/ChatBubble';\n\nimport { TonIcon } from './components/IconComponents';\nimport useTelegramWebApp from './hooks/useTelegramWebApp';\nimport useJackpotContract from './hooks/useJackpotContract';\nimport useReferralAutoRegistration from './hooks/useReferralAutoRegistration';\nimport { DollarSign, User, Loader2, Trophy, Share2, Users, Target, Coins } from 'lucide-react';\nimport socketService from './services/socketService';\nimport winnerCoordinator from './services/winnerCoordinator';\n\nimport { uiOptions } from './config/tonconnect';\nimport './App.css';\nimport './components/Header.css';\n\n// TON Connect manifest URL - use remote manifest to avoid 500 errors\nconst manifestUrl = \"https://raw.githubusercontent.com/Vodka2134156/kzsks/main/manifest.json\";\n\nfunction AppContent() {\n  // Global referral auto-registration\n  useReferralAutoRegistration();\n  \n  // Local UI state\n  const [currentRound, setCurrentRound] = useState(53408);\n  const [timeRemaining, setTimeRemaining] = useState(30);\n  const [activeTab, setActiveTab] = useState('jackpot');\n  const [betAmount, setBetAmount] = useState(0.1);\n  const [showWinnerAnnouncement, setShowWinnerAnnouncement] = useState(false);\n  \n  // Winner state management (moved from GameArea.js)\n  const [waitingForWinner, setWaitingForWinner] = useState(false);\n  const [contractWinner, setContractWinner] = useState(null);\n  const [postWinnerLoading, setPostWinnerLoading] = useState(false);\n  const [, setIsAnyWinnerDisplayActive] = useState(false);\n  const [showWinnerVisually, setShowWinnerVisually] = useState(false); // Controls when winner card appears\n  const [isInWinnerState, setIsInWinnerState] = useState(false); // Blocks new winner broadcasts\n  \n  // Username management\n  const [showUsernameInput, setShowUsernameInput] = useState(false);\n  const [currentUsername, setCurrentUsername] = useState('');\n  \n  // Bet loading state - tracks when user places bet until wager changes\n  const [betLoadingState, setBetLoadingState] = useState({\n    isWaitingForWagerChange: false,\n    lastWagerAmount: 0,\n    lastBalance: 0\n  });\n  \n  // Bettors state (managed centrally to avoid duplicates)\n  const [gameBettors, setGameBettors] = useState([]);\n  const [previousRoundBettors, setPreviousRoundBettors] = useState([]); // Store bettors for winner matching\n  const [slotSpinning, setSlotSpinning] = useState(false);\n  // Note: carouselRef removed - now using Swiper component\n\n  // Refs to avoid stale closures in socket handlers\n  const gameBettorsRef = useRef([]);\n  const contractWinnerRef = useRef(null);\n  const showWinnerAnnouncementRef = useRef(false);\n  const lastWinnerTimestampRef = useRef(null);\n  const waitingForWinnerRef = useRef(false);\n  const previousRoundBettorsRef = useRef([]);\n  const timeRemainingRef = useRef(30);\n  const showWinnerVisuallyRef = useRef(false);\n  const isInWinnerStateRef = useRef(false);\n  \n  // Check for stored username on app load\n  useEffect(() => {\n    const storedUsername = localStorage.getItem('slotpot_username');\n    if (storedUsername && storedUsername.trim().length >= 2) {\n      setCurrentUsername(storedUsername.trim());\n    }\n  }, []);\n\n\n\n  // Debug timer data\n  useEffect(() => {\n    console.log('🔍 Timer Debug:', {\n      isLive,\n      timerActive: contractState?.timer?.isActive,\n      startTime: contractState?.timer?.startTime,\n      roundDuration: contractState?.roundDuration,\n      timeRemaining: contractState?.timer?.timeRemaining,\n      currentTimeRemaining: timeRemaining\n    });\n  }, [isLive, contractState?.timer, contractState?.roundDuration, timeRemaining]);\n\n  // Keep refs in sync with state\n  useEffect(() => { gameBettorsRef.current = gameBettors; }, [gameBettors]);\n  useEffect(() => { \n    contractWinnerRef.current = contractWinner; \n  }, [contractWinner]);\n  useEffect(() => { showWinnerAnnouncementRef.current = showWinnerAnnouncement; }, [showWinnerAnnouncement]);\n  useEffect(() => { waitingForWinnerRef.current = waitingForWinner; }, [waitingForWinner]);\n  useEffect(() => { previousRoundBettorsRef.current = previousRoundBettors; }, [previousRoundBettors]);\n  useEffect(() => { timeRemainingRef.current = timeRemaining; }, [timeRemaining]);\n  useEffect(() => { showWinnerVisuallyRef.current = showWinnerVisually; }, [showWinnerVisually]);\n  useEffect(() => { isInWinnerStateRef.current = isInWinnerState; }, [isInWinnerState]);\n\n  // Centralized winner announcement manager\n  const showWinnerAnnouncements = useCallback((winnerData, source = 'unknown') => {\n    const winnerTimestamp = winnerData.timestamp;\n    \n    // Block winner broadcasts if already in winner state\n    if (isInWinnerStateRef.current) {\n      if (process.env.NODE_ENV === 'development') {\n        // console.log(`🚫 BLOCKED - Already in winner state, ignoring ${source}`);\n      }\n      return false;\n    }\n    \n    // Use coordinator to check if should block (pass full winner data for better duplicate detection)\n    if (winnerCoordinator.shouldBlock(winnerTimestamp, winnerData)) {\n      return false;\n    }\n    \n    // Winner sound removed for performance\n    \n    // Enter winner state to block future broadcasts\n    setIsInWinnerState(true);\n    \n    // Set coordination flag via coordinator (pass full winner data)\n    winnerCoordinator.setActive(true, winnerTimestamp, winnerData);\n    setIsAnyWinnerDisplayActive(true);\n    lastWinnerTimestampRef.current = winnerTimestamp;\n    \n    // Show App.js winner notification\n    setContractWinner(winnerData);\n    setShowWinnerAnnouncement(true);\n    setWaitingForWinner(false);\n    \n    // Start animation - winner visual will appear after animation lands on winner\n    setTimeout(() => {\n      setShowWinnerVisually(true);\n    }, 3000); // Give animation time to land properly\n    \n    return true;\n  }, []);\n\n  // Telegram integration\n  const { user, hapticFeedback, showAlert, hasRealUserData } = useTelegramWebApp();\n\n  // Smart contract integration\n  const {\n    contractState,\n    userStats,\n    adminInfo: rawAdminInfo,\n    isLoadingContract,\n    isPlacingBet,\n    placeBet,\n    isConnected,\n    address,\n  } = useJackpotContract();\n\n  // SAFETY: Ensure adminInfo is always properly structured and never an object that could be rendered\n  const adminInfo = useMemo(() => {\n    if (!rawAdminInfo || typeof rawAdminInfo !== 'object') {\n      return {\n        isAutoManaged: false,\n        roundDuration: 300,\n        minBetsToEnd: 1,\n        timerActive: false,\n        timeRemaining: 0\n      };\n    }\n    \n    // Extract only primitive values to prevent accidental object rendering\n    return {\n      isAutoManaged: Boolean(rawAdminInfo.isAutoManaged),\n      roundDuration: Number(rawAdminInfo.roundDuration) || 300,\n      minBetsToEnd: Number(rawAdminInfo.minBetsToEnd) || 1,\n      timerActive: Boolean(rawAdminInfo.timerActive),\n      timeRemaining: Number(rawAdminInfo.timeRemaining) || 0,\n      // Ensure currentRound is always a number, never an object\n      currentRound: typeof rawAdminInfo.currentRound === 'object' \n        ? (rawAdminInfo.currentRound?.roundNumber || 0)\n        : (Number(rawAdminInfo.currentRound) || 0)\n    };\n  }, [rawAdminInfo]);\n\n  // SAFETY: Ensure contractState timer properties are never objects that could be accidentally rendered\n  const safeContractState = useMemo(() => {\n    if (!contractState) return contractState;\n    \n    return {\n      ...contractState,\n      // Ensure timer object properties are always primitives\n      timer: contractState.timer ? {\n        isActive: Boolean(contractState.timer.isActive),\n        timeRemaining: Number(contractState.timer.timeRemaining) || 0,\n        timeElapsed: Number(contractState.timer.timeElapsed) || 0,\n        roundNumber: Number(contractState.timer.roundNumber) || 0,\n        timerExpired: Boolean(contractState.timer.timerExpired)\n      } : undefined,\n      // Ensure currentRound is always a number if it exists\n      currentRound: typeof contractState.currentRound === 'object' \n        ? (contractState.currentRound?.roundNumber || 0)\n        : contractState.currentRound\n    };\n  }, [contractState]);\n\n  // Use real contract data or fallback to simulated data\n  const jackpotValue = contractState.totalJackpot;\n  const isLive = contractState.isActive;\n  \n  // Calculate user stats from gameBettors data - optimized with shallow comparison\n  const userBetTotal = useMemo(() => {\n    if (!isConnected || !address || !gameBettors.length) return 0;\n    \n    return gameBettors\n      .filter(bettor => \n        bettor.address === address || \n        bettor.walletAddress === address\n      )\n      .reduce((total, bettor) => total + (bettor.amount || 0), 0);\n  }, [gameBettors.length, address, isConnected]); // Optimized dependencies\n  \n  const userWinChance = useMemo(() => {\n    if (!isConnected || !address || userBetTotal === 0) return 0;\n    \n    // Calculate current round total from gameBettors for immediate updates\n    const currentRoundTotal = gameBettors.reduce((total, bettor) => total + (bettor.amount || 0), 0);\n    \n    // Use the live total from current bettors, fallback to contract jackpot value\n    const liveJackpotValue = currentRoundTotal > 0 ? currentRoundTotal : jackpotValue;\n    \n    if (!liveJackpotValue) return 0;\n    \n    return (userBetTotal / liveJackpotValue) * 100;\n  }, [userBetTotal, jackpotValue, gameBettors.length, isConnected, address]); // Optimized dependencies\n\n  // Track wager changes to determine when bet loading should stop\n  useEffect(() => {\n    const currentWager = userBetTotal || 0;\n    const currentBalance = contractState?.userBalance || 0;\n    \n    // If we're waiting for wager change and the wager has changed\n    if (betLoadingState.isWaitingForWagerChange) {\n      const wagerChanged = Math.abs(currentWager - betLoadingState.lastWagerAmount) > 0.001;\n      const balanceChanged = Math.abs(currentBalance - betLoadingState.lastBalance) > 0.001;\n      \n      if (wagerChanged || balanceChanged) {\n        console.log('💰 Wager/Balance changed - stopping bet loading state');\n        setBetLoadingState({\n          isWaitingForWagerChange: false,\n          lastWagerAmount: currentWager,\n          lastBalance: currentBalance\n        });\n      }\n    }\n  }, [userBetTotal, contractState?.userBalance, betLoadingState.isWaitingForWagerChange, betLoadingState.lastWagerAmount, betLoadingState.lastBalance]);\n\n  // Use automation timer or fallback to UI timer - only sync if significant difference\n  useEffect(() => {\n    if (contractState.timer?.timeRemaining !== undefined) {\n      setTimeRemaining(prev => {\n        const backendTime = contractState.timer.timeRemaining;\n        const timeDiff = Math.abs(prev - backendTime);\n        \n        // Don't sync timer if we're analyzing bets or waiting for winner to avoid bugs\n        if (waitingForWinner || isInWinnerState) {\n          return prev;\n        }\n        \n        // Only sync if difference is 5+ seconds or backend is significantly ahead\n        if (timeDiff >= 5 || backendTime > prev + 2) {\n          return backendTime;\n        }\n        \n        // Keep local countdown running for smooth performance\n        return prev;\n      });\n    } else {\n      setTimeRemaining(30);\n    }\n  }, [contractState.timer?.timeRemaining, waitingForWinner, isInWinnerState]);\n\n  // Local countdown timer that ticks every second\n  useEffect(() => {\n    // Check if we should start the timer\n    if (!isLive) return;\n    \n    // Get timer data\n    const timerData = contractState?.timer;\n    if (!timerData?.isActive) return;\n    \n    const startTime = timerData.startTime;\n    const duration = contractState.roundDuration || 300;\n    \n    if (!startTime) return;\n\n    console.log('⏰ Starting countdown timer:', { startTime, duration, isLive });\n\n    // Calculate initial time from timestamp\n    const elapsed = Math.floor((Date.now() - startTime) / 1000);\n    const initialRemaining = Math.max(0, duration - elapsed);\n    \n    console.log('⏰ Initial timer setup:', { elapsed, initialRemaining });\n    setTimeRemaining(initialRemaining);\n\n    // Local countdown that ticks every second\n    const countdown = setInterval(() => {\n      setTimeRemaining(prev => {\n        const newTime = Math.max(0, prev - 1);\n        console.log('⏰ Timer tick:', { prev, newTime });\n        \n        // When we reach 0, trigger \"analyzing bets\" state\n        if (newTime === 0 && !waitingForWinnerRef.current) {\n          setWaitingForWinner(true);\n        }\n        \n        return newTime;\n      });\n    }, 1000);\n\n    return () => {\n      console.log('⏰ Clearing countdown timer');\n      clearInterval(countdown);\n    };\n  }, [isLive, contractState?.timer?.isActive, contractState?.timer?.startTime, contractState?.roundDuration]);\n\n  // Note: Old animation useEffect removed - now using Swiper component for all carousel animations\n\n  // Socket integration for immediate synchronization - SINGLE CONNECTION POINT\n  useEffect(() => {\n    // Socket connection established\n    socketService.connect();\n\n    // Listen for timer updates from socket\n    socketService.on('timer', (timerData) => {\n      // Timer update received\n      \n      // SAFETY: Ensure timerData exists and has required properties\n      if (!timerData || typeof timerData !== 'object') {\n        console.warn('⚠️ Invalid timer data received in App:', timerData);\n        return;\n      }\n      \n      const newTimeRemaining = typeof timerData.timeRemaining === 'number' ? timerData.timeRemaining : timeRemaining;\n      const newRoundNumber = typeof timerData.roundNumber === 'number' ? timerData.roundNumber : currentRound;\n      \n              // Only update timeRemaining if it's significantly different (>5 seconds) or new round\n        setTimeRemaining(prev => {\n          const timeDiff = Math.abs(prev - newTimeRemaining);\n          const isNewRound = newRoundNumber !== currentRound;\n          \n          // Only clear winner state when new round detected AND timer is significantly higher (real new round)\n          if (isNewRound && contractWinner && newTimeRemaining > 200) {\n                    // New round detected - clearing winner state\n            setIsInWinnerState(false);\n            setContractWinner(null);\n            setShowWinnerAnnouncement(false);\n            setShowWinnerVisually(false);\n            setPostWinnerLoading(false);\n            setIsAnyWinnerDisplayActive(false);\n            setPreviousRoundBettors([]);\n          }\n          \n          // Don't sync timer if we're analyzing bets or waiting for winner to avoid bugs\n          if (waitingForWinnerRef.current || isInWinnerStateRef.current) {\n            // Timer sync blocked - in analyzing/winner state\n            return prev;\n          }\n          \n          // Sync if: new round, big difference (>5s), or timer reset (server > client)\n          if (isNewRound || timeDiff >= 5 || newTimeRemaining > prev + 2) {\n            // Timer synced\n            return newTimeRemaining;\n          }\n          \n          // Otherwise keep local countdown running smoothly\n          return prev;\n        });\n      \n      if (newRoundNumber && newRoundNumber !== currentRound) {\n        setCurrentRound(newRoundNumber);\n      }\n      // Note: Contract state timer will be updated via fullGameUpdate/contractStateUpdate events\n    });\n\n    // Listen for new round events\n    socketService.on('newRound', (roundData) => {\n      // console.log('🎰 App: New round detected via socket:', roundData);\n      // console.log('🔓 Exiting winner state - new round started');\n      \n      setTimeRemaining(roundData.timeRemaining);\n      setCurrentRound(roundData.roundNumber);\n      setIsInWinnerState(false);\n      setIsAnyWinnerDisplayActive(false);\n      winnerCoordinator.reset();\n      lastWinnerTimestampRef.current = null; // Clear duplicate protection for new round\n      \n      // Clear ALL winner highlighting for new round\n      setContractWinner(null);\n      setShowWinnerAnnouncement(false);\n      setShowWinnerVisually(false);\n      setPreviousRoundBettors([]);\n      setWaitingForWinner(false);\n      setPostWinnerLoading(false);\n      \n      // Note: Animation reset handled by Swiper component\n    });\n\n    // Listen for game state updates\n    socketService.on('gameState', (gameState) => {\n      // console.log('🎮 App: Game state update:', gameState);\n      \n      // Priority: Use timer.timeRemaining ONLY (as user specified)\n      const backendTimeRemaining = gameState.timer?.timeRemaining;\n      \n      if (backendTimeRemaining !== undefined) {\n        setTimeRemaining(prev => {\n          const timeDiff = Math.abs(prev - backendTimeRemaining);\n          \n          // Don't sync timer if we're analyzing bets or waiting for winner to avoid bugs\n          if (waitingForWinnerRef.current || isInWinnerStateRef.current) {\n            // console.log('⏰ GameState timer sync blocked - in analyzing/winner state');\n            return prev;\n          }\n          \n          // Only sync if there's a significant difference (>=5s) or if backend is ahead\n          if (timeDiff >= 5 || backendTimeRemaining > prev + 2) {\n            // console.log('⏰ GameState syncing timer:', prev, '→', backendTimeRemaining, timeDiff >= 5 ? '(>=5s difference)' : '(backend ahead)');\n            return backendTimeRemaining;\n          }\n          \n          // Keep local countdown running if difference is small\n          // console.log('⏰ GameState keeping local timer:', prev, 'vs backend:', backendTimeRemaining);\n          return prev;\n        });\n      }\n      if (gameState.currentRound) {\n        // Extract roundNumber if currentRound is an object, otherwise use the value directly\n        const roundNumber = typeof gameState.currentRound === 'object' && gameState.currentRound.roundNumber \n          ? gameState.currentRound.roundNumber \n          : gameState.currentRound;\n        \n        // Check if this is a new round with active timer - this means new round started\n        const isNewRound = roundNumber !== currentRound;\n        const hasActiveTimer = gameState.timer?.isActive || gameState.timer?.timeRemaining > 60;\n        \n        if (isNewRound && hasActiveTimer && isInWinnerStateRef.current) {\n                  // console.log('🔄 GameState detected NEW ROUND with active timer - clearing winner state');\n        // console.log('🔓 Exiting winner state - new round started via gameState');\n          setIsInWinnerState(false);\n          setContractWinner(null);\n          setShowWinnerAnnouncement(false);\n          setShowWinnerVisually(false);\n          setPostWinnerLoading(false);\n          setIsAnyWinnerDisplayActive(false);\n          // Don't clear previousRoundBettors immediately - let carousel finish its animation\n          setTimeout(() => {\n            // console.log('🔄 Delayed clearing of previous round bettors');\n            setPreviousRoundBettors([]);\n          }, 2000); // Give carousel time to finish\n          winnerCoordinator.reset();\n        }\n        \n        setCurrentRound(roundNumber);\n      }\n      \n      // Handle winner-related states\n      if (gameState.isWaitingForWinner !== undefined) {\n        // If transitioning TO waiting for winner, store current bettors\n        if (gameState.isWaitingForWinner && !waitingForWinnerRef.current && gameBettorsRef.current.length > 0) {\n          // console.log('🎮 App: Transitioning to waiting for winner, storing bettors:', gameBettorsRef.current);\n          \n          // Enhance bettors with proper usernames before storing\n          const enhancedBettors = gameBettorsRef.current.map(bettor => ({\n            ...bettor,\n            username: bettor.username || bettor.displayName || `Player_${bettor.address?.slice(-4)}`,\n            displayName: bettor.displayName || bettor.username || `Player_${bettor.address?.slice(-4)}`\n          }));\n          \n          setPreviousRoundBettors(enhancedBettors);\n        }\n        \n        setWaitingForWinner(gameState.isWaitingForWinner);\n        \n        // If waitingForWinner becomes false AND we have a new round with active timer, reset winner state\n        if (!gameState.isWaitingForWinner && isInWinnerStateRef.current) {\n          const roundNumber = typeof gameState.currentRound === 'object' && gameState.currentRound.roundNumber \n            ? gameState.currentRound.roundNumber \n            : gameState.currentRound;\n          const isNewRound = roundNumber && roundNumber !== currentRound;\n          const hasActiveTimer = gameState.timer?.isActive || gameState.timer?.timeRemaining > 60;\n          \n          if (isNewRound && hasActiveTimer) {\n                    // console.log('🔄 waitingForWinner false + new round + active timer = new round started - clearing winner state');\n        // console.log('🔓 Exiting winner state - new round confirmed');\n            setIsInWinnerState(false);\n            setContractWinner(null);\n            setShowWinnerAnnouncement(false);\n            setShowWinnerVisually(false);\n            setPostWinnerLoading(false);\n            setIsAnyWinnerDisplayActive(false);\n            // Don't clear previousRoundBettors immediately - let carousel finish its animation\n            setTimeout(() => {\n              // console.log('🔄 Delayed clearing of previous round bettors (waitingForWinner)');\n              setPreviousRoundBettors([]);\n            }, 2000); // Give carousel time to finish\n            winnerCoordinator.reset();\n          } else {\n            // console.log('⏳ waitingForWinner became false, but keeping winner state (no new round detected)');\n          }\n        }\n      }\n      \n      // Update bettors data centrally (avoids duplicate processing)\n      if (gameState.bettors && Array.isArray(gameState.bettors)) {\n        // Only log if bettors count changed to reduce spam\n        if (gameState.bettors.length !== gameBettorsRef.current.length) {\n          // console.log('🎮 App: Updating bettors from gameState:', gameState.bettors.length, 'bettors');\n          \n          // Play bet sound when new bettor joins (if count increased)\n          if (gameState.bettors.length > gameBettorsRef.current.length) {\n            // Bet sound removed for performance\n          }\n          \n          // Trigger slot machine animation when new bettor joins\n          setSlotSpinning(true);\n          setTimeout(() => setSlotSpinning(false), 3000);\n        }\n        \n        // Store current bettors as previous round bettors when waiting for winner\n        if (gameState.isWaitingForWinner && gameState.bettors.length > 0) {\n          console.log('🎮 App: Storing bettors for winner matching:', gameState.bettors);\n          \n          // Enhance bettors with proper usernames before storing\n          const enhancedBettors = gameState.bettors.map(bettor => ({\n            ...bettor,\n            username: bettor.username || bettor.displayName || `Player_${bettor.address?.slice(-4)}`,\n            displayName: bettor.displayName || bettor.username || `Player_${bettor.address?.slice(-4)}`\n          }));\n          \n          setPreviousRoundBettors(enhancedBettors);\n        }\n        \n        setGameBettors(gameState.bettors);\n      }\n      \n      // Check for winner announcement in game state (prevent duplicates with stronger protection)\n      if (gameState.winnerAnnouncement) {\n        showWinnerAnnouncements(gameState.winnerAnnouncement, 'gameState');\n      }\n    });\n\n    // Listen for comprehensive game data updates\n    socketService.on('fullGameUpdate', (gameData) => {\n      //console.log('🎮 App: Full game update:', gameData);\n      // These updates will trigger re-renders via useJackpotContract hook\n      // The hook will detect the changes and update accordingly\n    });\n\n    // Listen for bettors updates\n    socketService.on('bettorsUpdate', (data) => {\n      // Bet sound removed for performance\n      \n      // Trigger slot machine animation on bettor updates\n      setSlotSpinning(true);\n      setTimeout(() => setSlotSpinning(false), 3000);\n      // Force a refresh of contract state to sync with socket data\n      // This ensures jackpot value and user stats stay in sync\n    });\n\n    // Listen for waiting for winner events\n    socketService.on('waitingForWinner', (data) => {\n      console.log('🎯 App: Waiting for winner state changed:', data);\n      \n      // Handle both old boolean format and new object format\n      const isWaiting = typeof data === 'boolean' ? data : data.isWaiting;\n      const message = typeof data === 'object' ? data.message : null;\n      \n      // Don't reset winner state just because waitingForWinner changed\n      // Only reset when we get explicit newRound/roundReset events\n      setWaitingForWinner(isWaiting);\n      \n      // Log but don't auto-reset winner state\n      if (!isWaiting && isInWinnerStateRef.current) {\n        console.log('⏳ waitingForWinner event became false, but keeping winner state until explicit new round');\n      }\n      \n      if (message) {\n        console.log('🎯 App: Winner selection message:', message);\n      }\n    });\n\n    // Listen for winner announcements (primary)\n    socketService.on('winner', (winnerData) => {\n      console.log('🏆 App: Winner announced:', winnerData);\n\n      console.log('🏆 App: Previous round bettors for comparison:', previousRoundBettors);\n      setWaitingForWinner(false);\n      setPostWinnerLoading(true);\n      \n      // Use centralized manager\n      showWinnerAnnouncements(winnerData, 'winner event');\n    });\n\n    // Listen for direct winner announcements (fallback/reliable delivery)\n    socketService.on('winnerAnnouncement', (winnerData) => {\n      console.log('🎯 App: Direct winner announcement:', winnerData);\n      setWaitingForWinner(false);\n      \n      // Use centralized manager\n      showWinnerAnnouncements(winnerData, 'direct announcement');\n    });\n\n    // Listen for round reset events (when timer is reset due to no bettors)\n    socketService.on('roundReset', (resetData) => {\n      console.log('🔄 App: Round reset detected:', resetData);\n      console.log('🔓 Exiting winner state - round reset');\n      \n      // Reset timer to the new duration\n      setTimeRemaining(resetData.timeRemaining);\n      setCurrentRound(resetData.roundNumber);\n      \n      // Clear ALL winner states since this is a fresh timer\n      setIsInWinnerState(false);\n      setWaitingForWinner(false);\n      setContractWinner(null);\n      setShowWinnerAnnouncement(false);\n      setShowWinnerVisually(false);\n      setPostWinnerLoading(false);\n      setIsAnyWinnerDisplayActive(false);\n      winnerCoordinator.reset();\n      \n      // Clear bettors list since round was reset\n      setGameBettors([]);\n      // Don't clear previousRoundBettors immediately on reset - let any ongoing animation finish\n      setTimeout(() => {\n        console.log('🔄 Delayed clearing of previous round bettors (round reset)');\n        setPreviousRoundBettors([]);\n      }, 1000);\n      \n      // Note: Animation reset handled by Swiper component\n    });\n\n    return () => {\n      console.log('🔌 App.js: Cleaning up socket listeners...');\n      socketService.off('timer');\n      socketService.off('newRound');\n      socketService.off('roundReset');\n      socketService.off('gameState');\n      socketService.off('fullGameUpdate');\n      socketService.off('bettorsUpdate');\n      socketService.off('waitingForWinner');\n      socketService.off('winner');\n      socketService.off('winnerAnnouncement');\n      // Disconnect when app unmounts to prevent memory leaks\n      socketService.disconnect();\n    };\n  }, [currentRound, showWinnerAnnouncements]); // Added missing dependencies\n\n  const handleBetChange = (e) => {\n    const inputValue = e.target.value;\n    \n    // Allow empty input or numbers with decimal points (both . and ,)\n    if (inputValue === '' || inputValue === '.' || inputValue === ',' || /^\\d*[.,]?\\d*$/.test(inputValue)) {\n      // Convert comma to period for consistency\n      const normalizedValue = inputValue.replace(',', '.');\n      \n      // For empty or just \".\" input, keep the raw value but show comma if user typed comma\n      if (normalizedValue === '' || normalizedValue === '.') {\n        setBetAmount(inputValue); // Keep original input (might be comma)\n        return;\n      }\n      \n      // For valid numbers, check limits but preserve decimal typing\n      const numericValue = parseFloat(normalizedValue);\n      if (!isNaN(numericValue) && numericValue <= 10) {\n        setBetAmount(normalizedValue); // Use normalized value to ensure consistency\n      }\n    }\n  };\n\n  const handleTabChange = (tab) => {\n    hapticFeedback('light');\n    setActiveTab(tab);\n  };\n\n  // Enhanced bet placement with real smart contract\n  const handlePlaceBet = async () => {\n    // Prevent betting during winner display period\n    if (contractWinner || showWinnerAnnouncement) {\n      showAlert('⏳ Please wait for the new round to start before placing a bet!');\n      return;\n    }\n\n    if (!isConnected) {\n      showAlert('Please connect your wallet first!');\n      return;\n    }\n\n    // Convert comma to period before parsing for validation\n    const normalizedBetAmount = betAmount.toString().replace(',', '.');\n    const numericBetAmount = parseFloat(normalizedBetAmount);\n    \n    if (isNaN(numericBetAmount) || numericBetAmount <= 0) {\n      showAlert('Please enter a valid bet amount!');\n      return;\n    }\n\n    try {\n      hapticFeedback('medium');\n      \n      await placeBet(numericBetAmount);\n      \n      // Bet sound removed for performance\n      // Set loading state to wait for wager/balance change\n      setBetLoadingState({\n        isWaitingForWagerChange: true,\n        lastWagerAmount: userBetTotal || 0,\n        lastBalance: contractState?.userBalance || 0\n      });\n      \n      // Reset bet amount after successful bet\n      setBetAmount(0.1);\n      \n      hapticFeedback('success');\n      showAlert(`✅ Bet of ${numericBetAmount.toFixed(3)} TON placed successfully!`);\n    } catch (error) {\n      hapticFeedback('error');\n      showAlert(`❌ Failed to place bet: ${error.message}`);\n    }\n  };\n\n  return (\n    <div className=\"app\">\n        <div className=\"app-container\">\n          {/* Fixed Chat Bubble */}\n          <ChatBubble telegramGroupUrl=\"https://t.me/yourgroup\" />\n          \n          {/* Main Content */}\n          <div className=\"main-content\">\n            {activeTab === 'profile' ? (\n              <div className=\"profile-container\">\n                <Header \n                  currentUsername={currentUsername}\n                  onShowUsernameInput={() => setShowUsernameInput(true)}\n                />\n                <PlayerProfile />\n              </div>\n            ) : activeTab === 'referrals' ? (\n              <div className=\"referrals-container\">\n                <Header \n                  currentUsername={currentUsername}\n                  onShowUsernameInput={() => setShowUsernameInput(true)}\n                />\n                <ReferralSystem />\n              </div>\n                          ) : (\n                <div className=\"jackpot-container\">\n                  {/* Online Indicator - Just above header */}\n                  <OnlineIndicator \n                    isConnected={isConnected} \n                  />\n                  \n                  <Header \n                    currentUsername={currentUsername}\n                    onShowUsernameInput={() => setShowUsernameInput(true)}\n                  />\n            <>\n            {/* Betting Section */}\n            <div className=\"betting-section\">\n              <div className=\"bet-input-section\">\n                <input \n                  type=\"text\" \n                  className=\"bet-amount-input\" \n                  value={betAmount}\n                  onChange={handleBetChange}\n                  placeholder=\"0.000\"\n                  inputMode=\"decimal\"\n                />\n                <button className=\"bet-increment-btn\" onClick={() => setBetAmount(prev => {\n                  const currentValue = parseFloat(prev) || 0;\n                  return Math.min(currentValue + 0.1, 10).toFixed(1);\n                })}>\n                  +0.1\n          </button>\n              </div>\n              \n              {/* Balance Section */}\n              <div className=\"balance-section\">\n                <div className=\"balance-label\">Balance</div>\n                <div className=\"balance-amount\">\n                  {isConnected ? `${(contractState.userBalance || 0).toFixed(6)}` : '0.000000'}\n                  <span className=\"balance-symbol\">TON</span>\n                </div>\n              </div>\n              \n          <button \n                className=\"bet-button\" \n                onClick={handlePlaceBet}\n                disabled={isPlacingBet || betLoadingState.isWaitingForWagerChange || !isConnected || contractWinner || showWinnerAnnouncement}\n          >\n                {contractWinner || showWinnerAnnouncement ? 'Winner Display - Wait for New Round' :\n                 isPlacingBet ? 'Betting...' :\n                 betLoadingState.isWaitingForWagerChange ? 'Processing Bet...' : 'Bet'}\n          </button>\n        </div>\n\n            {/* Four Card Stats Grid */}\n            <div className=\"stats-grid four-cards\">\n              <div className=\"stat-card jackpot-card\">\n                <div className=\"stat-value\">\n                  <TonIcon size={14} className=\"wager-ton-icon\" />\n                  {jackpotValue.toFixed(3)}\n                </div>\n                <div className=\"stat-label\">Jackpot Value</div>\n              </div>\n              <div className=\"stat-card\">\n                <div className=\"stat-value\">\n                  <TonIcon size={14} className=\"wager-ton-icon\" />\n                  {userBetTotal.toFixed(3)}\n                </div>\n                <div className=\"stat-label\">Your Wager</div>\n              </div>\n              <div className=\"stat-card chance-stat\">\n                <div className=\"stat-value\">{userWinChance.toFixed(2)}%</div>\n                <div className=\"stat-label\">Your Chance</div>\n              </div>\n              <div className=\"stat-card\">\n                <div className=\"stat-value\">\n                  {Math.floor((timeRemaining || 0) / 60)}:{((timeRemaining || 0) % 60).toString().padStart(2, '0')}\n                </div>\n                <div className=\"stat-label\">Time Remaining</div>\n              </div>\n            </div>\n\n            {/* Players Carousel Section */}\n            <div className=\"players-carousel-section\">\n              <div className={`carousel-header ${\n                (timeRemaining === 0 && waitingForWinner) || (contractWinner && !showWinnerVisually) ? 'analyzing' : \n                showWinnerVisually ? 'winner' : ''\n              }`}>\n                <h3>\n                  {(timeRemaining === 0 && waitingForWinner) || (contractWinner && !showWinnerVisually) ? \n                    \"🔍 Analyzing Bets...\" : \n                    showWinnerVisually && contractWinner ? \n                    `🏆 Winner: ${contractWinner.username || contractWinner.displayName || contractWinner.winnerName || `Player_${contractWinner.winner?.slice(-4)}` || 'Player'}` :\n                    `Players (${gameBettors.length > 0 ? gameBettors.length : previousRoundBettors.length})`\n                  }\n                </h3>\n              </div>\n              \n              {/* NEW: Simple Swiper Carousel */}\n              <SimpleCarousel \n                players={(() => {\n                  // Same data logic as before\n                  const bettorsToShow = (contractWinner || waitingForWinner) ? \n                                       previousRoundBettors.length > 0 ? previousRoundBettors : gameBettors :\n                                       gameBettors.length > 0 ? gameBettors : [];\n                  \n                  // Ensure we have at least 6 items to show (fill with waiting slots if needed)\n                  return [\n                    ...bettorsToShow,\n                    ...Array.from({ length: Math.max(0, 6 - bettorsToShow.length) }, () => null)\n                  ];\n                })()}\n                contractWinner={contractWinner}\n                isSpinning={(timeRemaining === 0 && waitingForWinner) || (contractWinner && !showWinnerVisually)}\n                onSpinComplete={() => {\n                  console.log('🎯 Winner animation completed in SimpleCarousel!');\n                  console.log('🔄 Carousel finished - now safe to clear winner state in future');\n                  // Winner is already set via showWinnerVisually\n                }}\n              />\n        </div>\n        \n        {/* Bets Deflate Section */}\n        <div className=\"bets-deflate-section\">\n          <div className=\"bets-deflate-header\">\n            <h3>Current Round Bets</h3>\n            <div className=\"round-info\">\n              <span>#{currentRound}</span>\n            </div>\n          </div>\n          \n          <div className=\"bets-deflate-list\">\n            {(() => {\n              const bettorsToShow = (contractWinner || waitingForWinner) ? \n                                   previousRoundBettors.length > 0 ? previousRoundBettors : gameBettors :\n                                   gameBettors.length > 0 ? gameBettors : [];\n              \n                             return bettorsToShow.map((bettor, index) => {\n                 const betAmount = parseFloat(bettor.amount || 0);\n                 const currentJackpot = parseFloat(jackpotValue || 0);\n                 const chance = currentJackpot > 0 ? ((betAmount / currentJackpot) * 100).toFixed(2) : '0.00';\n                 const usdValue = (betAmount * 2.5).toFixed(1); // Approximate USD value\n                \n                return (\n                  <div key={`${bettor.address}-${index}`} className=\"bet-deflate-card\">\n                    <div className=\"bet-deflate-avatar\">\n                      <div className=\"avatar-icon\">\n                        <Users size={20} />\n                      </div>\n                      <div className=\"avatar-count\">1</div>\n                    </div>\n                    \n                    <div className=\"bet-deflate-info\">\n                      <div className=\"bet-deflate-username\">\n                        {bettor.username || bettor.displayName || bettor.winner || `Player_${bettor.address.slice(-4)}`}\n                      </div>\n                      <div className=\"bet-deflate-amount\">\n                        <TonIcon size={16} className=\"bet-deflate-ton-icon\" />\n                        <span>{betAmount.toFixed(3)}</span>\n                        <div className=\"bet-deflate-usd\">~${usdValue}</div>\n                      </div>\n                    </div>\n                    \n                    <div className=\"bet-deflate-chance\">\n                      <div className=\"chance-label\">\n                        <Target size={12} />\n                        <span>Chance</span>\n                      </div>\n                      <div className=\"chance-value\">{chance}%</div>\n                    </div>\n                  </div>\n                );\n              });\n            })()}\n            \n            {(() => {\n              const bettorsToShow = (contractWinner || waitingForWinner) ? \n                                   previousRoundBettors.length > 0 ? previousRoundBettors : gameBettors :\n                                   gameBettors.length > 0 ? gameBettors : [];\n              \n              if (bettorsToShow.length === 0) {\n                return (\n                  <div className=\"bet-deflate-empty\">\n                    <div className=\"empty-icon\">\n                      <Coins size={32} />\n                    </div>\n                    <div className=\"empty-text\">No bets yet</div>\n                    <div className=\"empty-subtext\">Be the first to place a bet!</div>\n                  </div>\n                );\n              }\n              return null;\n            })()}\n          </div>\n        </div>\n        \n        {/* Recent Winners Section */}\n        <RecentWinners />\n        \n            </>\n              </div>\n            )}\n      </div>\n\n      {/* Mobile Navigation Bar */}\n      <div className=\"mobile-navbar\">\n        <div className=\"navbar-items\">\n          <button \n            className={`navbar-item ${activeTab === 'jackpot' ? 'active' : ''}`}\n            onClick={() => setActiveTab('jackpot')}\n          >\n            <div className=\"navbar-icon\"><DollarSign size={20} /></div>\n            <div className=\"navbar-label\">Jackpot</div>\n          </button>\n          \n          <button \n            className={`navbar-item ${activeTab === 'profile' ? 'active' : ''}`}\n            onClick={() => setActiveTab('profile')}\n          >\n            <div className=\"navbar-icon\"><User size={20} /></div>\n            <div className=\"navbar-label\">Profile</div>\n          </button>\n          \n          <button \n            className={`navbar-item ${activeTab === 'referrals' ? 'active' : ''}`}\n            onClick={() => setActiveTab('referrals')}\n          >\n            <div className=\"navbar-icon\"><Share2 size={20} /></div>\n            <div className=\"navbar-label\">Referrals</div>\n          </button>\n        </div>\n      </div>\n      </div>\n\n      {/* Contract Status Indicator */}\n      {isLoadingContract && !contractWinner && !showWinnerAnnouncement && (\n        <div className=\"loading-overlay\">\n          <div className=\"loading-spinner\"><Loader2 size={24} className=\"animate-spin\" /></div>\n          <span>Loading contract data...</span>\n        </div>\n      )}\n\n      {/* Winner Broadcast Component */}\n      <WinnerBroadcast socketService={socketService} />\n      \n      {/* Username Input Modal */}\n      <UsernameInput \n        isVisible={showUsernameInput}\n        currentUsername={currentUsername}\n        onUsernameSet={(username) => {\n          setCurrentUsername(username);\n          setShowUsernameInput(false);\n          // Trigger a page reload to update the username everywhere\n          window.location.reload();\n        }}\n      />\n    </div>\n  );\n}\n\n// Main App component with TON Connect Provider\nfunction App() {\n  return (\n    <TonConnectUIProvider \n      manifestUrl={manifestUrl}\n      uiPreferences={uiOptions.uiPreferences}\n      language={uiOptions.language}\n      restoreConnection={uiOptions.restoreConnection}\n      actionsConfiguration={uiOptions.actionsConfiguration}\n    >\n      <AppContent />\n    </TonConnectUIProvider>\n  );\n}\n\nexport default App; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}